/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
*/
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(M,a,p){if(p.get||p.set)throw new TypeError("ES3 does not support getters and setters.");M!=Array.prototype&&M!=Object.prototype&&(M[a]=p.value)};$jscomp.getGlobal=function(M){return"undefined"!=typeof window&&window===M?M:"undefined"!=typeof global&&null!=global?global:M};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(M){return $jscomp.SYMBOL_PREFIX+(M||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var M=$jscomp.global.Symbol.iterator;M||(M=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[M]&&$jscomp.defineProperty(Array.prototype,M,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(M){var a=0;return $jscomp.iteratorPrototype(function(){return a<M.length?{done:!1,value:M[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(M){$jscomp.initSymbolIterator();M={next:M};M[$jscomp.global.Symbol.iterator]=function(){return this};return M};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(M,a){$jscomp.initSymbolIterator();M instanceof String&&(M+="");var p=0,k={next:function(){if(p<M.length){var e=p++;return{value:a(e,M[e]),done:!1}}k.next=function(){return{done:!0,value:void 0}};return k.next()}};k[Symbol.iterator]=function(){return k};return k};
$jscomp.polyfill=function(M,a,p,k){if(a){p=$jscomp.global;M=M.split(".");for(k=0;k<M.length-1;k++){var e=M[k];e in p||(p[e]={});p=p[e]}M=M[M.length-1];k=p[M];a=a(k);a!=k&&null!=a&&$jscomp.defineProperty(p,M,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.keys",function(M){return M?M:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(M){return M?M:function(a,p,k){var e=this.length||0;0>p&&(p=Math.max(0,e+p));if(null==k||k>e)k=e;k=Number(k);0>k&&(k=Math.max(0,e+k));for(p=Number(p||0);p<k;p++)this[p]=a;return this}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.values",function(M){return M?M:function(){return $jscomp.iteratorFromArray(this,function(a,p){return p})}},"es6","es3");
$jscomp.makeIterator=function(M){$jscomp.initSymbolIterator();var a=M[Symbol.iterator];return a?a.call(M):$jscomp.arrayIterator(M)};$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(M){function a(){this.batch_=null}if(M&&!$jscomp.FORCE_POLYFILL_PROMISE)return M;a.prototype.asyncExecute=function(d){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(d);return this};a.prototype.asyncExecuteBatch_=function(){var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})};var p=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(d){p(d,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var d=
this.batch_;this.batch_=[];for(var e=0;e<d.length;++e){var q=d[e];delete d[e];try{q()}catch(c){this.asyncThrow_(c)}}}this.batch_=null};a.prototype.asyncThrow_=function(d){this.asyncExecuteFunction(function(){throw d;})};var k=function(d){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var e=this.createResolveAndReject_();try{d(e.resolve,e.reject)}catch(q){e.reject(q)}};k.prototype.createResolveAndReject_=function(){function d(c){return function(l){q||(q=!0,c.call(e,l))}}var e=this,q=
!1;return{resolve:d(this.resolveTo_),reject:d(this.reject_)}};k.prototype.resolveTo_=function(d){if(d===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(d instanceof k)this.settleSameAsPromise_(d);else{var e;a:switch(typeof d){case "object":e=null!=d;break a;case "function":e=!0;break a;default:e=!1}e?this.resolveToNonPromiseObj_(d):this.fulfill_(d)}};k.prototype.resolveToNonPromiseObj_=function(d){var e=void 0;try{e=d.then}catch(q){this.reject_(q);return}"function"==
typeof e?this.settleSameAsThenable_(e,d):this.fulfill_(d)};k.prototype.reject_=function(d){this.settle_(2,d)};k.prototype.fulfill_=function(d){this.settle_(1,d)};k.prototype.settle_=function(d,e){if(0!=this.state_)throw Error("Cannot settle("+d+", "+e|"): Promise already settled in state"+this.state_);this.state_=d;this.result_=e;this.executeOnSettledCallbacks_()};k.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var d=this.onSettledCallbacks_,e=0;e<d.length;++e)d[e].call(),
d[e]=null;this.onSettledCallbacks_=null}};var e=new a;k.prototype.settleSameAsPromise_=function(d){var e=this.createResolveAndReject_();d.callWhenSettled_(e.resolve,e.reject)};k.prototype.settleSameAsThenable_=function(d,e){var q=this.createResolveAndReject_();try{d.call(e,q.resolve,q.reject)}catch(c){q.reject(c)}};k.prototype.then=function(d,e){function q(h,b){return"function"==typeof h?function(b){try{c(h(b))}catch(g){l(g)}}:b}var c,l,m=new k(function(h,b){c=h;l=b});this.callWhenSettled_(q(d,c),
q(e,l));return m};k.prototype["catch"]=function(d){return this.then(void 0,d)};k.prototype.callWhenSettled_=function(d,n){function q(){switch(c.state_){case 1:d(c.result_);break;case 2:n(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?e.asyncExecute(q):this.onSettledCallbacks_.push(function(){e.asyncExecute(q)})};k.resolve=function(d){return d instanceof k?d:new k(function(e,q){e(d)})};k.reject=function(d){return new k(function(e,q){q(d)})};
k.race=function(d){return new k(function(e,q){for(var c=$jscomp.makeIterator(d),l=c.next();!l.done;l=c.next())k.resolve(l.value).callWhenSettled_(e,q)})};k.all=function(d){var e=$jscomp.makeIterator(d),q=e.next();return q.done?k.resolve([]):new k(function(c,l){function m(f){return function(g){h[f]=g;b--;0==b&&c(h)}}var h=[],b=0;do h.push(void 0),b++,k.resolve(q.value).callWhenSettled_(m(h.length-1),l),q=e.next();while(!q.done)})};$jscomp.EXPOSE_ASYNC_EXECUTOR&&(k.$jscomp$new$AsyncExecutor=function(){return new a});
return k},"es6-impl","es3");$jscomp.checkStringArgs=function(M,a,p){if(null==M)throw new TypeError("The 'this' value for String.prototype."+p+" must not be null or undefined");if(a instanceof RegExp)throw new TypeError("First argument to String.prototype."+p+" must not be a regular expression");return M+""};
$jscomp.polyfill("String.prototype.endsWith",function(M){return M?M:function(a,p){var k=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===p&&(p=k.length);for(var e=Math.max(0,Math.min(p|0,k.length)),d=a.length;0<d&&0<e;)if(k[--e]!=a[--d])return!1;return 0>=d}},"es6-impl","es3");
(function(M){"object"===typeof exports&&"undefined"!==typeof module?module.exports=M():"function"===typeof define&&define.amd?define([],M):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).mapboxgl=M()})(function(){return function a(p,k,e){function d(c,l){if(!k[c]){if(!p[c]){var m="function"==typeof require&&require;if(!l&&m)return m(c,!0);if(n)return n(c,!0);m=Error("Cannot find module '"+c+"'");throw m.code="MODULE_NOT_FOUND",m;}m=k[c]={exports:{}};
p[c][0].call(m.exports,function(h){var b=p[c][1][h];return d(b?b:h)},m,m.exports,a,p,k,e)}return k[c].exports}for(var n="function"==typeof require&&require,q=0;q<e.length;q++)d(e[q]);return d}({1:[function(a,p,k){(function(e,d){"object"===typeof k&&"undefined"!==typeof p?p.exports=d():e.glMatrix=d()})(this,function(){(function(){var e=new Float32Array(3);e[0]=0;e[1]=0;e[2]=0;return e})();(function(){var e=new Float32Array(4);e[0]=0;e[1]=0;e[2]=0;e[3]=0;return e})();return{vec3:{transformMat3:function(e,
d,n){var q=d[0],c=d[1];d=d[2];e[0]=q*n[0]+c*n[3]+d*n[6];e[1]=q*n[1]+c*n[4]+d*n[7];e[2]=q*n[2]+c*n[5]+d*n[8];return e}},vec4:{transformMat4:function(e,d,n){var q=d[0],c=d[1],l=d[2];d=d[3];e[0]=n[0]*q+n[4]*c+n[8]*l+n[12]*d;e[1]=n[1]*q+n[5]*c+n[9]*l+n[13]*d;e[2]=n[2]*q+n[6]*c+n[10]*l+n[14]*d;e[3]=n[3]*q+n[7]*c+n[11]*l+n[15]*d;return e}},mat2:{create:function(){var e=new Float32Array(4);e[0]=1;e[1]=0;e[2]=0;e[3]=1;return e},rotate:function(e,d,n){var q=d[0],c=d[1],l=d[2];d=d[3];var m=Math.sin(n);n=Math.cos(n);
e[0]=q*n+l*m;e[1]=c*n+d*m;e[2]=q*-m+l*n;e[3]=c*-m+d*n;return e},scale:function(e,d,n){var q=d[1],c=d[2],l=d[3],m=n[0];n=n[1];e[0]=d[0]*m;e[1]=q*m;e[2]=c*n;e[3]=l*n;return e}},mat3:{create:function(){var e=new Float32Array(9);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e},fromRotation:function(e,d){var n=Math.sin(d),q=Math.cos(d);e[0]=q;e[1]=n;e[2]=0;e[3]=-n;e[4]=q;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}},mat4:{create:function(){var e=new Float32Array(16);e[0]=1;e[1]=0;e[2]=
0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e},identity:function(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e},translate:function(e,d,n){var q=n[0],c=n[1];n=n[2];var l,m,h,b,f,g,u,a,z,t,r,v;d===e?(e[12]=d[0]*q+d[4]*c+d[8]*n+d[12],e[13]=d[1]*q+d[5]*c+d[9]*n+d[13],e[14]=d[2]*q+d[6]*c+d[10]*n+d[14],e[15]=d[3]*q+d[7]*c+d[11]*n+d[15]):(l=d[0],m=d[1],h=d[2],
b=d[3],f=d[4],g=d[5],u=d[6],a=d[7],z=d[8],t=d[9],r=d[10],v=d[11],e[0]=l,e[1]=m,e[2]=h,e[3]=b,e[4]=f,e[5]=g,e[6]=u,e[7]=a,e[8]=z,e[9]=t,e[10]=r,e[11]=v,e[12]=l*q+f*c+z*n+d[12],e[13]=m*q+g*c+t*n+d[13],e[14]=h*q+u*c+r*n+d[14],e[15]=b*q+a*c+v*n+d[15]);return e},scale:function(e,d,n){var q=n[0],c=n[1];n=n[2];e[0]=d[0]*q;e[1]=d[1]*q;e[2]=d[2]*q;e[3]=d[3]*q;e[4]=d[4]*c;e[5]=d[5]*c;e[6]=d[6]*c;e[7]=d[7]*c;e[8]=d[8]*n;e[9]=d[9]*n;e[10]=d[10]*n;e[11]=d[11]*n;e[12]=d[12];e[13]=d[13];e[14]=d[14];e[15]=d[15];
return e},multiply:function(e,d,n){var q=d[0],c=d[1],l=d[2],m=d[3],h=d[4],b=d[5],f=d[6],g=d[7],u=d[8],a=d[9],z=d[10],t=d[11],r=d[12],v=d[13],C=d[14];d=d[15];var w=n[0],A=n[1],y=n[2],x=n[3];e[0]=w*q+A*h+y*u+x*r;e[1]=w*c+A*b+y*a+x*v;e[2]=w*l+A*f+y*z+x*C;e[3]=w*m+A*g+y*t+x*d;w=n[4];A=n[5];y=n[6];x=n[7];e[4]=w*q+A*h+y*u+x*r;e[5]=w*c+A*b+y*a+x*v;e[6]=w*l+A*f+y*z+x*C;e[7]=w*m+A*g+y*t+x*d;w=n[8];A=n[9];y=n[10];x=n[11];e[8]=w*q+A*h+y*u+x*r;e[9]=w*c+A*b+y*a+x*v;e[10]=w*l+A*f+y*z+x*C;e[11]=w*m+A*g+y*t+x*d;
w=n[12];A=n[13];y=n[14];x=n[15];e[12]=w*q+A*h+y*u+x*r;e[13]=w*c+A*b+y*a+x*v;e[14]=w*l+A*f+y*z+x*C;e[15]=w*m+A*g+y*t+x*d;return e},perspective:function(e,d,n,q,c){d=1/Math.tan(d/2);var l=1/(q-c);e[0]=d/n;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=d;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(c+q)*l;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*c*q*l;e[15]=0;return e},rotateX:function(e,d,n){var q=Math.sin(n);n=Math.cos(n);var c=d[4],l=d[5],m=d[6],h=d[7],b=d[8],f=d[9],g=d[10],u=d[11];d!==e&&(e[0]=d[0],e[1]=d[1],e[2]=d[2],e[3]=d[3],
e[12]=d[12],e[13]=d[13],e[14]=d[14],e[15]=d[15]);e[4]=c*n+b*q;e[5]=l*n+f*q;e[6]=m*n+g*q;e[7]=h*n+u*q;e[8]=b*n-c*q;e[9]=f*n-l*q;e[10]=g*n-m*q;e[11]=u*n-h*q;return e},rotateZ:function(e,d,n){var q=Math.sin(n);n=Math.cos(n);var c=d[0],l=d[1],m=d[2],h=d[3],b=d[4],f=d[5],g=d[6],u=d[7];d!==e&&(e[8]=d[8],e[9]=d[9],e[10]=d[10],e[11]=d[11],e[12]=d[12],e[13]=d[13],e[14]=d[14],e[15]=d[15]);e[0]=c*n+b*q;e[1]=l*n+f*q;e[2]=m*n+g*q;e[3]=h*n+u*q;e[4]=b*n-c*q;e[5]=f*n-l*q;e[6]=g*n-m*q;e[7]=u*n-h*q;return e},invert:function(e,
d){var n=d[0],q=d[1],c=d[2],l=d[3],m=d[4],h=d[5],b=d[6],f=d[7],g=d[8],u=d[9],a=d[10],z=d[11],t=d[12],r=d[13],v=d[14],C=d[15],w=n*h-q*m,A=n*b-c*m,y=n*f-l*m,x=q*b-c*h,F=q*f-l*h,G=c*f-l*b,k=g*r-u*t,p=g*v-a*t,K=g*C-z*t,I=u*v-a*r,E=u*C-z*r,H=a*C-z*v,L=w*H-A*E+y*I+x*K-F*p+G*k;if(!L)return null;L=1/L;e[0]=(h*H-b*E+f*I)*L;e[1]=(c*E-q*H-l*I)*L;e[2]=(r*G-v*F+C*x)*L;e[3]=(a*F-u*G-z*x)*L;e[4]=(b*K-m*H-f*p)*L;e[5]=(n*H-c*K+l*p)*L;e[6]=(v*y-t*G-C*A)*L;e[7]=(g*G-a*y+z*A)*L;e[8]=(m*E-h*K+f*k)*L;e[9]=(q*K-n*E-l*k)*
L;e[10]=(t*F-r*y+C*w)*L;e[11]=(u*y-g*F-z*w)*L;e[12]=(h*p-m*I-b*k)*L;e[13]=(n*I-q*p+c*k)*L;e[14]=(r*A-t*x-v*w)*L;e[15]=(g*x-u*A+a*w)*L;return e},ortho:function(e,d,n,q,c,l,m){var h=1/(d-n),b=1/(q-c),f=1/(l-m);e[0]=-2*h;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*b;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*f;e[11]=0;e[12]=(d+n)*h;e[13]=(c+q)*b;e[14]=(m+l)*f;e[15]=1;return e}}}})},{}],2:[function(a,p,k){(function(e,d){"object"===typeof k&&"undefined"!==typeof p?p.exports=d():e.ShelfPack=d()})(this,function(){function e(d,
c,l){l=l||{};this.w=d||64;this.h=c||64;this.autoResize=!!l.autoResize;this.shelves=[];this.freebins=[];this.stats={};this.bins={};this.maxId=0}function d(d,c,l){this.x=0;this.y=d;this.w=this.free=c;this.h=l}function n(d,c,l,m,h,b,f){this.id=d;this.x=c;this.y=l;this.w=m;this.h=h;this.maxw=b||m;this.maxh=f||h;this.refcount=0}e.prototype.pack=function(d,c){d=[].concat(d);c=c||{};for(var l=[],m,h,b,f=0;f<d.length;f++)if(m=d[f].w||d[f].width,h=d[f].h||d[f].height,b=d[f].id,m&&h&&(m=this.packOne(m,h,b)))c.inPlace&&
(d[f].x=m.x,d[f].y=m.y,d[f].id=m.id),l.push(m);if(0<this.shelves.length){for(h=m=f=0;h<this.shelves.length;h++)b=this.shelves[h],m+=b.h,f=Math.max(b.w-b.free,f);this.resize(f,m)}return l};e.prototype.packOne=function(e,c,l){var m=-1,h=-1,b=Infinity,f=0,g,u;if("string"===typeof l||"number"===typeof l){if(g=this.getBin(l))return this.ref(g),g;"number"===typeof l&&(this.maxId=Math.max(l,this.maxId))}else l=++this.maxId;for(u=0;u<this.freebins.length;u++){g=this.freebins[u];if(c===g.maxh&&e===g.maxw)return this.allocFreebin(u,
e,c,l);!(c>g.maxh||e>g.maxw)&&c<=g.maxh&&e<=g.maxw&&(g=g.maxw*g.maxh-e*c,g<b&&(b=g,m=u))}for(u=0;u<this.shelves.length;u++)if(g=this.shelves[u],f+=g.h,!(e>g.free)){if(c===g.h)return this.allocShelf(u,e,c,l);!(c>g.h)&&c<g.h&&(g=(g.h-c)*e,g<b&&(m=-1,b=g,h=u))}if(-1!==m)return this.allocFreebin(m,e,c,l);if(-1!==h)return this.allocShelf(h,e,c,l);if(c<=this.h-f&&e<=this.w)return g=new d(f,this.w,c),this.allocShelf(this.shelves.push(g)-1,e,c,l);if(this.autoResize){m=h=this.h;b=f=this.w;if(b<=m||e>b)f=2*
Math.max(e,b);if(m<b||c>m)h=2*Math.max(c,m);this.resize(f,h);return this.packOne(e,c,l)}return null};e.prototype.allocFreebin=function(d,c,l,m){d=this.freebins.splice(d,1)[0];d.id=m;d.w=c;d.h=l;d.refcount=0;this.bins[m]=d;this.ref(d);return d};e.prototype.allocShelf=function(d,c,l,m){d=this.shelves[d].alloc(c,l,m);this.bins[m]=d;this.ref(d);return d};e.prototype.getBin=function(d){return this.bins[d]};e.prototype.ref=function(d){if(1===++d.refcount){var c=d.h;this.stats[c]=(this.stats[c]|0)+1}return d.refcount};
e.prototype.unref=function(d){if(0===d.refcount)return 0;0===--d.refcount&&(this.stats[d.h]--,delete this.bins[d.id],this.freebins.push(d));return d.refcount};e.prototype.clear=function(){this.shelves=[];this.freebins=[];this.stats={};this.bins={};this.maxId=0};e.prototype.resize=function(d,c){this.w=d;this.h=c;for(var l=0;l<this.shelves.length;l++)this.shelves[l].resize(d);return!0};d.prototype.alloc=function(d,c,l){if(d>this.free||c>this.h)return null;var m=this.x;this.x+=d;this.free-=d;return new n(l,
m,this.y,d,c,d,this.h)};d.prototype.resize=function(d){this.free+=d-this.w;this.w=d;return!0};return e})},{}],3:[function(a,p,k){function e(d,c,l,m,h,b){this.fontSize=d||24;this.buffer=void 0===c?3:c;this.cutoff=m||.25;this.fontFamily=h||"sans-serif";this.fontWeight=b||"normal";this.radius=l||8;d=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=d;this.ctx=this.canvas.getContext("2d");this.ctx.font=this.fontWeight+" "+this.fontSize+
"px "+this.fontFamily;this.ctx.textBaseline="middle";this.ctx.fillStyle="black";this.gridOuter=new Float64Array(d*d);this.gridInner=new Float64Array(d*d);this.f=new Float64Array(d);this.d=new Float64Array(d);this.z=new Float64Array(d+1);this.v=new Int16Array(d);this.middle=Math.round(d/2*(0<=navigator.userAgent.indexOf("Gecko/")?1.2:1))}function d(d,c,l,m,h,b,f){for(var g=0;g<c;g++){for(var e=0;e<l;e++)m[e]=d[e*c+g];n(m,h,b,f,l);for(e=0;e<l;e++)d[e*c+g]=h[e]}for(e=0;e<l;e++){for(g=0;g<c;g++)m[g]=
d[e*c+g];n(m,h,b,f,c);for(g=0;g<c;g++)d[e*c+g]=Math.sqrt(h[g])}}function n(d,c,l,m,h){l[0]=0;m[0]=-1E20;m[1]=1E20;for(var b=1,f=0;b<h;b++){for(var g=(d[b]+b*b-(d[l[f]]+l[f]*l[f]))/(2*b-2*l[f]);g<=m[f];)f--,g=(d[b]+b*b-(d[l[f]]+l[f]*l[f]))/(2*b-2*l[f]);f++;l[f]=b;m[f]=g;m[f+1]=1E20}for(f=b=0;b<h;b++){for(;m[f+1]<b;)f++;c[b]=(b-l[f])*(b-l[f])+d[l[f]]}}p.exports=e;e.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size);this.ctx.fillText(e,this.buffer,this.middle);e=this.ctx.getImageData(0,
0,this.size,this.size);for(var c=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var m=e.data[4*l+3]/255;this.gridOuter[l]=1===m?0:0===m?1E20:Math.pow(Math.max(0,.5-m),2);this.gridInner[l]=1===m?1E20:0===m?0:Math.pow(Math.max(0,m-.5),2)}d(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z);d(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z);for(l=0;l<this.size*this.size;l++)c[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/
this.radius+this.cutoff))));return c}},{}],4:[function(a,p,k){function e(d,e,a,c){this.cx=3*d;this.bx=3*(a-d)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*e;this.by=3*(c-e)-this.cy;this.ay=1-this.cy-this.by;this.p1x=d;this.p1y=c;this.p2x=a;this.p2y=c}p.exports=e;e.prototype.sampleCurveX=function(d){return((this.ax*d+this.bx)*d+this.cx)*d};e.prototype.sampleCurveY=function(d){return((this.ay*d+this.by)*d+this.cy)*d};e.prototype.sampleCurveDerivativeX=function(d){return(3*this.ax*d+2*this.bx)*d+this.cx};
e.prototype.solveCurveX=function(d,e){"undefined"===typeof e&&(e=1E-6);var n,c,l,m;l=d;for(n=0;8>n;n++){m=this.sampleCurveX(l)-d;if(Math.abs(m)<e)return l;c=this.sampleCurveDerivativeX(l);if(1E-6>Math.abs(c))break;l-=m/c}n=0;c=1;l=d;if(l<n)return n;if(l>c)return c;for(;n<c;){m=this.sampleCurveX(l);if(Math.abs(m-d)<e)break;d>m?n=l:c=l;l=.5*(c-n)+n}return l};e.prototype.solve=function(d,e){return this.sampleCurveY(this.solveCurveX(d,e))}},{}],5:[function(a,p,k){(function(e,d){"object"===typeof k&&"undefined"!==
typeof p?d(k):d(e.WhooTS=e.WhooTS||{})})(this,function(e){function d(d,c,l){c=Math.pow(2,l)-c-1;var m=n(256*d,256*c,l);d=n(256*(d+1),256*(c+1),l);return m[0]+","+m[1]+","+d[0]+","+d[1]}function n(d,c,l){l=12756274*Math.PI/256/Math.pow(2,l);return[d*l-12756274*Math.PI/2,c*l-12756274*Math.PI/2]}e.getURL=function(e,c,l,m,h,b){b=b||{};return e+"?"+["bbox="+d(l,m,h),"format="+(b.format||"image/png"),"service="+(b.service||"WMS"),"version="+(b.version||"1.1.1"),"request="+(b.request||"GetMap"),"srs="+(b.srs||
"EPSG:3857"),"width="+(b.width||256),"height="+(b.height||256),"layers="+c].join("&")};e.getTileBBox=d;e.getMercCoords=n;Object.defineProperty(e,"__esModule",{value:!0})})},{}],6:[function(a,p,k){k=a("./lib/atob");a=a("./lib/btoa");p.exports={atob:k,btoa:a}},{"./lib/atob":7,"./lib/btoa":8}],7:[function(a,p,k){function e(d){if(/[A-Z]/.test(d))return d.charCodeAt(0)-65;if(/[a-z]/.test(d))return d.charCodeAt(0)-97+26;if(/[0-9]/.test(d))return d.charCodeAt(0)-48+52;if("+"==d)return 62;if("/"==d)return 63}
p.exports=function(d){d=String(d);d=d.replace(/[ \t\n\f\r]/g,"");0==d.length%4&&/==?$/.test(d)&&(d=d.replace(/==?$/,""));if(1==d.length%4||!/^[+/0-9A-Za-z]*$/.test(d))return null;for(var n="",a=0,c=0,l=0;l<d.length;l++)a<<=6,a|=e(d[l]),c+=6,24==c&&(n+=String.fromCharCode((a&16711680)>>16),n+=String.fromCharCode((a&65280)>>8),n+=String.fromCharCode(a&255),a=c=0);12==c?n+=String.fromCharCode(a>>4):18==c&&(a>>=2,n+=String.fromCharCode((a&65280)>>8),n+=String.fromCharCode(a&255));return n}},{}],8:[function(a,
p,k){function e(d){if(26>d)return String.fromCharCode(d+65);if(52>d)return String.fromCharCode(d-26+97);if(62>d)return String.fromCharCode(d-52+48);if(62==d)return"+";if(63==d)return"/"}p.exports=function(d){var n;d=String(d);for(n=0;n<d.length;n++)if(255<d.charCodeAt(n))return null;var a="";for(n=0;n<d.length;n+=3){var c=[void 0,void 0,void 0,void 0];c[0]=d.charCodeAt(n)>>2;c[1]=(d.charCodeAt(n)&3)<<4;d.length>n+1&&(c[1]|=d.charCodeAt(n+1)>>4,c[2]=(d.charCodeAt(n+1)&15)<<2);d.length>n+2&&(c[2]|=
d.charCodeAt(n+2)>>6,c[3]=d.charCodeAt(n+2)&63);for(var l=0;l<c.length;l++)a="undefined"==typeof c[l]?a+"=":a+e(c[l])}return a}},{}],9:[function(a,p,k){(function(e){function d(b,g){if(b===g)return 0;for(var f=b.length,c=g.length,h=0,d=Math.min(f,c);h<d;++h)if(b[h]!==g[h]){f=b[h];c=g[h];break}return f<c?-1:c<f?1:0}function n(b){return e.Buffer&&"function"===typeof e.Buffer.isBuffer?e.Buffer.isBuffer(b):!(null==b||!b._isBuffer)}function q(b){return n(b)||"function"!==typeof e.ArrayBuffer?!1:"function"===
typeof ArrayBuffer.isView?ArrayBuffer.isView(b):b?b instanceof DataView||b.buffer&&b.buffer instanceof ArrayBuffer?!0:!1:!1}function c(b){if(r.isFunction(b))return w?b.name:(b=b.toString().match(y))&&b[1]}function l(b,g){return"string"===typeof b?b.length<g?b:b.slice(0,g):b}function m(b){if(w||!r.isFunction(b))return r.inspect(b);b=c(b);return"[Function"+(b?": "+b:"")+"]"}function h(b,g,f,c,h){throw new A.AssertionError({message:f,actual:b,expected:g,operator:c,stackStartFunction:h});}function b(b,
g){b||h(b,!0,g,"==",A.ok)}function f(b,g,f,c){if(b===g)return!0;if(n(b)&&n(g))return 0===d(b,g);if(r.isDate(b)&&r.isDate(g))return b.getTime()===g.getTime();if(r.isRegExp(b)&&r.isRegExp(g))return b.source===g.source&&b.global===g.global&&b.multiline===g.multiline&&b.lastIndex===g.lastIndex&&b.ignoreCase===g.ignoreCase;if(null!==b&&"object"===typeof b||null!==g&&"object"===typeof g){if(!q(b)||!q(g)||Object.prototype.toString.call(b)!==Object.prototype.toString.call(g)||b instanceof Float32Array||b instanceof
Float64Array){if(n(b)!==n(g))return!1;c=c||{actual:[],expected:[]};var h=c.actual.indexOf(b);if(-1!==h&&h===c.expected.indexOf(g))return!0;c.actual.push(b);c.expected.push(g);return u(b,g,f,c)}return 0===d(new Uint8Array(b.buffer),new Uint8Array(g.buffer))}return f?b===g:b==g}function g(b){return"[object Arguments]"==Object.prototype.toString.call(b)}function u(b,c,h,d){if(null===b||void 0===b||null===c||void 0===c)return!1;if(r.isPrimitive(b)||r.isPrimitive(c))return b===c;if(h&&Object.getPrototypeOf(b)!==
Object.getPrototypeOf(c))return!1;var l=g(b),m=g(c);if(l&&!m||!l&&m)return!1;if(l)return b=C.call(b),c=C.call(c),f(b,c,h);var l=x(b),e=x(c);if(l.length!==e.length)return!1;l.sort();e.sort();for(m=l.length-1;0<=m;m--)if(l[m]!==e[m])return!1;for(m=l.length-1;0<=m;m--)if(e=l[m],!f(b[e],c[e],h,d))return!1;return!0}function D(b,g,c){f(b,g,!0)&&h(b,g,c,"notDeepStrictEqual",D)}function z(b,g){if(!b||!g)return!1;if("[object RegExp]"==Object.prototype.toString.call(g))return g.test(b);try{if(b instanceof g)return!0}catch(J){}return Error.isPrototypeOf(g)?
!1:!0===g.call({},b)}function t(b,g,c,f){if("function"!==typeof g)throw new TypeError('"block" argument must be a function');"string"===typeof c&&(f=c,c=null);var d;try{g()}catch(H){d=H}g=d;f=(c&&c.name?" ("+c.name+").":".")+(f?" "+f:".");b&&!g&&h(g,c,"Missing expected exception"+f);d="string"===typeof f;var l=!b&&r.isError(g),m=!b&&g&&!c;(l&&d&&z(g,c)||m)&&h(g,c,"Got unwanted exception"+f);if(b&&g&&c&&!z(g,c)||!b&&g)throw g;}var r=a("util/"),v=Object.prototype.hasOwnProperty,C=Array.prototype.slice,
w=function(){return"foo"===function(){}.name}(),A=p.exports=b,y=/\s*function\s+([^\(\s]*)\s*/;A.AssertionError=function(b){this.name="AssertionError";this.actual=b.actual;this.expected=b.expected;this.operator=b.operator;b.message?(this.message=b.message,this.generatedMessage=!1):(this.message=l(m(this.actual),128)+" "+this.operator+" "+l(m(this.expected),128),this.generatedMessage=!0);var g=b.stackStartFunction||h;Error.captureStackTrace?Error.captureStackTrace(this,g):(b=Error(),b.stack&&(b=b.stack,
g=c(g),g=b.indexOf("\n"+g),0<=g&&(g=b.indexOf("\n",g+1),b=b.substring(g+1)),this.stack=b))};r.inherits(A.AssertionError,Error);A.fail=h;A.ok=b;A.equal=function(b,g,c){b!=g&&h(b,g,c,"==",A.equal)};A.notEqual=function(b,g,c){b==g&&h(b,g,c,"!=",A.notEqual)};A.deepEqual=function(b,g,c){f(b,g,!1)||h(b,g,c,"deepEqual",A.deepEqual)};A.deepStrictEqual=function(b,g,c){f(b,g,!0)||h(b,g,c,"deepStrictEqual",A.deepStrictEqual)};A.notDeepEqual=function(b,g,c){f(b,g,!1)&&h(b,g,c,"notDeepEqual",A.notDeepEqual)};
A.notDeepStrictEqual=D;A.strictEqual=function(b,g,c){b!==g&&h(b,g,c,"===",A.strictEqual)};A.notStrictEqual=function(b,g,c){b===g&&h(b,g,c,"!==",A.notStrictEqual)};A["throws"]=function(b,g,c){t(!0,b,g,c)};A.doesNotThrow=function(b,g,c){t(!1,b,g,c)};A.ifError=function(b){if(b)throw b;};var x=Object.keys||function(b){var g=[],c;for(c in b)v.call(b,c)&&g.push(c);return g}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"util/":63}],
10:[function(a,p,k){function e(c){c=Math.round(c);return 0>c?0:255<c?255:c}function d(c){return 0>c?0:1<c?1:c}function n(c){return"%"===c[c.length-1]?e(parseFloat(c)/100*255):e(parseInt(c))}function q(c){return"%"===c[c.length-1]?d(parseFloat(c)/100):d(parseFloat(c))}function c(c,b,f){0>f?f+=1:1<f&&--f;return 1>6*f?c+(b-c)*f*6:1>2*f?b:2>3*f?c+(b-c)*(2/3-f)*6:c}function l(d){d=d.replace(/ /g,"").toLowerCase();if(d in m)return m[d].slice();if("#"===d[0])return 4===d.length?(d=parseInt(d.substr(1),16),
0<=d&&4095>=d?[(d&3840)>>4|(d&3840)>>8,d&240|(d&240)>>4,d&15|(d&15)<<4,1]:null):7===d.length?(d=parseInt(d.substr(1),16),0<=d&&16777215>=d?[(d&16711680)>>16,(d&65280)>>8,d&255,1]:null):null;var b=d.indexOf("("),f=d.indexOf(")");if(-1!==b&&f+1===d.length){var g=d.substr(0,b),b=d.substr(b+1,f-(b+1)).split(",");d=1;switch(g){case "rgba":if(4!==b.length)break;d=q(b.pop());case "rgb":if(3!==b.length)break;return[n(b[0]),n(b[1]),n(b[2]),d];case "hsla":if(4!==b.length)break;d=q(b.pop());case "hsl":if(3===
b.length)return g=(parseFloat(b[0])%360+360)%360/360,f=q(b[1]),b=q(b[2]),f=.5>=b?b*(f+1):b+f-b*f,b=2*b-f,[e(255*c(b,f,g+1/3)),e(255*c(b,f,g)),e(255*c(b,f,g-1/3)),d]}}return null}var m={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,
135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,
150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,
128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,
211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,
104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,
1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,
1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};try{k.parseCSSColor=l}catch(h){}},{}],11:[function(a,p,k){function e(b,g,f){f=f||2;var m=g&&g.length,e=m?g[0]*f:b.length,u=d(b,0,e,f,!0),a=[];if(!u)return a;
var D,r,C,v;if(m){var t=f,m=[],w,y,A;v=0;for(w=g.length;v<w;v++)y=g[v]*t,A=v<w-1?g[v+1]*t:b.length,y=d(b,y,A,t,!1),y===y.next&&(y.steiner=!0),m.push(h(y));m.sort(c);for(v=0;v<m.length;v++){g=m[v];t=u;if(t=l(g,t))g=z(t,g),n(g,g.next);u=n(u,u.next)}}if(b.length>80*f){D=C=b[0];r=m=b[1];for(t=f;t<e;t+=f)v=b[t],g=b[t+1],v<D&&(D=v),g<r&&(r=g),v>C&&(C=v),g>m&&(m=g);C=Math.max(C-D,m-r)}q(u,a,f,D,r,C);return a}function d(b,c,f,d,h){var l;if(h===0<C(b,c,f,d))for(h=c;h<f;h+=d)l=t(h,b[h],b[h+1],l);else for(h=
f-d;h>=c;h-=d)l=t(h,b[h],b[h+1],l);l&&g(l,l.next)&&(r(l),l=l.next);return l}function n(b,c){if(!b)return b;c||(c=b);var d=b,h;do if(h=!1,d.steiner||!g(d,d.next)&&0!==f(d.prev,d,d.next))d=d.next;else{r(d);d=c=d.prev;if(d===d.next)return null;h=!0}while(h||d!==c);return c}function q(c,d,h,l,e,a,C){if(c){if(!C&&a){var v=c,t=v;do null===t.z&&(t.z=m(t.x,t.y,l,e,a)),t.prevZ=t.prev,t=t.nextZ=t.next;while(t!==v);t.prevZ.nextZ=null;t.prevZ=null;var v=t,G,w,x,y,A,k,p=1;do{t=v;x=v=null;for(y=0;t;){y++;w=t;for(G=
A=0;G<p&&(A++,w=w.nextZ,w);G++);for(k=p;0<A||0<k&&w;)0===A?(G=w,w=w.nextZ,k--):0!==k&&w?t.z<=w.z?(G=t,t=t.nextZ,A--):(G=w,w=w.nextZ,k--):(G=t,t=t.nextZ,A--),x?x.nextZ=G:v=G,G.prevZ=x,x=G;t=w}x.nextZ=null;p*=2}while(1<y)}for(v=c;c.prev!==c.next;){t=c.prev;w=c.next;if(a)a:{x=c;k=l;var F=e,J=a;y=x.prev;A=x;p=x.next;if(0<=f(y,A,p))x=!1;else{var S=y.x>A.x?y.x>p.x?y.x:p.x:A.x>p.x?A.x:p.x,T=y.y>A.y?y.y>p.y?y.y:p.y:A.y>p.y?A.y:p.y;G=m(y.x<A.x?y.x<p.x?y.x:p.x:A.x<p.x?A.x:p.x,y.y<A.y?y.y<p.y?y.y:p.y:A.y<p.y?
A.y:p.y,k,F,J);k=m(S,T,k,F,J);for(F=x.nextZ;F&&F.z<=k;){if(F!==x.prev&&F!==x.next&&b(y.x,y.y,A.x,A.y,p.x,p.y,F.x,F.y)&&0<=f(F.prev,F,F.next)){x=!1;break a}F=F.nextZ}for(F=x.prevZ;F&&F.z>=G;){if(F!==x.prev&&F!==x.next&&b(y.x,y.y,A.x,A.y,p.x,p.y,F.x,F.y)&&0<=f(F.prev,F,F.next)){x=!1;break a}F=F.prevZ}x=!0}}else a:if(x=c,y=x.prev,A=x,p=x.next,0<=f(y,A,p))x=!1;else{for(G=x.next.next;G!==x.prev;){if(b(y.x,y.y,A.x,A.y,p.x,p.y,G.x,G.y)&&0<=f(G.prev,G,G.next)){x=!1;break a}G=G.next}x=!0}if(x)d.push(t.i/h),
d.push(c.i/h),d.push(w.i/h),r(c),v=c=w.next;else if(c=w,c===v){if(!C)q(n(c),d,h,l,e,a,1);else if(1===C){C=d;v=h;t=c;do w=t.prev,x=t.next.next,!g(w,x)&&u(w,t,t.next,x)&&D(w,x)&&D(x,w)&&(C.push(w.i/v),C.push(t.i/v),C.push(x.i/v),r(t),r(t.next),t=c=x),t=t.next;while(t!==c);c=t;q(c,d,h,l,e,a,2)}else if(2===C)a:{C=c;do{for(v=C.next.next;v!==C.prev;){if(t=C.i!==v.i){t=C;w=v;if(x=t.next.i!==w.i&&t.prev.i!==w.i){b:{x=t;do{if(x.i!==t.i&&x.next.i!==t.i&&x.i!==w.i&&x.next.i!==w.i&&u(x,x.next,t,w)){x=!0;break b}x=
x.next}while(x!==t);x=!1}x=!x}if(x=x&&D(t,w)&&D(w,t)){x=t;y=!1;A=(t.x+w.x)/2;w=(t.y+w.y)/2;do x.y>w!==x.next.y>w&&A<(x.next.x-x.x)*(w-x.y)/(x.next.y-x.y)+x.x&&(y=!y),x=x.next;while(x!==t);x=y}t=x}if(t){c=z(C,v);C=n(C,C.next);c=n(c,c.next);q(C,d,h,l,e,a);q(c,d,h,l,e,a);break a}v=v.next}C=C.next}while(C!==c)}break}}}}function c(b,g){return b.x-g.x}function l(g,c){var f=c,d=g.x,h=g.y,l=-Infinity,m;do{if(h<=f.y&&h>=f.next.y){var e=f.x+(h-f.y)*(f.next.x-f.x)/(f.next.y-f.y);if(e<=d&&e>l){l=e;if(e===d){if(h===
f.y)return f;if(h===f.next.y)return f.next}m=f.x<f.next.x?f:f.next}}f=f.next}while(f!==c);if(!m)return null;if(d===l)return m.prev;for(var e=m,u=m.x,n=m.y,a=Infinity,q,f=m.next;f!==e;)d>=f.x&&f.x>=u&&b(h<n?d:l,h,u,n,h<n?l:d,h,f.x,f.y)&&(q=Math.abs(h-f.y)/(d-f.x),(q<a||q===a&&f.x>m.x)&&D(f,g)&&(m=f,a=q)),f=f.next;return m}function m(b,g,c,f,d){b=32767*(b-c)/d;g=32767*(g-f)/d;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;g=(g|g<<8)&16711935;g=(g|g<<4)&252645135;g=(g|g<<2)&858993459;
return(b|b<<1)&1431655765|((g|g<<1)&1431655765)<<1}function h(b){var g=b,c=b;do g.x<c.x&&(c=g),g=g.next;while(g!==b);return c}function b(b,g,c,f,d,h,l,m){return 0<=(d-l)*(g-m)-(b-l)*(h-m)&&0<=(b-l)*(f-m)-(c-l)*(g-m)&&0<=(c-l)*(h-m)-(d-l)*(f-m)}function f(b,g,c){return(g.y-b.y)*(c.x-g.x)-(g.x-b.x)*(c.y-g.y)}function g(b,g){return b.x===g.x&&b.y===g.y}function u(b,c,d,h){return g(b,c)&&g(d,h)||g(b,h)&&g(d,c)?!0:0<f(b,c,d)!==0<f(b,c,h)&&0<f(d,h,b)!==0<f(d,h,c)}function D(b,g){return 0>f(b.prev,b,b.next)?
0<=f(b,g,b.next)&&0<=f(b,b.prev,g):0>f(b,g,b.prev)||0>f(b,b.next,g)}function z(b,g){var c=new v(b.i,b.x,b.y),f=new v(g.i,g.x,g.y),d=b.next,h=g.prev;b.next=g;g.prev=b;c.next=d;d.prev=c;f.next=c;c.prev=f;h.next=f;f.prev=h;return f}function t(b,g,c,f){b=new v(b,g,c);f?(b.next=f.next,b.prev=f,f.next.prev=b,f.next=b):(b.prev=b,b.next=b);return b}function r(b){b.next.prev=b.prev;b.prev.next=b.next;b.prevZ&&(b.prevZ.nextZ=b.nextZ);b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function v(b,g,c){this.i=b;this.x=g;this.y=
c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function C(b,g,c,f){for(var d=0,h=c-f;g<c;g+=f)d+=(b[h]-b[g])*(b[g+1]+b[h+1]),h=g;return d}p.exports=e;e.deviation=function(b,g,c,f){var d=g&&g.length,h=Math.abs(C(b,0,d?g[0]*c:b.length,c));if(d)for(var d=0,l=g.length;d<l;d++)h-=Math.abs(C(b,g[d]*c,d<l-1?g[d+1]*c:b.length,c));for(d=g=0;d<f.length;d+=3){var l=f[d]*c,m=f[d+1]*c,e=f[d+2]*c;g+=Math.abs((b[l]-b[e])*(b[m+1]-b[l+1])-(b[l]-b[m])*(b[e+1]-b[l+1]))}return 0===h&&0===g?0:
Math.abs((g-h)/h)};e.flatten=function(b){for(var g=b[0][0].length,c={vertices:[],holes:[],dimensions:g},f=0,d=0;d<b.length;d++){for(var h=0;h<b[d].length;h++)for(var l=0;l<g;l++)c.vertices.push(b[d][h][l]);0<d&&(f+=b[d-1].length,c.holes.push(f))}return c}},{}],12:[function(a,p,k){function e(d){var h,b,f,g,m,a;switch(typeof d){case "object":if(null===d)return null;if(n(d)){f="[";b=d.length-1;for(h=0;h<b;h++)f+=e(d[h])+",";-1<b&&(f+=e(d[h]));return f+"]"}g=q(d).sort();b=g.length;f="{";m=g[h=0];for(a=
0<b&&void 0!==d[m];h<b;)a?(f+='"'+m.replace(c,l)+'":'+e(d[m]),m=g[++h],(a=h<b&&void 0!==d[m])&&(f+=",")):(m=g[++h],a=h<b&&void 0!==d[m]);return f+"}";case "undefined":return null;case "string":return'"'+d.replace(c,l)+'"';default:return d}}var d={}.toString,n=Array.isArray||function(c){return"[object Array]"===d.call(c)},q=Object.keys||function(c){var d=[],b;for(b in c)c.hasOwnProperty(b)&&d.push(b);return d},c=/[\u0000-\u001f"\\]/g,l=function(c){c=c.charCodeAt(0);switch(c){case 34:return'\\"';case 92:return"\\\\";
case 12:return"\\f";case 10:return"\\n";case 13:return"\\r";case 9:return"\\t";case 8:return"\\b";default:return 15<c?"\\u00"+c.toString(16):"\\u000"+c.toString(16)}};p.exports=function(c){if(void 0!==c)return""+e(c)};p.exports.stringSearch=c;p.exports.stringReplace=l},{}],13:[function(a,p,k){function e(e){var c=0;if(e&&0<e.length)for(var c=c+Math.abs(d(e[0])),l=1;l<e.length;l++)c-=Math.abs(d(e[l]));return c}function d(d){var c=0;if(2<d.length){for(var l,m,h=0;h<d.length-1;h++)l=d[h],m=d[h+1],c+=
(m[0]-l[0])*Math.PI/180*(2+Math.sin(l[1]*Math.PI/180)+Math.sin(m[1]*Math.PI/180));c=c*n.RADIUS*n.RADIUS/2}return c}var n=a("wgs84");p.exports.geometry=function(d){if("Polygon"===d.type)return e(d.coordinates);if("MultiPolygon"===d.type){for(var c=0,l=0;l<d.coordinates.length;l++)c+=e(d.coordinates[l]);return c}return null};p.exports.ring=d},{wgs84:72}],14:[function(a,p,k){function e(c,m){switch(c&&c.type||null){case "FeatureCollection":return c.features=c.features.map(d(e,m)),c;case "Feature":return c.geometry=
e(c.geometry,m),c;case "Polygon":case "MultiPolygon":return"Polygon"===c.type?c.coordinates=n(c.coordinates,m):"MultiPolygon"===c.type&&(c.coordinates=c.coordinates.map(d(n,m))),c;default:return c}}function d(c,d){return function(h){return c(h,d)}}function n(c,d){d=!!d;c[0]=q(c[0],!d);for(var h=1;h<c.length;h++)c[h]=q(c[h],d);return c}function q(d,m){return 0<=c.ring(d)===m?d:d.reverse()}var c=a("geojson-area");p.exports=e},{"geojson-area":13}],15:[function(a,p,k){function e(d,e,c,l,m){e.length&&
(e.area=c,e.dist=l,void 0!==m&&(e.outer=m),d.push(e));return[]}p.exports=function(n,a,c,l,m,h,b,f){c/=a;l/=a;if(b>=c&&f<=l)return n;if(b>l||f<c)return null;a=[];for(b=0;b<n.length;b++){f=n[b];var g=f.geometry,u=f.type,q,z;q=f.min[m];z=f.max[m];if(q>=c&&z<=l)a.push(f);else if(!(q>l||z<c)){if(1===u){q=c;z=l;for(var t=m,r=[],v=0;v<g.length;v++){var C=g[v],w=C[t];w>=q&&w<=z&&r.push(C)}g=r}else{q=c;z=l;t=m;r=h;v=3===u;C=[];for(w=0;w<g.length;w++){var A,y=0,x=null,p=g[w],G=p.area,k=p.dist,B=p.outer,K=p.length,
I,E,H=[];for(E=0;E<K-1;E++)I=x||p[E],x=p[E+1],A=y||I[t],y=x[t],A<q?y>z?(H.push(r(I,x,q),r(I,x,z)),v||(H=e(C,H,G,k,B))):y>=q&&H.push(r(I,x,q)):A>z?y<q?(H.push(r(I,x,z),r(I,x,q)),v||(H=e(C,H,G,k,B))):y<=z&&H.push(r(I,x,z)):(H.push(I),y<q?(H.push(r(I,x,q)),v||(H=e(C,H,G,k,B))):y>z&&(H.push(r(I,x,z)),v||(H=e(C,H,G,k,B))));I=p[K-1];A=I[t];A>=q&&A<=z&&H.push(I);A=H[H.length-1];v&&A&&(H[0][0]!==A[0]||H[0][1]!==A[1])&&H.push(H[0]);e(C,H,G,k,B)}g=C}g.length&&a.push(d(f.tags,u,g,f.id))}}return a.length?a:null};
var d=a("./feature")},{"./feature":17}],16:[function(a,p,k){function e(l,m,h){if(null!==m.geometry){var b=m.geometry,f=b.type,g=b.coordinates,u=m.properties;m=m.id;var a,q;if("Point"===f)l.push(c(u,1,[n(g)],m));else if("MultiPoint"===f)l.push(c(u,1,d(g),m));else if("LineString"===f)l.push(c(u,2,[d(g,h)],m));else if("MultiLineString"===f||"Polygon"===f){b=[];for(a=0;a<g.length;a++)q=d(g[a],h),"Polygon"===f&&(q.outer=0===a),b.push(q);l.push(c(u,"Polygon"===f?3:2,b,m))}else if("MultiPolygon"===f){b=
[];for(a=0;a<g.length;a++)for(f=0;f<g[a].length;f++)q=d(g[a][f],h),q.outer=0===f,b.push(q);l.push(c(u,3,b,m))}else if("GeometryCollection"===f)for(a=0;a<b.geometries.length;a++)e(l,{geometry:b.geometries[a],properties:u},h);else throw Error("Input data is not a valid GeoJSON object.");}}function d(c,d){for(var h=[],b=0;b<c.length;b++)h.push(n(c[b]));if(d){q(h,d);for(var f=b=0,g=0,l,m;g<h.length-1;g++)l=m||h[g],m=h[g+1],b+=l[0]*m[1]-m[0]*l[1],f+=Math.abs(m[0]-l[0])+Math.abs(m[1]-l[1]);h.area=Math.abs(b/
2);h.dist=f}return h}function n(c){var d=Math.sin(c[1]*Math.PI/180),d=.5-.25*Math.log((1+d)/(1-d))/Math.PI;return[c[0]/360+.5,0>d?0:1<d?1:d,0]}p.exports=function(c,d){var h=[];if("FeatureCollection"===c.type)for(var b=0;b<c.features.length;b++)e(h,c.features[b],d);else"Feature"===c.type?e(h,c,d):e(h,{geometry:c},d);return h};var q=a("./simplify"),c=a("./feature")},{"./feature":17,"./simplify":19}],17:[function(a,p,k){function e(d,e,a){for(var c=0,l;c<a.length;c++)l=a[c],d[0]=Math.min(l[0],d[0]),e[0]=
Math.max(l[0],e[0]),d[1]=Math.min(l[1],d[1]),e[1]=Math.max(l[1],e[1])}p.exports=function(d,a,q,c){d={id:c||null,type:a,geometry:q,tags:d||null,min:[Infinity,Infinity],max:[-Infinity,-Infinity]};a=d.geometry;q=d.min;c=d.max;if(1===d.type)e(q,c,a);else for(var l=0;l<a.length;l++)e(q,c,a[l]);return d}},{}],18:[function(a,p,k){function e(b,g){var f=Object.create(this.options),l=g,e;for(e in l)f[e]=l[e];g=this.options=f;(f=g.debug)&&console.time("preprocess data");l=c(b,g.tolerance/((1<<g.maxZoom)*g.extent));
this.tiles={};this.tileCoords=[];f&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",g.indexMaxZoom,g.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0);l=h(l,g.buffer/g.extent,d);l.length&&this.splitTile(l,0,0,0);f&&(l.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function d(b,c,d){return[d,
(d-b[0])*(c[1]-b[1])/(c[0]-b[0])+b[1],1]}function n(b,c,d){return[(d-b[1])*(c[0]-b[0])/(c[1]-b[1])+b[0],d,1]}function q(b,c,d){var g=b.source;if(1!==g.length)return!1;g=g[0];if(3!==g.type||1<g.geometry.length)return!1;var f=g.geometry[0].length;if(5!==f)return!1;for(var h=0;h<f;h++){var e=l.point(g.geometry[0][h],c,b.z2,b.x,b.y);if(e[0]!==-d&&e[0]!==c+d||e[1]!==-d&&e[1]!==c+d)return!1}return!0}p.exports=function(b,c){return new e(b,c)};var c=a("./convert"),l=a("./transform"),m=a("./clip"),h=a("./wrap"),
b=a("./tile");e.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1E5,solidChildren:!1,tolerance:3,extent:4096,buffer:64,debug:0};e.prototype.splitTile=function(c,g,h,l,e,a,r){for(var f=[c,g,h,l],u=this.options,D=u.debug,z=null;f.length;){l=f.pop();h=f.pop();g=f.pop();c=f.pop();var t=1<<g,x=32*((1<<g)*l+h)+g,p=this.tiles[x],G=g===u.maxZoom?0:u.tolerance/(t*u.extent);p||(1<D&&console.time("creation"),p=this.tiles[x]=b(c,t,h,l,G,g===u.maxZoom),this.tileCoords.push({z:g,x:h,y:l}),D&&(1<D&&
(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",g,h,l,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation")),x="z"+g,this.stats[x]=(this.stats[x]||0)+1,this.total++));p.source=c;if(e){if(g===u.maxZoom||g===e)continue;x=1<<e-g;if(h!==Math.floor(a/x)||l!==Math.floor(r/x))continue}else if(g===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(!u.solidChildren&&q(p,u.extent,u.buffer))e&&(z=g);else{p.source=null;1<D&&console.time("clipping");var x=.5*u.buffer/
u.extent,G=.5-x,k=.5+x,B=1+x,K,I,E,H,L,N;K=I=E=H=null;L=m(c,t,h-x,h+k,0,d,p.min[0],p.max[0]);N=m(c,t,h+G,h+B,0,d,p.min[0],p.max[0]);L&&(K=m(L,t,l-x,l+k,1,n,p.min[1],p.max[1]),I=m(L,t,l+G,l+B,1,n,p.min[1],p.max[1]));N&&(E=m(N,t,l-x,l+k,1,n,p.min[1],p.max[1]),H=m(N,t,l+G,l+B,1,n,p.min[1],p.max[1]));1<D&&console.timeEnd("clipping");c.length&&(f.push(K||[],g+1,2*h,2*l),f.push(I||[],g+1,2*h,2*l+1),f.push(E||[],g+1,2*h+1,2*l),f.push(H||[],g+1,2*h+1,2*l+1))}}return z};e.prototype.getTile=function(b,c,d){var g=
this.options,f=g.extent,h=g.debug,e=1<<b;c=(c%e+e)%e;e=32*((1<<b)*d+c)+b;if(this.tiles[e])return l.tile(this.tiles[e],f);1<h&&console.log("drilling down to z%d-%d-%d",b,c,d);for(var m=b,a=c,u=d,n;!n&&0<m;)m--,a=Math.floor(a/2),u=Math.floor(u/2),n=this.tiles[32*((1<<m)*u+a)+m];if(!n||!n.source)return null;1<h&&console.log("found parent tile z%d-%d-%d",m,a,u);if(q(n,f,g.buffer))return l.tile(n,f);1<h&&console.time("drilling down");g=this.splitTile(n.source,m,a,u,b,c,d);1<h&&console.timeEnd("drilling down");
null!==g&&(b=1<<b-g,e=32*((1<<g)*Math.floor(d/b)+Math.floor(c/b))+g);return this.tiles[e]?l.tile(this.tiles[e],f):null}},{"./clip":15,"./convert":16,"./tile":20,"./transform":21,"./wrap":22}],19:[function(a,p,k){p.exports=function(e,d){var a=d*d,q=0,c=e.length-1,l=[],m,h,b,f;e[q][2]=1;for(e[c][2]=1;c;){h=0;for(m=q+1;m<c;m++){var g=e[m],u=e[q],D=e[c];b=u[0];var u=u[1],z=D[0],D=D[1],t=g[0],g=g[1],r=z-b,v=D-u;if(0!==r||0!==v){var C=((t-b)*r+(g-u)*v)/(r*r+v*v);1<C?(b=z,u=D):0<C&&(b+=r*C,u+=v*C)}r=t-b;
v=g-u;b=r*r+v*v;b>h&&(f=m,h=b)}h>a?(e[f][2]=h,l.push(q),l.push(f),q=f):(c=l.pop(),q=l.pop())}}},{}],20:[function(a,p,k){p.exports=function(e,d,a,q,c,l){d={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:a,y:q,z2:d,transformed:!1,min:[2,1],max:[-1,0]};for(a=0;a<e.length;a++){d.numFeatures++;var m,h,b,f;q=d;var g=e[a],u=c,n=l,z=g.geometry,t=g.type,r=[],v=u*u;if(1===t)for(f=0;f<z.length;f++)r.push(z[f]),q.numPoints++,q.numSimplified++;else for(f=0;f<z.length;f++)if(h=z[f],!n&&(2===
t&&h.dist<u||3===t&&h.area<v))q.numPoints+=h.length;else{var C=[];for(b=0;b<h.length;b++){m=h[b];if(n||m[2]>v)C.push(m),q.numSimplified++;q.numPoints++}if(3===t){var w,p=b=0,y=C.length;for(w=y-1;p<y;w=p++)m=C[p],w=C[w],b+=(w[0]-m[0])*(m[1]+w[1]);0>b===h.outer&&C.reverse()}r.push(C)}r.length&&(h={geometry:r,type:t,tags:g.tags||null},null!==g.id&&(h.id=g.id),q.features.push(h));q=e[a].min;g=e[a].max;q[0]<d.min[0]&&(d.min[0]=q[0]);q[1]<d.min[1]&&(d.min[1]=q[1]);g[0]>d.max[0]&&(d.max[0]=g[0]);g[1]>d.max[1]&&
(d.max[1]=g[1])}return d}},{}],21:[function(a,p,k){function e(d,e,a,c,l){return[Math.round(e*(d[0]*a-c)),Math.round(e*(d[1]*a-l))]}k.tile=function(d,a){if(d.transformed)return d;var n=d.z2,c=d.x,l=d.y,m,h,b;for(m=0;m<d.features.length;m++){h=d.features[m];var f=h.geometry;if(1===h.type)for(h=0;h<f.length;h++)f[h]=e(f[h],a,n,c,l);else for(h=0;h<f.length;h++){var g=f[h];for(b=0;b<g.length;b++)g[b]=e(g[b],a,n,c,l)}}d.transformed=!0;return d};k.point=e},{}],22:[function(a,p,k){function e(c,l){for(var e=
[],h=0;h<c.length;h++){var b=c[h],f=b.type,g;if(1===f)g=d(b.geometry,l);else{g=[];for(var a=0;a<b.geometry.length;a++)g.push(d(b.geometry[a],l))}e.push(q(b.tags,f,g,b.id))}return e}function d(c,d){var l=[];l.area=c.area;l.dist=c.dist;for(var h=0;h<c.length;h++)l.push([c[h][0]+d,c[h][1],c[h][2]]);return l}var n=a("./clip"),q=a("./feature");p.exports=function(c,d,m){var h=c,b=n(c,1,-1-d,d,0,m,-1,2),f=n(c,1,1-d,2+d,0,m,-1,2);if(b||f)h=n(c,1,-d,1+d,0,m,-1,2)||[],b&&(h=e(b,1).concat(h)),f&&(h=h.concat(e(f,
-1)));return h}},{"./clip":15,"./feature":17}],23:[function(a,p,k){function e(e,a,c){var l=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var m=new Int32Array(this.arrayBuffer);e=m[0];a=m[1];c=m[2];this.d=a+2*c;for(var h=0;h<this.d*this.d;h++){var b=m[d+h],f=m[d+h+1];l.push(b===f?null:m.subarray(b,f))}h=m[d+l.length+1];this.keys=m.subarray(m[d+l.length],h);this.bboxes=m.subarray(h);this.insert=this._insertReadonly}else{this.d=a+2*c;for(m=0;m<this.d*this.d;m++)l.push([]);this.keys=[];
this.bboxes=[]}this.n=a;this.extent=e;this.padding=c;this.scale=a/e;this.uid=0;a=c/a*e;this.min=-a;this.max=e+a}p.exports=e;var d=3;e.prototype.insert=function(d,e,c,l,m){this._forEachCell(e,c,l,m,this._insertCell,this.uid++);this.keys.push(d);this.bboxes.push(e);this.bboxes.push(c);this.bboxes.push(l);this.bboxes.push(m)};e.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer.";};e.prototype._insertCell=function(d,e,c,l,m,h){this.cells[m].push(h)};
e.prototype.query=function(d,e,c,l){var m=this.min,h=this.max;if(d<=m&&e<=m&&h<=c&&h<=l)return Array.prototype.slice.call(this.keys);m=[];this._forEachCell(d,e,c,l,this._queryCell,m,{});return m};e.prototype._queryCell=function(d,e,c,l,m,h,b){m=this.cells[m];if(null!==m)for(var f=this.keys,g=this.bboxes,a=0;a<m.length;a++){var n=m[a];if(void 0===b[n]){var q=4*n;d<=g[q+2]&&e<=g[q+3]&&c>=g[q+0]&&l>=g[q+1]?(b[n]=!0,h.push(f[n])):b[n]=!1}}};e.prototype._forEachCell=function(d,e,c,l,m,h,b){for(var f=this._convertToCellCoord(d),
g=this._convertToCellCoord(e),a=this._convertToCellCoord(c),n=this._convertToCellCoord(l);f<=a;f++)for(var q=g;q<=n;q++)if(m.call(this,d,e,c,l,this.d*q+f,h,b))return};e.prototype._convertToCellCoord=function(d){return Math.max(0,Math.min(this.d-1,Math.floor(d*this.scale)+this.padding))};e.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,a=d+this.cells.length+1+1,c=0,l=0;l<this.cells.length;l++)c+=this.cells[l].length;c=new Int32Array(a+c+this.keys.length+
this.bboxes.length);c[0]=this.extent;c[1]=this.n;c[2]=this.padding;for(l=0;l<e.length;l++){var m=e[l];c[d+l]=a;c.set(m,a);a+=m.length}c[d+e.length]=a;c.set(this.keys,a);a+=this.keys.length;c[d+e.length+1]=a;c.set(this.bboxes,a);return c.buffer}},{}],24:[function(a,p,k){k.read=function(e,d,a,q,c){var l;l=8*c-q-1;var m=(1<<l)-1,h=m>>1,b=-7;c=a?c-1:0;var f=a?-1:1,g=e[d+c];c+=f;a=g&(1<<-b)-1;g>>=-b;for(b+=l;0<b;a=256*a+e[d+c],c+=f,b-=8);l=a&(1<<-b)-1;a>>=-b;for(b+=q;0<b;l=256*l+e[d+c],c+=f,b-=8);if(0===
a)a=1-h;else{if(a===m)return l?NaN:Infinity*(g?-1:1);l+=Math.pow(2,q);a-=h}return(g?-1:1)*l*Math.pow(2,a-q)};k.write=function(e,d,a,q,c,l){var m,h=8*l-c-1,b=(1<<h)-1,f=b>>1,g=23===c?Math.pow(2,-24)-Math.pow(2,-77):0;l=q?0:l-1;var u=q?1:-1,n=0>d||0===d&&0>1/d?1:0;d=Math.abs(d);isNaN(d)||Infinity===d?(d=isNaN(d)?1:0,q=b):(q=Math.floor(Math.log(d)/Math.LN2),1>d*(m=Math.pow(2,-q))&&(q--,m*=2),d=1<=q+f?d+g/m:d+g*Math.pow(2,1-f),2<=d*m&&(q++,m/=2),q+f>=b?(d=0,q=b):1<=q+f?(d=(d*m-1)*Math.pow(2,c),q+=f):
(d=d*Math.pow(2,f-1)*Math.pow(2,c),q=0));for(;8<=c;e[a+l]=d&255,l+=u,d/=256,c-=8);q=q<<c|d;for(h+=c;0<h;e[a+l]=q&255,l+=u,q/=256,h-=8);e[a+l-u]|=128*n}},{}],25:[function(a,p,k){function e(c,h,b,f,g){h=h||d;b=b||n;g=g||Array;this.nodeSize=f||64;this.points=c;this.ids=new g(c.length);this.coords=new g(2*c.length);for(f=0;f<c.length;f++)this.ids[f]=f,this.coords[2*f]=h(c[f]),this.coords[2*f+1]=b(c[f]);q(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function d(c){return c[0]}function n(c){return c[1]}
var q=a("./sort"),c=a("./range"),l=a("./within");p.exports=function(c,d,b,f,g){return new e(c,d,b,f,g)};e.prototype={range:function(d,h,b,f){return c(this.ids,this.coords,d,h,b,f,this.nodeSize)},within:function(c,d,b){return l(this.ids,this.coords,c,d,b,this.nodeSize)}}},{"./range":26,"./sort":27,"./within":28}],26:[function(a,p,k){p.exports=function(e,d,a,q,c,l,m){for(var h=[0,e.length-1,0],b=[],f,g;h.length;){var u=h.pop(),n=h.pop(),z=h.pop();if(n-z<=m)for(u=z;u<=n;u++)f=d[2*u],g=d[2*u+1],f>=a&&
f<=c&&g>=q&&g<=l&&b.push(e[u]);else{var t=Math.floor((z+n)/2);f=d[2*t];g=d[2*t+1];f>=a&&f<=c&&g>=q&&g<=l&&b.push(e[t]);var r=(u+1)%2;if(0===u?a<=f:q<=g)h.push(z),h.push(t-1),h.push(r);if(0===u?c>=f:l>=g)h.push(t+1),h.push(n),h.push(r)}}return b}},{}],27:[function(a,p,k){function e(c,l,m,h,b,f){if(!(b-h<=m)){var g=Math.floor((h+b)/2);d(c,l,g,h,b,f%2);e(c,l,m,h,g-1,f+1);e(c,l,m,g+1,b,f+1)}}function d(c,l,e,h,b,f){for(;b>h;){if(600<b-h){var g=b-h+1,m=e-h+1,a=Math.log(g),q=.5*Math.exp(2*a/3),a=.5*Math.sqrt(a*
q*(g-q)/g)*(0>m-g/2?-1:1);d(c,l,e,Math.max(h,Math.floor(e-m*q/g+a)),Math.min(b,Math.floor(e+(g-m)*q/g+a)),f)}g=l[2*e+f];m=h;q=b;n(c,l,h,e);for(l[2*b+f]>g&&n(c,l,h,b);m<q;){n(c,l,m,q);m++;for(q--;l[2*m+f]<g;)m++;for(;l[2*q+f]>g;)q--}l[2*h+f]===g?n(c,l,h,q):(q++,n(c,l,q,b));q<=e&&(h=q+1);e<=q&&(b=q-1)}}function n(c,d,e,h){q(c,e,h);q(d,2*e,2*h);q(d,2*e+1,2*h+1)}function q(c,d,e){var h=c[d];c[d]=c[e];c[e]=h}p.exports=e},{}],28:[function(a,p,k){p.exports=function(e,d,a,q,c,l){for(var m=[0,e.length-1,0],
h=[],b=c*c;m.length;){var f=m.pop(),g=m.pop(),u=m.pop();if(g-u<=l)for(f=u;f<=g;f++){var u=d[2*f]-a,n=d[2*f+1]-q;u*u+n*n<=b&&h.push(e[f])}else{var n=Math.floor((u+g)/2),z=d[2*n],t=d[2*n+1],r=z-a,v=t-q;r*r+v*v<=b&&h.push(e[n]);r=(f+1)%2;if(0===f?a-c<=z:q-c<=t)m.push(u),m.push(n-1),m.push(r);if(0===f?a+c>=z:q+c>=t)m.push(n+1),m.push(g),m.push(r)}}return h}},{}],29:[function(a,p,k){function e(b,c){for(var g=-1,d=b.length;++g<d;)if(c(b[g],g,b))return!0;return!1}function d(g,h,e,a,t,r){if(g===h)return!0;
var u;(u=null==g||null==h)||(u=typeof g,u=!(g&&("object"==u||"function"==u))&&!(h&&"object"==typeof h));if(u)return g!==g&&h!==h;a:{u=l(g);var D=l(h),z="[object Array]",p="[object Array]";u||(z=f.call(g),"[object Arguments]"==z?z="[object Object]":"[object Object]"!=z&&(u=m(g)));D||(p=f.call(h),"[object Arguments]"==p?p="[object Object]":"[object Object]"!=p&&m(h));var y="[object Object]"==z,D="[object Object]"==p,p=z==p;if(!p||u||y){if(!a&&(z=y&&b.call(g,"__wrapped__"),D=D&&b.call(h,"__wrapped__"),
z||D)){g=d(z?g.value():g,D?h.value():h,e,a,t,r);break a}if(p){t||(t=[]);r||(r=[]);for(z=t.length;z--;)if(t[z]==g){g=r[z]==h;break a}t.push(g);r.push(h);g=(u?n:c)(g,h,d,e,a,t,r);t.pop();r.pop()}else g=!1}else g=q(g,h,z)}return g}function n(b,c,d,f,h,l,m){var g=-1,a=b.length,u=c.length;if(a!=u&&!(h&&u>a))return!1;for(;++g<a;){var n=b[g],u=c[g],q=f?f(h?u:n,h?n:u,g):void 0;if(void 0!==q){if(q)continue;return!1}if(h){if(!e(c,function(b){return n===b||d(n,b,f,h,l,m)}))return!1}else if(n!==u&&!d(n,u,f,h,
l,m))return!1}return!0}function q(b,c,d){switch(d){case "[object Boolean]":case "[object Date]":return+b==+c;case "[object Error]":return b.name==c.name&&b.message==c.message;case "[object Number]":return b!=+b?c!=+c:b==+c;case "[object RegExp]":case "[object String]":return b==c+""}return!1}function c(c,d,f,e,l,m,a){var g=h(c),u=g.length,n=h(d).length;if(u!=n&&!l)return!1;for(n=u;n--;){var q=g[n];if(!(l?q in d:b.call(d,q)))return!1}for(var r=l;++n<u;){var q=g[n],D=c[q],z=d[q],t=e?e(l?z:D,l?D:z,q):
void 0;if(void 0===t?!f(D,z,e,l,m,a):!t)return!1;r||(r="constructor"==q)}return r||(f=c.constructor,e=d.constructor,!(f!=e&&"constructor"in c&&"constructor"in d)||"function"==typeof f&&f instanceof f&&"function"==typeof e&&e instanceof e)?!0:!1}var l=a("lodash.isarray"),m=a("lodash.istypedarray"),h=a("lodash.keys");a=Object.prototype;var b=a.hasOwnProperty,f=a.toString;p.exports=d},{"lodash.isarray":33,"lodash.istypedarray":35,"lodash.keys":36}],30:[function(a,p,k){function e(d){return d}p.exports=
function(d,a,q){if("function"!=typeof d)return e;if(void 0===a)return d;switch(q){case 1:return function(c){return d.call(a,c)};case 3:return function(c,e,m){return d.call(a,c,e,m)};case 4:return function(c,e,m,h){return d.call(a,c,e,m,h)};case 5:return function(c,e,m,h,b){return d.call(a,c,e,m,h,b)}}return function(){return d.apply(a,arguments)}}},{}],31:[function(a,p,k){var e=/^\[object .+?Constructor\]$/;a=Object.prototype;var d=Function.prototype.toString,n=a.toString,q=RegExp("^"+d.call(a.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,
"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");p.exports=function(c,l){var m=null==c?void 0:c[l];var h;null==m?h=!1:(h=typeof m,h=!m||"object"!=h&&"function"!=h||"[object Function]"!=n.call(m)?!!m&&"object"==typeof m&&e.test(m):q.test(d.call(m)));return h?m:void 0}},{}],32:[function(a,p,k){a=Object.prototype;var e=a.hasOwnProperty,d=a.toString,n=a.propertyIsEnumerable;p.exports=function(a){var c;if(c=!!a&&"object"==typeof a){if(c=null!=a)c=a.length,c="number"==
typeof c&&-1<c&&0==c%1&&9007199254740991>=c;c&&(c=typeof a,c=!a||"object"!=c&&"function"!=c?"":d.call(a),c=!("[object Function]"==c||"[object GeneratorFunction]"==c))}return c&&e.call(a,"callee")&&(!n.call(a,"callee")||"[object Arguments]"==d.call(a))}},{}],33:[function(a,p,k){var e=/^\[object .+?Constructor\]$/;a=Object.prototype;var d=Function.prototype.toString,n=a.toString,q=RegExp("^"+d.call(a.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,
"$1.*?")+"$");a=function(c,l){var m=null==c?void 0:c[l];var h;null==m?h=!1:(h=typeof m,h=!m||"object"!=h&&"function"!=h||"[object Function]"!=n.call(m)?!!m&&"object"==typeof m&&e.test(m):q.test(d.call(m)));return h?m:void 0}(Array,"isArray")||function(c){var d;if(d=!!c&&"object"==typeof c)d=c.length,d="number"==typeof d&&-1<d&&0==d%1&&9007199254740991>=d;return d&&"[object Array]"==n.call(c)};p.exports=a},{}],34:[function(a,p,k){var e=a("lodash._baseisequal"),d=a("lodash._bindcallback");p.exports=
function(a,q,c,l){l=(c="function"==typeof c?d(c,l,3):void 0)?c(a,q):void 0;return void 0===l?e(a,q,c):!!l}},{"lodash._baseisequal":29,"lodash._bindcallback":30}],35:[function(a,p,k){var e={};e["[object Float32Array]"]=e["[object Float64Array]"]=e["[object Int8Array]"]=e["[object Int16Array]"]=e["[object Int32Array]"]=e["[object Uint8Array]"]=e["[object Uint8ClampedArray]"]=e["[object Uint16Array]"]=e["[object Uint32Array]"]=!0;e["[object Arguments]"]=e["[object Array]"]=e["[object ArrayBuffer]"]=
e["[object Boolean]"]=e["[object DataView]"]=e["[object Date]"]=e["[object Error]"]=e["[object Function]"]=e["[object Map]"]=e["[object Number]"]=e["[object Object]"]=e["[object RegExp]"]=e["[object Set]"]=e["[object String]"]=e["[object WeakMap]"]=!1;var d=Object.prototype.toString;p.exports=function(a){var n;if(n=!!a&&"object"==typeof a)n=a.length,n="number"==typeof n&&-1<n&&0==n%1&&9007199254740991>=n;return n&&!!e[d.call(a)]}},{}],36:[function(a,p,k){function e(b,c){b="number"==typeof b||m.test(b)?
+b:-1;return-1<b&&0==b%1&&b<(null==c?9007199254740991:c)}function d(b){return"number"==typeof b&&-1<b&&0==b%1&&9007199254740991>=b}function n(b){var g;g=b;if(null==g)g=[];else{q(g)||(g=Object(g));for(var f=g.length,f=f&&d(f)&&(l(g)||c(g))&&f||0,m=g.constructor,a=-1,m="function"==typeof m&&m.prototype===g,n=Array(f),v=0<f;++a<f;)n[a]=a+"";for(var C in g)v&&e(C,f)||"constructor"==C&&(m||!h.call(g,C))||n.push(C);g=n}a=(f=g.length)&&b.length;C=!!a&&d(a)&&(l(b)||c(b));m=-1;for(n=[];++m<f;)v=g[m],(C&&e(v,
a)||h.call(b,v))&&n.push(v);return n}function q(b){var c=typeof b;return!!b&&("object"==c||"function"==c)}k=a("lodash._getnative");var c=a("lodash.isarguments"),l=a("lodash.isarray"),m=/^\d+$/,h=Object.prototype.hasOwnProperty,b=k(Object,"keys"),f=function(b){return function(c){return null==c?void 0:c[b]}}("length");p.exports=b?function(c){var g=null==c?void 0:c.constructor;return"function"==typeof g&&g.prototype===c||"function"!=typeof c&&null!=c&&d(f(c))?n(c):q(c)?b(c):[]}:n},{"lodash._getnative":31,
"lodash.isarguments":32,"lodash.isarray":33}],37:[function(a,p,k){function e(a){var n;if(n="undefined"!==typeof window&&"undefined"!==typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&
Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&"Worker"in window&&"Uint8ClampedArray"in window){a=a&&a.failIfMajorPerformanceCaveat;if(void 0===d[a]){n=d;var c;c=document.createElement("canvas");var l=Object.create(e.webGLContextAttributes);l.failIfMajorPerformanceCaveat=a;c=c.probablySupportsContext?
c.probablySupportsContext("webgl",l)||c.probablySupportsContext("experimental-webgl",l):c.supportsContext?c.supportsContext("webgl",l)||c.supportsContext("experimental-webgl",l):c.getContext("webgl",l)||c.getContext("experimental-webgl",l);n[a]=c}n=d[a]}return!!n}"undefined"!==typeof p&&p.exports?p.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e);var d={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}},{}],38:[function(a,p,k){k=a("./lib/utils/common").assign;
var e=a("./lib/deflate"),d=a("./lib/inflate");a=a("./lib/zlib/constants");var n={};k(n,e,d,a);p.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(a,p,k){function e(b){if(!(this instanceof e))return new e(b);b=this.options=q.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},b||{});b.raw&&0<b.windowBits?b.windowBits=-b.windowBits:b.gzip&&0<b.windowBits&&16>b.windowBits&&(b.windowBits+=16);this.err=0;
this.msg="";this.ended=!1;this.chunks=[];this.strm=new m;this.strm.avail_out=0;var d=n.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(0!==d)throw Error(l[d]);b.header&&n.deflateSetHeader(this.strm,b.header);if(b.dictionary){b="string"===typeof b.dictionary?c.string2buf(b.dictionary):"[object ArrayBuffer]"===h.call(b.dictionary)?new Uint8Array(b.dictionary):b.dictionary;d=n.deflateSetDictionary(this.strm,b);if(0!==d)throw Error(l[d]);this._dict_set=!0}}function d(b,
c){var g=new e(c);g.push(b,!0);if(g.err)throw g.msg;return g.result}var n=a("./zlib/deflate"),q=a("./utils/common"),c=a("./utils/strings"),l=a("./zlib/messages"),m=a("./zlib/zstream"),h=Object.prototype.toString;e.prototype.push=function(b,d){var g=this.strm,f=this.options.chunkSize,e,l;if(this.ended)return!1;l=d===~~d?d:!0===d?4:0;"string"===typeof b?g.input=c.string2buf(b):"[object ArrayBuffer]"===h.call(b)?g.input=new Uint8Array(b):g.input=b;g.next_in=0;g.avail_in=g.input.length;do{0===g.avail_out&&
(g.output=new q.Buf8(f),g.next_out=0,g.avail_out=f);e=n.deflate(g,l);if(1!==e&&0!==e)return this.onEnd(e),this.ended=!0,!1;if(0===g.avail_out||0===g.avail_in&&(4===l||2===l))if("string"===this.options.to)this.onData(c.buf2binstring(q.shrinkBuf(g.output,g.next_out)));else this.onData(q.shrinkBuf(g.output,g.next_out))}while((0<g.avail_in||0===g.avail_out)&&1!==e);if(4===l)return e=n.deflateEnd(this.strm),this.onEnd(e),this.ended=!0,0===e;2===l&&(this.onEnd(0),g.avail_out=0);return!0};e.prototype.onData=
function(b){this.chunks.push(b)};e.prototype.onEnd=function(b){0===b&&(this.result="string"===this.options.to?this.chunks.join(""):q.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};k.Deflate=e;k.deflate=d;k.deflateRaw=function(b,c){c=c||{};c.raw=!0;return d(b,c)};k.gzip=function(b,c){c=c||{};c.gzip=!0;return d(b,c)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(a,p,k){function e(c){if(!(this instanceof
e))return new e(c);var g=this.options=q.assign({chunkSize:16384,windowBits:0,to:""},c||{});g.raw&&0<=g.windowBits&&16>g.windowBits&&(g.windowBits=-g.windowBits,0===g.windowBits&&(g.windowBits=-15));!(0<=g.windowBits&&16>g.windowBits)||c&&c.windowBits||(g.windowBits+=32);15<g.windowBits&&48>g.windowBits&&0===(g.windowBits&15)&&(g.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new h;this.strm.avail_out=0;c=n.inflateInit2(this.strm,g.windowBits);if(c!==l.Z_OK)throw Error(m[c]);
this.header=new b;n.inflateGetHeader(this.strm,this.header)}function d(b,c){var g=new e(c);g.push(b,!0);if(g.err)throw g.msg;return g.result}var n=a("./zlib/inflate"),q=a("./utils/common"),c=a("./utils/strings"),l=a("./zlib/constants"),m=a("./zlib/messages"),h=a("./zlib/zstream"),b=a("./zlib/gzheader"),f=Object.prototype.toString;e.prototype.push=function(b,d){var g=this.strm,h=this.options.chunkSize,e=this.options.dictionary,m,a,u,w,p,y=!1;if(this.ended)return!1;a=d===~~d?d:!0===d?l.Z_FINISH:l.Z_NO_FLUSH;
"string"===typeof b?g.input=c.binstring2buf(b):"[object ArrayBuffer]"===f.call(b)?g.input=new Uint8Array(b):g.input=b;g.next_in=0;g.avail_in=g.input.length;do{0===g.avail_out&&(g.output=new q.Buf8(h),g.next_out=0,g.avail_out=h);m=n.inflate(g,l.Z_NO_FLUSH);m===l.Z_NEED_DICT&&e&&(m="string"===typeof e?c.string2buf(e):"[object ArrayBuffer]"===f.call(e)?new Uint8Array(e):e,m=n.inflateSetDictionary(this.strm,m));m===l.Z_BUF_ERROR&&!0===y&&(m=l.Z_OK,y=!1);if(m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),
this.ended=!0,!1;if(g.next_out&&(0===g.avail_out||m===l.Z_STREAM_END||0===g.avail_in&&(a===l.Z_FINISH||a===l.Z_SYNC_FLUSH)))if("string"===this.options.to)u=c.utf8border(g.output,g.next_out),w=g.next_out-u,p=c.buf2string(g.output,u),g.next_out=w,g.avail_out=h-w,w&&q.arraySet(g.output,g.output,u,w,0),this.onData(p);else this.onData(q.shrinkBuf(g.output,g.next_out));0===g.avail_in&&0===g.avail_out&&(y=!0)}while((0<g.avail_in||0===g.avail_out)&&m!==l.Z_STREAM_END);m===l.Z_STREAM_END&&(a=l.Z_FINISH);if(a===
l.Z_FINISH)return m=n.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK;a===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),g.avail_out=0);return!0};e.prototype.onData=function(b){this.chunks.push(b)};e.prototype.onEnd=function(b){b===l.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):q.flattenChunks(this.chunks));this.chunks=[];this.err=b;this.msg=this.strm.msg};k.Inflate=e;k.inflate=d;k.inflateRaw=function(b,c){c=c||{};c.raw=!0;return d(b,c)};k.ungzip=d},{"./utils/common":41,"./utils/strings":42,
"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(a,p,k){a="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;k.assign=function(d){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var c=e.shift();if(c){if("object"!==typeof c)throw new TypeError(c+"must be non-object");for(var l in c)c.hasOwnProperty(l)&&(d[l]=c[l])}}return d};k.shrinkBuf=function(d,e){if(d.length===e)return d;
if(d.subarray)return d.subarray(0,e);d.length=e;return d};var e={arraySet:function(d,e,c,l,m){if(e.subarray&&d.subarray)d.set(e.subarray(c,c+l),m);else for(var h=0;h<l;h++)d[m+h]=e[c+h]},flattenChunks:function(d){var e,c,l,m,h;e=l=0;for(c=d.length;e<c;e++)l+=d[e].length;h=new Uint8Array(l);e=l=0;for(c=d.length;e<c;e++)m=d[e],h.set(m,l),l+=m.length;return h}},d={arraySet:function(d,e,c,l,m){for(var h=0;h<l;h++)d[m+h]=e[c+h]},flattenChunks:function(d){return[].concat.apply([],d)}};k.setTyped=function(a){a?
(k.Buf8=Uint8Array,k.Buf16=Uint16Array,k.Buf32=Int32Array,k.assign(k,e)):(k.Buf8=Array,k.Buf16=Array,k.Buf32=Array,k.assign(k,d))};k.setTyped(a)},{}],42:[function(a,p,k){function e(c,e){if(65537>e&&(c.subarray&&q||!c.subarray&&n))return String.fromCharCode.apply(null,d.shrinkBuf(c,e));for(var h="",b=0;b<e;b++)h+=String.fromCharCode(c[b]);return h}var d=a("./common"),n=!0,q=!0;try{String.fromCharCode.apply(null,[0])}catch(l){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){q=!1}var c=
new d.Buf8(256);for(a=0;256>a;a++)c[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;c[254]=c[254]=1;k.string2buf=function(c){var e,h,b,f,g,l=c.length,a=0;for(f=0;f<l;f++)h=c.charCodeAt(f),55296===(h&64512)&&f+1<l&&(b=c.charCodeAt(f+1),56320===(b&64512)&&(h=65536+(h-55296<<10)+(b-56320),f++)),a+=128>h?1:2048>h?2:65536>h?3:4;e=new d.Buf8(a);for(f=g=0;g<a;f++)h=c.charCodeAt(f),55296===(h&64512)&&f+1<l&&(b=c.charCodeAt(f+1),56320===(b&64512)&&(h=65536+(h-55296<<10)+(b-56320),f++)),128>h?e[g++]=h:(2048>
h?e[g++]=192|h>>>6:(65536>h?e[g++]=224|h>>>12:(e[g++]=240|h>>>18,e[g++]=128|h>>>12&63),e[g++]=128|h>>>6&63),e[g++]=128|h&63);return e};k.buf2binstring=function(c){return e(c,c.length)};k.binstring2buf=function(c){for(var e=new d.Buf8(c.length),h=0,b=e.length;h<b;h++)e[h]=c.charCodeAt(h);return e};k.buf2string=function(d,m){var h,b,f,g,l=m||d.length,a=Array(2*l);for(h=b=0;h<l;)if(f=d[h++],128>f)a[b++]=f;else if(g=c[f],4<g)a[b++]=65533,h+=g-1;else{for(f&=2===g?31:3===g?15:7;1<g&&h<l;)f=f<<6|d[h++]&
63,g--;1<g?a[b++]=65533:65536>f?a[b++]=f:(f-=65536,a[b++]=55296|f>>10&1023,a[b++]=56320|f&1023)}return e(a,b)};k.utf8border=function(d,e){var h;e=e||d.length;e>d.length&&(e=d.length);for(h=e-1;0<=h&&128===(d[h]&192);)h--;return 0>h||0===h?e:h+c[d[h]]>e?h:e}},{"./common":41}],43:[function(a,p,k){p.exports=function(e,d,a,q){var c=e&65535|0;e=e>>>16&65535|0;for(var l;0!==a;){l=2E3<a?2E3:a;a-=l;do c=c+d[q++]|0,e=e+c|0;while(--l);c%=65521;e%=65521}return c|e<<16|0}},{}],44:[function(a,p,k){p.exports={Z_NO_FLUSH:0,
Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(a,p,k){var e=function(){for(var d,e=[],a=0;256>a;a++){d=a;for(var c=0;8>c;c++)d=d&1?3988292384^d>>>1:d>>>1;e[a]=d}return e}();
p.exports=function(d,a,q,c){q=c+q;for(d^=-1;c<q;c++)d=d>>>8^e[(d^a[c])&255];return d^-1}},{}],46:[function(a,p,k){function e(b,c){b.msg=x[c];return c}function d(b){for(var c=b.length;0<=--c;)b[c]=0}function n(b){var c=b.state,g=c.pending;g>b.avail_out&&(g=b.avail_out);0!==g&&(C.arraySet(b.output,c.pending_buf,c.pending_out,g,b.next_out),b.next_out+=g,c.pending_out+=g,b.total_out+=g,b.avail_out-=g,c.pending-=g,0===c.pending&&(c.pending_out=0))}function q(b,c){w._tr_flush_block(b,0<=b.block_start?b.block_start:
-1,b.strstart-b.block_start,c);b.block_start=b.strstart;n(b.strm)}function c(b,c){b.pending_buf[b.pending++]=c}function l(b,c){b.pending_buf[b.pending++]=c>>>8&255;b.pending_buf[b.pending++]=c&255}function m(b,c){var g=b.max_chain_length,d=b.strstart,f,e=b.prev_length,h=b.nice_match,l=b.strstart>b.w_size-262?b.strstart-(b.w_size-262):0,a=b.window,m=b.w_mask,n=b.prev,u=b.strstart+258,q=a[d+e-1],r=a[d+e];b.prev_length>=b.good_match&&(g>>=2);h>b.lookahead&&(h=b.lookahead);do if(f=c,a[f+e]===r&&a[f+e-
1]===q&&a[f]===a[d]&&a[++f]===a[d+1]){d+=2;for(f++;a[++d]===a[++f]&&a[++d]===a[++f]&&a[++d]===a[++f]&&a[++d]===a[++f]&&a[++d]===a[++f]&&a[++d]===a[++f]&&a[++d]===a[++f]&&a[++d]===a[++f]&&d<u;);f=258-(u-d);d=u-258;if(f>e){b.match_start=c;e=f;if(f>=h)break;q=a[d+e-1];r=a[d+e]}}while((c=n[c&m])>l&&0!==--g);return e<=b.lookahead?e:b.lookahead}function h(b){var c=b.w_size,g,d,f,e;do{e=b.window_size-b.lookahead-b.strstart;if(b.strstart>=c+(c-262)){C.arraySet(b.window,b.window,c,c,0);b.match_start-=c;b.strstart-=
c;b.block_start-=c;g=d=b.hash_size;do f=b.head[--g],b.head[g]=f>=c?f-c:0;while(--d);g=d=c;do f=b.prev[--g],b.prev[g]=f>=c?f-c:0;while(--d);e+=c}if(0===b.strm.avail_in)break;g=b.strm;d=b.window;f=b.strstart+b.lookahead;var h=g.avail_in;h>e&&(h=e);0===h?d=0:(g.avail_in-=h,C.arraySet(d,g.input,g.next_in,h,f),1===g.state.wrap?g.adler=A(g.adler,d,h,f):2===g.state.wrap&&(g.adler=y(g.adler,d,h,f)),g.next_in+=h,g.total_in+=h,d=h);b.lookahead+=d;if(3<=b.lookahead+b.insert)for(e=b.strstart-b.insert,b.ins_h=
b.window[e],b.ins_h=(b.ins_h<<b.hash_shift^b.window[e+1])&b.hash_mask;b.insert&&!(b.ins_h=(b.ins_h<<b.hash_shift^b.window[e+3-1])&b.hash_mask,b.prev[e&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=e,e++,b.insert--,3>b.lookahead+b.insert););}while(262>b.lookahead&&0!==b.strm.avail_in)}function b(b,c){for(var g;;){if(262>b.lookahead){h(b);if(262>b.lookahead&&0===c)return 1;if(0===b.lookahead)break}g=0;3<=b.lookahead&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+3-1])&b.hash_mask,g=b.prev[b.strstart&
b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart);0!==g&&b.strstart-g<=b.w_size-262&&(b.match_length=m(b,g));if(3<=b.match_length)if(g=w._tr_tally(b,b.strstart-b.match_start,b.match_length-3),b.lookahead-=b.match_length,b.match_length<=b.max_lazy_match&&3<=b.lookahead){b.match_length--;do b.strstart++,b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+3-1])&b.hash_mask,b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart;while(0!==--b.match_length);b.strstart++}else b.strstart+=
b.match_length,b.match_length=0,b.ins_h=b.window[b.strstart],b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+1])&b.hash_mask;else g=w._tr_tally(b,0,b.window[b.strstart]),b.lookahead--,b.strstart++;if(g&&(q(b,!1),0===b.strm.avail_out))return 1}b.insert=2>b.strstart?b.strstart:2;return 4===c?(q(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&(q(b,!1),0===b.strm.avail_out)?1:2}function f(b,c){for(var g,d;;){if(262>b.lookahead){h(b);if(262>b.lookahead&&0===c)return 1;if(0===b.lookahead)break}g=0;3<=b.lookahead&&
(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+3-1])&b.hash_mask,g=b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart);b.prev_length=b.match_length;b.prev_match=b.match_start;b.match_length=2;0!==g&&b.prev_length<b.max_lazy_match&&b.strstart-g<=b.w_size-262&&(b.match_length=m(b,g),5>=b.match_length&&(1===b.strategy||3===b.match_length&&4096<b.strstart-b.match_start)&&(b.match_length=2));if(3<=b.prev_length&&b.match_length<=b.prev_length){d=b.strstart+b.lookahead-3;g=w._tr_tally(b,
b.strstart-1-b.prev_match,b.prev_length-3);b.lookahead-=b.prev_length-1;b.prev_length-=2;do++b.strstart<=d&&(b.ins_h=(b.ins_h<<b.hash_shift^b.window[b.strstart+3-1])&b.hash_mask,b.prev[b.strstart&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=b.strstart);while(0!==--b.prev_length);b.match_available=0;b.match_length=2;b.strstart++;if(g&&(q(b,!1),0===b.strm.avail_out))return 1}else if(b.match_available){if((g=w._tr_tally(b,0,b.window[b.strstart-1]))&&q(b,!1),b.strstart++,b.lookahead--,0===b.strm.avail_out)return 1}else b.match_available=
1,b.strstart++,b.lookahead--}b.match_available&&(w._tr_tally(b,0,b.window[b.strstart-1]),b.match_available=0);b.insert=2>b.strstart?b.strstart:2;return 4===c?(q(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&(q(b,!1),0===b.strm.avail_out)?1:2}function g(b,c){for(var g,d,f,e=b.window;;){if(258>=b.lookahead){h(b);if(258>=b.lookahead&&0===c)return 1;if(0===b.lookahead)break}b.match_length=0;if(3<=b.lookahead&&0<b.strstart&&(d=b.strstart-1,g=e[d],g===e[++d]&&g===e[++d]&&g===e[++d])){for(f=b.strstart+258;g===
e[++d]&&g===e[++d]&&g===e[++d]&&g===e[++d]&&g===e[++d]&&g===e[++d]&&g===e[++d]&&g===e[++d]&&d<f;);b.match_length=258-(f-d);b.match_length>b.lookahead&&(b.match_length=b.lookahead)}3<=b.match_length?(g=w._tr_tally(b,1,b.match_length-3),b.lookahead-=b.match_length,b.strstart+=b.match_length,b.match_length=0):(g=w._tr_tally(b,0,b.window[b.strstart]),b.lookahead--,b.strstart++);if(g&&(q(b,!1),0===b.strm.avail_out))return 1}b.insert=0;return 4===c?(q(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&(q(b,!1),
0===b.strm.avail_out)?1:2}function u(b,c){for(var g;;){if(0===b.lookahead&&(h(b),0===b.lookahead)){if(0===c)return 1;break}b.match_length=0;g=w._tr_tally(b,0,b.window[b.strstart]);b.lookahead--;b.strstart++;if(g&&(q(b,!1),0===b.strm.avail_out))return 1}b.insert=0;return 4===c?(q(b,!0),0===b.strm.avail_out?3:4):b.last_lit&&(q(b,!1),0===b.strm.avail_out)?1:2}function D(b,c,g,d,f){this.good_length=b;this.max_lazy=c;this.nice_length=g;this.max_chain=d;this.func=f}function z(){this.strm=null;this.status=
0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=
this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new C.Buf16(1146);this.dyn_dtree=new C.Buf16(122);this.bl_tree=new C.Buf16(78);d(this.dyn_ltree);d(this.dyn_dtree);d(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new C.Buf16(16);this.heap=new C.Buf16(573);d(this.heap);this.heap_max=this.heap_len=0;this.depth=new C.Buf16(573);d(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=
this.l_buf=0}function t(b){var c;if(!b||!b.state)return e(b,-2);b.total_in=b.total_out=0;b.data_type=2;c=b.state;c.pending=0;c.pending_out=0;0>c.wrap&&(c.wrap=-c.wrap);c.status=c.wrap?42:113;b.adler=2===c.wrap?0:1;c.last_flush=0;w._tr_init(c);return 0}function r(b){var c=t(b);0===c&&(b=b.state,b.window_size=2*b.w_size,d(b.head),b.max_lazy_match=F[b.level].max_lazy,b.good_match=F[b.level].good_length,b.nice_match=F[b.level].nice_length,b.max_chain_length=F[b.level].max_chain,b.strstart=0,b.block_start=
0,b.lookahead=0,b.insert=0,b.match_length=b.prev_length=2,b.match_available=0,b.ins_h=0);return c}function v(b,c,g,d,f,h){if(!b)return-2;var l=1;-1===c&&(c=6);0>d?(l=0,d=-d):15<d&&(l=2,d-=16);if(1>f||9<f||8!==g||8>d||15<d||0>c||9<c||0>h||4<h)return e(b,-2);8===d&&(d=9);var a=new z;b.state=a;a.strm=b;a.wrap=l;a.gzhead=null;a.w_bits=d;a.w_size=1<<a.w_bits;a.w_mask=a.w_size-1;a.hash_bits=f+7;a.hash_size=1<<a.hash_bits;a.hash_mask=a.hash_size-1;a.hash_shift=~~((a.hash_bits+3-1)/3);a.window=new C.Buf8(2*
a.w_size);a.head=new C.Buf16(a.hash_size);a.prev=new C.Buf16(a.w_size);a.lit_bufsize=1<<f+6;a.pending_buf_size=4*a.lit_bufsize;a.pending_buf=new C.Buf8(a.pending_buf_size);a.d_buf=1*a.lit_bufsize;a.l_buf=3*a.lit_bufsize;a.level=c;a.strategy=h;a.method=g;return r(b)}var C=a("../utils/common"),w=a("./trees"),A=a("./adler32"),y=a("./crc32"),x=a("./messages"),F;F=[new D(0,0,0,0,function(b,c){var g=65535;for(g>b.pending_buf_size-5&&(g=b.pending_buf_size-5);;){if(1>=b.lookahead){h(b);if(0===b.lookahead&&
0===c)return 1;if(0===b.lookahead)break}b.strstart+=b.lookahead;b.lookahead=0;var d=b.block_start+g;if(0===b.strstart||b.strstart>=d)if(b.lookahead=b.strstart-d,b.strstart=d,q(b,!1),0===b.strm.avail_out)return 1;if(b.strstart-b.block_start>=b.w_size-262&&(q(b,!1),0===b.strm.avail_out))return 1}b.insert=0;if(4===c)return q(b,!0),0===b.strm.avail_out?3:4;b.strstart>b.block_start&&q(b,!1);return 1}),new D(4,4,8,4,b),new D(4,5,16,8,b),new D(4,6,32,32,b),new D(4,4,16,16,f),new D(8,16,32,32,f),new D(8,
16,128,128,f),new D(8,32,128,256,f),new D(32,128,258,1024,f),new D(32,258,258,4096,f)];k.deflateInit=function(b,c){return v(b,c,8,15,8,0)};k.deflateInit2=v;k.deflateReset=r;k.deflateResetKeep=t;k.deflateSetHeader=function(b,c){if(!b||!b.state||2!==b.state.wrap)return-2;b.state.gzhead=c;return 0};k.deflate=function(b,f){var h,a,m,q;if(!b||!b.state||5<f||0>f)return b?e(b,-2):-2;a=b.state;if(!b.output||!b.input&&0!==b.avail_in||666===a.status&&4!==f)return e(b,0===b.avail_out?-5:-2);a.strm=b;h=a.last_flush;
a.last_flush=f;42===a.status&&(2===a.wrap?(b.adler=0,c(a,31),c(a,139),c(a,8),a.gzhead?(c(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),c(a,a.gzhead.time&255),c(a,a.gzhead.time>>8&255),c(a,a.gzhead.time>>16&255),c(a,a.gzhead.time>>24&255),c(a,9===a.level?2:2<=a.strategy||2>a.level?4:0),c(a,a.gzhead.os&255),a.gzhead.extra&&a.gzhead.extra.length&&(c(a,a.gzhead.extra.length&255),c(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(b.adler=y(b.adler,
a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(c(a,0),c(a,0),c(a,0),c(a,0),c(a,0),c(a,9===a.level?2:2<=a.strategy||2>a.level?4:0),c(a,3),a.status=113)):(m=8+(a.w_bits-8<<4)<<8,m|=(2<=a.strategy||2>a.level?0:6>a.level?1:6===a.level?2:3)<<6,0!==a.strstart&&(m|=32),a.status=113,l(a,m+(31-m%31)),0!==a.strstart&&(l(a,b.adler>>>16),l(a,b.adler&65535)),b.adler=1));if(69===a.status)if(a.gzhead.extra){for(m=a.pending;a.gzindex<(a.gzhead.extra.length&65535)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&
a.pending>m&&(b.adler=y(b.adler,a.pending_buf,a.pending-m,m)),n(b),m=a.pending,a.pending!==a.pending_buf_size));)c(a,a.gzhead.extra[a.gzindex]&255),a.gzindex++;a.gzhead.hcrc&&a.pending>m&&(b.adler=y(b.adler,a.pending_buf,a.pending-m,m));a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){m=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>m&&(b.adler=y(b.adler,a.pending_buf,a.pending-m,m)),n(b),m=a.pending,a.pending===
a.pending_buf_size)){q=1;break}q=a.gzindex<a.gzhead.name.length?a.gzhead.name.charCodeAt(a.gzindex++)&255:0;c(a,q)}while(0!==q);a.gzhead.hcrc&&a.pending>m&&(b.adler=y(b.adler,a.pending_buf,a.pending-m,m));0===q&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){m=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>m&&(b.adler=y(b.adler,a.pending_buf,a.pending-m,m)),n(b),m=a.pending,a.pending===a.pending_buf_size)){q=1;break}q=a.gzindex<a.gzhead.comment.length?
a.gzhead.comment.charCodeAt(a.gzindex++)&255:0;c(a,q)}while(0!==q);a.gzhead.hcrc&&a.pending>m&&(b.adler=y(b.adler,a.pending_buf,a.pending-m,m));0===q&&(a.status=103)}else a.status=103;103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&n(b),a.pending+2<=a.pending_buf_size&&(c(a,b.adler&255),c(a,b.adler>>8&255),b.adler=0,a.status=113)):a.status=113);if(0!==a.pending){if(n(b),0===b.avail_out)return a.last_flush=-1,0}else if(0===b.avail_in&&(f<<1)-(4<f?9:0)<=(h<<1)-(4<h?9:0)&&4!==f)return e(b,
-5);if(666===a.status&&0!==b.avail_in)return e(b,-5);if(0!==b.avail_in||0!==a.lookahead||0!==f&&666!==a.status){h=2===a.strategy?u(a,f):3===a.strategy?g(a,f):F[a.level].func(a,f);if(3===h||4===h)a.status=666;if(1===h||3===h)return 0===b.avail_out&&(a.last_flush=-1),0;if(2===h&&(1===f?w._tr_align(a):5!==f&&(w._tr_stored_block(a,0,0,!1),3===f&&(d(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),n(b),0===b.avail_out))return a.last_flush=-1,0}if(4!==f)return 0;if(0>=a.wrap)return 1;
2===a.wrap?(c(a,b.adler&255),c(a,b.adler>>8&255),c(a,b.adler>>16&255),c(a,b.adler>>24&255),c(a,b.total_in&255),c(a,b.total_in>>8&255),c(a,b.total_in>>16&255),c(a,b.total_in>>24&255)):(l(a,b.adler>>>16),l(a,b.adler&65535));n(b);0<a.wrap&&(a.wrap=-a.wrap);return 0!==a.pending?0:1};k.deflateEnd=function(b){var c;if(!b||!b.state)return-2;c=b.state.status;if(42!==c&&69!==c&&73!==c&&91!==c&&103!==c&&113!==c&&666!==c)return e(b,-2);b.state=null;return 113===c?e(b,-3):0};k.deflateSetDictionary=function(b,
c){var g=c.length,f,a,e,l,m,n;if(!b||!b.state)return-2;f=b.state;e=f.wrap;if(2===e||1===e&&42!==f.status||f.lookahead)return-2;1===e&&(b.adler=A(b.adler,c,g,0));f.wrap=0;g>=f.w_size&&(0===e&&(d(f.head),f.strstart=0,f.block_start=0,f.insert=0),l=new C.Buf8(f.w_size),C.arraySet(l,c,g-f.w_size,f.w_size,0),c=l,g=f.w_size);l=b.avail_in;m=b.next_in;n=b.input;b.avail_in=g;b.next_in=0;b.input=c;for(h(f);3<=f.lookahead;){g=f.strstart;a=f.lookahead-2;do f.ins_h=(f.ins_h<<f.hash_shift^f.window[g+3-1])&f.hash_mask,
f.prev[g&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=g,g++;while(--a);f.strstart=g;f.lookahead=2;h(f)}f.strstart+=f.lookahead;f.block_start=f.strstart;f.insert=f.lookahead;f.lookahead=0;f.match_length=f.prev_length=2;f.match_available=0;b.next_in=m;b.input=n;b.avail_in=l;f.wrap=e;return 0};k.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(a,p,k){p.exports=function(){this.os=this.xflags=this.time=this.text=
0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],48:[function(a,p,k){p.exports=function(a,d){var e,q,c,l,m,h,b,f,g,u,D,z,t,r,v,C,p,k,y,x,F,G,J,B;e=a.state;q=a.next_in;J=a.input;c=q+(a.avail_in-5);l=a.next_out;B=a.output;m=l-(d-a.avail_out);h=l+(a.avail_out-257);b=e.dmax;f=e.wsize;g=e.whave;u=e.wnext;D=e.window;z=e.hold;t=e.bits;r=e.lencode;v=e.distcode;C=(1<<e.lenbits)-1;p=(1<<e.distbits)-1;a:do b:for(15>t&&(z+=J[q++]<<t,t+=8,z+=J[q++]<<t,t+=8),k=r[z&C];;){y=
k>>>24;z>>>=y;t-=y;y=k>>>16&255;if(0===y)B[l++]=k&65535;else if(y&16){x=k&65535;if(y&=15)t<y&&(z+=J[q++]<<t,t+=8),x+=z&(1<<y)-1,z>>>=y,t-=y;15>t&&(z+=J[q++]<<t,t+=8,z+=J[q++]<<t,t+=8);k=v[z&p];c:for(;;){y=k>>>24;z>>>=y;t-=y;y=k>>>16&255;if(y&16){k&=65535;y&=15;t<y&&(z+=J[q++]<<t,t+=8,t<y&&(z+=J[q++]<<t,t+=8));k+=z&(1<<y)-1;if(k>b){a.msg="invalid distance too far back";e.mode=30;break a}z>>>=y;t-=y;y=l-m;if(k>y){y=k-y;if(y>g&&e.sane){a.msg="invalid distance too far back";e.mode=30;break a}F=0;G=D;
if(0===u){if(F+=f-y,y<x){x-=y;do B[l++]=D[F++];while(--y);F=l-k;G=B}}else if(u<y){if(F+=f+u-y,y-=u,y<x){x-=y;do B[l++]=D[F++];while(--y);F=0;if(u<x){y=u;x-=y;do B[l++]=D[F++];while(--y);F=l-k;G=B}}}else if(F+=u-y,y<x){x-=y;do B[l++]=D[F++];while(--y);F=l-k;G=B}for(;2<x;)B[l++]=G[F++],B[l++]=G[F++],B[l++]=G[F++],x-=3;x&&(B[l++]=G[F++],1<x&&(B[l++]=G[F++]))}else{F=l-k;do B[l++]=B[F++],B[l++]=B[F++],B[l++]=B[F++],x-=3;while(2<x);x&&(B[l++]=B[F++],1<x&&(B[l++]=B[F++]))}}else if(0===(y&64)){k=v[(k&65535)+
(z&(1<<y)-1)];continue c}else{a.msg="invalid distance code";e.mode=30;break a}break}}else if(0===(y&64)){k=r[(k&65535)+(z&(1<<y)-1)];continue b}else{y&32?e.mode=12:(a.msg="invalid literal/length code",e.mode=30);break a}break}while(q<c&&l<h);x=t>>3;q-=x;t-=x<<3;a.next_in=q;a.next_out=l;a.avail_in=q<c?5+(c-q):5-(q-c);a.avail_out=l<h?257+(h-l):257-(l-h);e.hold=z&(1<<t)-1;e.bits=t}},{}],49:[function(a,p,k){function e(b){return(b>>>24&255)+(b>>>8&65280)+((b&65280)<<8)+((b&255)<<24)}function d(){this.mode=
0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new h.Buf16(320);this.work=new h.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function n(b){var c;if(!b||!b.state)return-2;
c=b.state;b.total_in=b.total_out=c.total=0;b.msg="";c.wrap&&(b.adler=c.wrap&1);c.mode=1;c.last=0;c.havedict=0;c.dmax=32768;c.head=null;c.hold=0;c.bits=0;c.lencode=c.lendyn=new h.Buf32(852);c.distcode=c.distdyn=new h.Buf32(592);c.sane=1;c.back=-1;return 0}function q(b){var c;if(!b||!b.state)return-2;c=b.state;c.wsize=0;c.whave=0;c.wnext=0;return n(b)}function c(b,c){var g,d;if(!b||!b.state)return-2;d=b.state;0>c?(g=0,c=-c):(g=(c>>4)+1,48>c&&(c&=15));if(c&&(8>c||15<c))return-2;null!==d.window&&d.wbits!==
c&&(d.window=null);d.wrap=g;d.wbits=c;return q(b)}function l(b,g){var f;if(!b)return-2;f=new d;b.state=f;f.window=null;f=c(b,g);0!==f&&(b.state=null);return f}function m(b,c,g,d){var f=b.state;null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new h.Buf8(f.wsize));d>=f.wsize?(h.arraySet(f.window,c,g-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(b=f.wsize-f.wnext,b>d&&(b=d),h.arraySet(f.window,c,g-d,b,f.wnext),(d-=b)?(h.arraySet(f.window,c,g-d,d,0),f.wnext=d,f.whave=f.wsize):(f.wnext+=
b,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=b)));return 0}var h=a("../utils/common"),b=a("./adler32"),f=a("./crc32"),g=a("./inffast"),u=a("./inftrees"),D=!0,z,t;k.inflateReset=q;k.inflateReset2=c;k.inflateResetKeep=n;k.inflateInit=function(b){return l(b,15)};k.inflateInit2=l;k.inflate=function(c,d){var a,l,n,q,r,v,p,k,B,K,I,E,H,L,N,Q,R,O,P=new h.Buf8(4),S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return-2;a=c.state;12===a.mode&&
(a.mode=13);r=c.next_out;n=c.output;p=c.avail_out;q=c.next_in;l=c.input;v=c.avail_in;k=a.hold;B=a.bits;K=v;I=p;O=0;a:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;16>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}if(a.wrap&2&&35615===k){a.check=0;P[0]=k&255;P[1]=k>>>8&255;a.check=f(a.check,P,2,0);B=k=0;a.mode=2;break}a.flags=0;a.head&&(a.head.done=!1);if(!(a.wrap&1)||(((k&255)<<8)+(k>>8))%31){c.msg="incorrect header check";a.mode=30;break}if(8!==(k&15)){c.msg="unknown compression method";
a.mode=30;break}k>>>=4;B-=4;H=(k&15)+8;if(0===a.wbits)a.wbits=H;else if(H>a.wbits){c.msg="invalid window size";a.mode=30;break}a.dmax=1<<H;c.adler=a.check=1;a.mode=k&512?10:12;B=k=0;break;case 2:for(;16>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.flags=k;if(8!==(a.flags&255)){c.msg="unknown compression method";a.mode=30;break}if(a.flags&57344){c.msg="unknown header flags set";a.mode=30;break}a.head&&(a.head.text=k>>8&1);a.flags&512&&(P[0]=k&255,P[1]=k>>>8&255,a.check=f(a.check,P,2,0));B=k=0;a.mode=
3;case 3:for(;32>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.head&&(a.head.time=k);a.flags&512&&(P[0]=k&255,P[1]=k>>>8&255,P[2]=k>>>16&255,P[3]=k>>>24&255,a.check=f(a.check,P,4,0));B=k=0;a.mode=4;case 4:for(;16>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.head&&(a.head.xflags=k&255,a.head.os=k>>8);a.flags&512&&(P[0]=k&255,P[1]=k>>>8&255,a.check=f(a.check,P,2,0));B=k=0;a.mode=5;case 5:if(a.flags&1024){for(;16>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.length=k;a.head&&(a.head.extra_len=k);a.flags&
512&&(P[0]=k&255,P[1]=k>>>8&255,a.check=f(a.check,P,2,0));B=k=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(a.flags&1024&&(E=a.length,E>v&&(E=v),E&&(a.head&&(H=a.head.extra_len-a.length,a.head.extra||(a.head.extra=Array(a.head.extra_len)),h.arraySet(a.head.extra,l,q,E,H)),a.flags&512&&(a.check=f(a.check,l,E,q)),v-=E,q+=E,a.length-=E),a.length))break a;a.length=0;a.mode=7;case 7:if(a.flags&2048){if(0===v)break a;E=0;do H=l[q+E++],a.head&&H&&65536>a.length&&(a.head.name+=String.fromCharCode(H));
while(H&&E<v);a.flags&512&&(a.check=f(a.check,l,E,q));v-=E;q+=E;if(H)break a}else a.head&&(a.head.name=null);a.length=0;a.mode=8;case 8:if(a.flags&4096){if(0===v)break a;E=0;do H=l[q+E++],a.head&&H&&65536>a.length&&(a.head.comment+=String.fromCharCode(H));while(H&&E<v);a.flags&512&&(a.check=f(a.check,l,E,q));v-=E;q+=E;if(H)break a}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(a.flags&512){for(;16>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}if(k!==(a.check&65535)){c.msg="header crc mismatch";
a.mode=30;break}B=k=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0);c.adler=a.check=0;a.mode=12;break;case 10:for(;32>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}c.adler=a.check=e(k);B=k=0;a.mode=11;case 11:if(0===a.havedict)return c.next_out=r,c.avail_out=p,c.next_in=q,c.avail_in=v,a.hold=k,a.bits=B,2;c.adler=a.check=1;a.mode=12;case 12:if(5===d||6===d)break a;case 13:if(a.last){k>>>=B&7;B-=B&7;a.mode=27;break}for(;3>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.last=k&1;k>>>=1;--B;switch(k&3){case 0:a.mode=
14;break;case 1:H=a;if(D){z=new h.Buf32(512);t=new h.Buf32(32);for(E=0;144>E;)H.lens[E++]=8;for(;256>E;)H.lens[E++]=9;for(;280>E;)H.lens[E++]=7;for(;288>E;)H.lens[E++]=8;u(1,H.lens,0,288,z,0,H.work,{bits:9});for(E=0;32>E;)H.lens[E++]=5;u(2,H.lens,0,32,t,0,H.work,{bits:5});D=!1}H.lencode=z;H.lenbits=9;H.distcode=t;H.distbits=5;a.mode=20;if(6===d){k>>>=2;B-=2;break a}break;case 2:a.mode=17;break;case 3:c.msg="invalid block type",a.mode=30}k>>>=2;B-=2;break;case 14:k>>>=B&7;for(B-=B&7;32>B;){if(0===
v)break a;v--;k+=l[q++]<<B;B+=8}if((k&65535)!==(k>>>16^65535)){c.msg="invalid stored block lengths";a.mode=30;break}a.length=k&65535;B=k=0;a.mode=15;if(6===d)break a;case 15:a.mode=16;case 16:if(E=a.length){E>v&&(E=v);E>p&&(E=p);if(0===E)break a;h.arraySet(n,l,q,E,r);v-=E;q+=E;p-=E;r+=E;a.length-=E;break}a.mode=12;break;case 17:for(;14>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.nlen=(k&31)+257;k>>>=5;B-=5;a.ndist=(k&31)+1;k>>>=5;B-=5;a.ncode=(k&15)+4;k>>>=4;B-=4;if(286<a.nlen||30<a.ndist){c.msg=
"too many length or distance symbols";a.mode=30;break}a.have=0;a.mode=18;case 18:for(;a.have<a.ncode;){for(;3>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.lens[S[a.have++]]=k&7;k>>>=3;B-=3}for(;19>a.have;)a.lens[S[a.have++]]=0;a.lencode=a.lendyn;a.lenbits=7;E={bits:a.lenbits};O=u(0,a.lens,0,19,a.lencode,0,a.work,E);a.lenbits=E.bits;if(O){c.msg="invalid code lengths set";a.mode=30;break}a.have=0;a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;;){N=a.lencode[k&(1<<a.lenbits)-1];E=N>>>24;N&=65535;
if(E<=B)break;if(0===v)break a;v--;k+=l[q++]<<B;B+=8}if(16>N)k>>>=E,B-=E,a.lens[a.have++]=N;else{if(16===N){for(H=E+2;B<H;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}k>>>=E;B-=E;if(0===a.have){c.msg="invalid bit length repeat";a.mode=30;break}H=a.lens[a.have-1];E=3+(k&3);k>>>=2;B-=2}else if(17===N){for(H=E+3;B<H;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}k>>>=E;B-=E;H=0;E=3+(k&7);k>>>=3;B-=3}else{for(H=E+7;B<H;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}k>>>=E;B-=E;H=0;E=11+(k&127);k>>>=7;B-=7}if(a.have+
E>a.nlen+a.ndist){c.msg="invalid bit length repeat";a.mode=30;break}for(;E--;)a.lens[a.have++]=H}}if(30===a.mode)break;if(0===a.lens[256]){c.msg="invalid code -- missing end-of-block";a.mode=30;break}a.lenbits=9;E={bits:a.lenbits};O=u(1,a.lens,0,a.nlen,a.lencode,0,a.work,E);a.lenbits=E.bits;if(O){c.msg="invalid literal/lengths set";a.mode=30;break}a.distbits=6;a.distcode=a.distdyn;E={bits:a.distbits};O=u(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,E);a.distbits=E.bits;if(O){c.msg="invalid distances set";
a.mode=30;break}a.mode=20;if(6===d)break a;case 20:a.mode=21;case 21:if(6<=v&&258<=p){c.next_out=r;c.avail_out=p;c.next_in=q;c.avail_in=v;a.hold=k;a.bits=B;g(c,I);r=c.next_out;n=c.output;p=c.avail_out;q=c.next_in;l=c.input;v=c.avail_in;k=a.hold;B=a.bits;12===a.mode&&(a.back=-1);break}for(a.back=0;;){N=a.lencode[k&(1<<a.lenbits)-1];E=N>>>24;H=N>>>16&255;N&=65535;if(E<=B)break;if(0===v)break a;v--;k+=l[q++]<<B;B+=8}if(H&&0===(H&240)){L=E;Q=H;for(R=N;;){N=a.lencode[R+((k&(1<<L+Q)-1)>>L)];E=N>>>24;H=
N>>>16&255;N&=65535;if(L+E<=B)break;if(0===v)break a;v--;k+=l[q++]<<B;B+=8}k>>>=L;B-=L;a.back+=L}k>>>=E;B-=E;a.back+=E;a.length=N;if(0===H){a.mode=26;break}if(H&32){a.back=-1;a.mode=12;break}if(H&64){c.msg="invalid literal/length code";a.mode=30;break}a.extra=H&15;a.mode=22;case 22:if(a.extra){for(H=a.extra;B<H;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.length+=k&(1<<a.extra)-1;k>>>=a.extra;B-=a.extra;a.back+=a.extra}a.was=a.length;a.mode=23;case 23:for(;;){N=a.distcode[k&(1<<a.distbits)-1];E=N>>>
24;H=N>>>16&255;N&=65535;if(E<=B)break;if(0===v)break a;v--;k+=l[q++]<<B;B+=8}if(0===(H&240)){L=E;Q=H;for(R=N;;){N=a.distcode[R+((k&(1<<L+Q)-1)>>L)];E=N>>>24;H=N>>>16&255;N&=65535;if(L+E<=B)break;if(0===v)break a;v--;k+=l[q++]<<B;B+=8}k>>>=L;B-=L;a.back+=L}k>>>=E;B-=E;a.back+=E;if(H&64){c.msg="invalid distance code";a.mode=30;break}a.offset=N;a.extra=H&15;a.mode=24;case 24:if(a.extra){for(H=a.extra;B<H;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}a.offset+=k&(1<<a.extra)-1;k>>>=a.extra;B-=a.extra;a.back+=
a.extra}if(a.offset>a.dmax){c.msg="invalid distance too far back";a.mode=30;break}a.mode=25;case 25:if(0===p)break a;E=I-p;if(a.offset>E){E=a.offset-E;if(E>a.whave&&a.sane){c.msg="invalid distance too far back";a.mode=30;break}E>a.wnext?(E-=a.wnext,H=a.wsize-E):H=a.wnext-E;E>a.length&&(E=a.length);L=a.window}else L=n,H=r-a.offset,E=a.length;E>p&&(E=p);p-=E;a.length-=E;do n[r++]=L[H++];while(--E);0===a.length&&(a.mode=21);break;case 26:if(0===p)break a;n[r++]=a.length;p--;a.mode=21;break;case 27:if(a.wrap){for(;32>
B;){if(0===v)break a;v--;k|=l[q++]<<B;B+=8}I-=p;c.total_out+=I;a.total+=I;I&&(c.adler=a.check=a.flags?f(a.check,n,I,r-I):b(a.check,n,I,r-I));I=p;if((a.flags?k:e(k))!==a.check){c.msg="incorrect data check";a.mode=30;break}B=k=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;32>B;){if(0===v)break a;v--;k+=l[q++]<<B;B+=8}if(k!==(a.total&4294967295)){c.msg="incorrect length check";a.mode=30;break}B=k=0}a.mode=29;case 29:O=1;break a;case 30:O=-3;break a;case 31:return-4;default:return-2}c.next_out=r;c.avail_out=
p;c.next_in=q;c.avail_in=v;a.hold=k;a.bits=B;if((a.wsize||I!==c.avail_out&&30>a.mode&&(27>a.mode||4!==d))&&m(c,c.output,c.next_out,I-c.avail_out))return a.mode=31,-4;K-=c.avail_in;I-=c.avail_out;c.total_in+=K;c.total_out+=I;a.total+=I;a.wrap&&I&&(c.adler=a.check=a.flags?f(a.check,n,I,c.next_out-I):b(a.check,n,I,c.next_out-I));c.data_type=a.bits+(a.last?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0);(0===K&&0===I||4===d)&&0===O&&(O=-5);return O};k.inflateEnd=function(b){if(!b||!b.state)return-2;
var c=b.state;c.window&&(c.window=null);b.state=null;return 0};k.inflateGetHeader=function(b,c){var a;if(!b||!b.state)return-2;a=b.state;if(0===(a.wrap&2))return-2;a.head=c;c.done=!1;return 0};k.inflateSetDictionary=function(c,a){var g=a.length,d,f;if(!c||!c.state)return-2;d=c.state;if(0!==d.wrap&&11!==d.mode)return-2;if(11===d.mode&&(f=b(1,a,g,0),f!==d.check))return-3;if(m(c,a,g,g))return d.mode=31,-4;d.havedict=1;return 0};k.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,
"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(a,p,k){var e=a("../utils/common"),d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],n=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,
28,29,29,64,64];p.exports=function(a,m,h,b,f,g,u,D){var l=D.bits,t,r,v,k,p,A,y,x,F,G,J,B,K,I=0,E,H=new e.Buf16(16);p=new e.Buf16(16);var L,N=0,Q,R,O;for(t=0;15>=t;t++)H[t]=0;for(r=0;r<b;r++)H[m[h+r]]++;k=l;for(v=15;1<=v&&0===H[v];v--);k>v&&(k=v);if(0===v)return f[g++]=20971520,f[g++]=20971520,D.bits=1,0;for(l=1;l<v&&0===H[l];l++);k<l&&(k=l);for(t=A=1;15>=t;t++)if(A<<=1,A-=H[t],0>A)return-1;if(0<A&&(0===a||1!==v))return-1;p[1]=0;for(t=1;15>t;t++)p[t+1]=p[t]+H[t];for(r=0;r<b;r++)0!==m[h+r]&&(u[p[m[h+
r]]++]=r);0===a?(K=L=u,E=19):1===a?(K=d,I-=257,L=n,N-=257,E=256):(K=q,L=c,E=-1);r=x=0;t=l;B=g;b=k;p=0;G=-1;y=1<<k;J=y-1;if(1===a&&852<y||2===a&&592<y)return 1;for(var P=0;;){P++;Q=t-p;u[r]<E?(R=0,O=u[r]):u[r]>E?(R=L[N+u[r]],O=K[I+u[r]]):(R=96,O=0);A=1<<t-p;l=F=1<<b;do F-=A,f[B+(x>>p)+F]=Q<<24|R<<16|O|0;while(0!==F);for(A=1<<t-1;x&A;)A>>=1;0!==A?(x&=A-1,x+=A):x=0;r++;if(0===--H[t]){if(t===v)break;t=m[h+u[r]]}if(t>k&&(x&J)!==G){0===p&&(p=k);B+=l;b=t-p;for(A=1<<b;b+p<v;){A-=H[b+p];if(0>=A)break;b++;
A<<=1}y+=1<<b;if(1===a&&852<y||2===a&&592<y)return 1;G=x&J;f[G]=k<<24|b<<16|B-g|0}}0!==x&&(f[B+x]=t-p<<24|4194304);D.bits=k;return 0}},{"../utils/common":41}],51:[function(a,p,k){p.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(a,p,k){function e(b){for(var c=b.length;0<=--c;)b[c]=0}function d(b,c,a,g,d){this.static_tree=b;this.extra_bits=c;this.extra_base=
a;this.elems=g;this.max_length=d;this.has_stree=b&&b.length}function n(b,c){this.dyn_tree=b;this.max_code=0;this.stat_desc=c}function q(b,c){b.pending_buf[b.pending++]=c&255;b.pending_buf[b.pending++]=c>>>8&255}function c(b,c,a){b.bi_valid>16-a?(b.bi_buf|=c<<b.bi_valid&65535,q(b,b.bi_buf),b.bi_buf=c>>16-b.bi_valid,b.bi_valid+=a-16):(b.bi_buf|=c<<b.bi_valid&65535,b.bi_valid+=a)}function l(b,a,g){c(b,g[2*a],g[2*a+1])}function m(b,c){var a=0;do a|=b&1,b>>>=1,a<<=1;while(0<--c);return a>>>1}function h(b,
c,a){var g=Array(16),d=0,f;for(f=1;15>=f;f++)g[f]=d=d+a[f-1]<<1;for(a=0;a<=c;a++)d=b[2*a+1],0!==d&&(b[2*a]=m(g[d]++,d))}function b(b){var c;for(c=0;286>c;c++)b.dyn_ltree[2*c]=0;for(c=0;30>c;c++)b.dyn_dtree[2*c]=0;for(c=0;19>c;c++)b.bl_tree[2*c]=0;b.dyn_ltree[512]=1;b.opt_len=b.static_len=0;b.last_lit=b.matches=0}function f(b){8<b.bi_valid?q(b,b.bi_buf):0<b.bi_valid&&(b.pending_buf[b.pending++]=b.bi_buf);b.bi_buf=0;b.bi_valid=0}function g(b,c,a,g){var d=2*c,f=2*a;return b[d]<b[f]||b[d]===b[f]&&g[c]<=
g[a]}function u(b,c,a){for(var d=b.heap[a],f=a<<1;f<=b.heap_len;){f<b.heap_len&&g(c,b.heap[f+1],b.heap[f],b.depth)&&f++;if(g(c,d,b.heap[f],b.depth))break;b.heap[a]=b.heap[f];a=f;f<<=1}b.heap[a]=d}function D(b,a,g){var d,f,e=0,h,m;if(0!==b.last_lit){do d=b.pending_buf[b.d_buf+2*e]<<8|b.pending_buf[b.d_buf+2*e+1],f=b.pending_buf[b.l_buf+e],e++,0===d?l(b,f,a):(h=K[f],l(b,h+256+1,a),m=A[h],0!==m&&(f-=I[h],c(b,f,m)),d--,h=256>d?B[d]:B[256+(d>>>7)],l(b,h,g),m=y[h],0!==m&&(d-=E[h],c(b,d,m)));while(e<b.last_lit)
}l(b,256,a)}function z(b,c){var a=c.dyn_tree,g=c.stat_desc.static_tree,d=c.stat_desc.has_stree,f=c.stat_desc.elems,e,l=-1,m;b.heap_len=0;b.heap_max=573;for(e=0;e<f;e++)0!==a[2*e]?(b.heap[++b.heap_len]=l=e,b.depth[e]=0):a[2*e+1]=0;for(;2>b.heap_len;)m=b.heap[++b.heap_len]=2>l?++l:0,a[2*m]=1,b.depth[m]=0,b.opt_len--,d&&(b.static_len-=g[2*m+1]);c.max_code=l;for(e=b.heap_len>>1;1<=e;e--)u(b,a,e);m=f;do e=b.heap[1],b.heap[1]=b.heap[b.heap_len--],u(b,a,1),g=b.heap[1],b.heap[--b.heap_max]=e,b.heap[--b.heap_max]=
g,a[2*m]=a[2*e]+a[2*g],b.depth[m]=(b.depth[e]>=b.depth[g]?b.depth[e]:b.depth[g])+1,a[2*e+1]=a[2*g+1]=m,b.heap[1]=m++,u(b,a,1);while(2<=b.heap_len);b.heap[--b.heap_max]=b.heap[1];e=c.dyn_tree;m=c.max_code;for(var n=c.stat_desc.static_tree,q=c.stat_desc.has_stree,D=c.stat_desc.extra_bits,r=c.stat_desc.extra_base,z=c.stat_desc.max_length,t,v,k=0,f=0;15>=f;f++)b.bl_count[f]=0;e[2*b.heap[b.heap_max]+1]=0;for(g=b.heap_max+1;573>g;g++)d=b.heap[g],f=e[2*e[2*d+1]+1]+1,f>z&&(f=z,k++),e[2*d+1]=f,d>m||(b.bl_count[f]++,
t=0,d>=r&&(t=D[d-r]),v=e[2*d],b.opt_len+=v*(f+t),q&&(b.static_len+=v*(n[2*d+1]+t)));if(0!==k){do{for(f=z-1;0===b.bl_count[f];)f--;b.bl_count[f]--;b.bl_count[f+1]+=2;b.bl_count[z]--;k-=2}while(0<k);for(f=z;0!==f;f--)for(d=b.bl_count[f];0!==d;)n=b.heap[--g],n>m||(e[2*n+1]!==f&&(b.opt_len+=(f-e[2*n+1])*e[2*n],e[2*n+1]=f),d--)}h(a,l,b.bl_count)}function t(b,c,a){var g,d=-1,f,e=c[1],h=0,l=7,m=4;0===e&&(l=138,m=3);c[2*(a+1)+1]=65535;for(g=0;g<=a;g++)f=e,e=c[2*(g+1)+1],++h<l&&f===e||(h<m?b.bl_tree[2*f]+=
h:0!==f?(f!==d&&b.bl_tree[2*f]++,b.bl_tree[32]++):10>=h?b.bl_tree[34]++:b.bl_tree[36]++,h=0,d=f,0===e?(l=138,m=3):f===e?(l=6,m=3):(l=7,m=4))}function r(b,a,g){var d,f=-1,e,h=a[1],m=0,n=7,u=4;0===h&&(n=138,u=3);for(d=0;d<=g;d++)if(e=h,h=a[2*(d+1)+1],!(++m<n&&e===h)){if(m<u){do l(b,e,b.bl_tree);while(0!==--m)}else 0!==e?(e!==f&&(l(b,e,b.bl_tree),m--),l(b,16,b.bl_tree),c(b,m-3,2)):10>=m?(l(b,17,b.bl_tree),c(b,m-3,3)):(l(b,18,b.bl_tree),c(b,m-11,7));m=0;f=e;0===h?(n=138,u=3):e===h?(n=6,u=3):(n=7,u=4)}}
function v(b){var c=4093624447,a;for(a=0;31>=a;a++,c>>>=1)if(c&1&&0!==b.dyn_ltree[2*a])return 0;if(0!==b.dyn_ltree[18]||0!==b.dyn_ltree[20]||0!==b.dyn_ltree[26])return 1;for(a=32;256>a;a++)if(0!==b.dyn_ltree[2*a])return 1;return 0}function C(b,a,g,d){c(b,0+(d?1:0),3);f(b);q(b,g);q(b,~g);w.arraySet(b.pending_buf,b.window,a,g,b.pending);b.pending+=g}var w=a("../utils/common"),A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,
12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=Array(576);e(G);var J=Array(60);e(J);var B=Array(512);e(B);var K=Array(256);e(K);var I=Array(29);e(I);var E=Array(30);e(E);var H,L,N,Q=!1;k._tr_init=function(c){if(!Q){var a,g,f,e=Array(16);for(f=g=0;28>f;f++)for(I[f]=g,a=0;a<1<<A[f];a++)K[g++]=f;K[g-1]=f;for(f=g=0;16>f;f++)for(E[f]=g,a=0;a<1<<y[f];a++)B[g++]=f;for(g>>=7;30>f;f++)for(E[f]=g<<7,a=0;a<1<<y[f]-7;a++)B[256+g++]=f;for(a=0;15>=a;a++)e[a]=
0;for(a=0;143>=a;)G[2*a+1]=8,a++,e[8]++;for(;255>=a;)G[2*a+1]=9,a++,e[9]++;for(;279>=a;)G[2*a+1]=7,a++,e[7]++;for(;287>=a;)G[2*a+1]=8,a++,e[8]++;h(G,287,e);for(a=0;30>a;a++)J[2*a+1]=5,J[2*a]=m(a,5);H=new d(G,A,257,286,15);L=new d(J,y,0,30,15);N=new d([],x,0,19,7);Q=!0}c.l_desc=new n(c.dyn_ltree,H);c.d_desc=new n(c.dyn_dtree,L);c.bl_desc=new n(c.bl_tree,N);c.bi_buf=0;c.bi_valid=0;b(c)};k._tr_stored_block=C;k._tr_flush_block=function(a,g,d,e){var h,l,m=0;if(0<a.level){2===a.strm.data_type&&(a.strm.data_type=
v(a));z(a,a.l_desc);z(a,a.d_desc);t(a,a.dyn_ltree,a.l_desc.max_code);t(a,a.dyn_dtree,a.d_desc.max_code);z(a,a.bl_desc);for(m=18;3<=m&&0===a.bl_tree[2*F[m]+1];m--);a.opt_len+=3*(m+1)+14;h=a.opt_len+3+7>>>3;l=a.static_len+3+7>>>3;l<=h&&(h=l)}else h=l=d+5;if(d+4<=h&&-1!==g)C(a,g,d,e);else if(4===a.strategy||l===h)c(a,2+(e?1:0),3),D(a,G,J);else{c(a,4+(e?1:0),3);g=a.l_desc.max_code+1;d=a.d_desc.max_code+1;m+=1;c(a,g-257,5);c(a,d-1,5);c(a,m-4,4);for(h=0;h<m;h++)c(a,a.bl_tree[2*F[h]+1],3);r(a,a.dyn_ltree,
g-1);r(a,a.dyn_dtree,d-1);D(a,a.dyn_ltree,a.dyn_dtree)}b(a);e&&f(a)};k._tr_tally=function(b,c,a){b.pending_buf[b.d_buf+2*b.last_lit]=c>>>8&255;b.pending_buf[b.d_buf+2*b.last_lit+1]=c&255;b.pending_buf[b.l_buf+b.last_lit]=a&255;b.last_lit++;0===c?b.dyn_ltree[2*a]++:(b.matches++,c--,b.dyn_ltree[2*(K[a]+256+1)]++,b.dyn_dtree[2*(256>c?B[c]:B[256+(c>>>7)])]++);return b.last_lit===b.lit_bufsize-1};k._tr_align=function(b){c(b,2,3);l(b,256,G);16===b.bi_valid?(q(b,b.bi_buf),b.bi_buf=0,b.bi_valid=0):8<=b.bi_valid&&
(b.pending_buf[b.pending++]=b.bi_buf&255,b.bi_buf>>=8,b.bi_valid-=8)}},{"../utils/common":41}],53:[function(a,p,k){p.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],54:[function(a,p,k){function e(c){var a;c&&c.length&&(a=c,c=a.length);c=new Uint8Array(c||0);a&&c.set(a);c.readUInt32LE=q.readUInt32LE;c.writeUInt32LE=q.writeUInt32LE;c.readInt32LE=
q.readInt32LE;c.writeInt32LE=q.writeInt32LE;c.readFloatLE=q.readFloatLE;c.writeFloatLE=q.writeFloatLE;c.readDoubleLE=q.readDoubleLE;c.writeDoubleLE=q.writeDoubleLE;c.toString=q.toString;c.write=q.write;c.slice=q.slice;c.copy=q.copy;c._isBuffer=!0;return c}function d(c){for(var a=c.length,b=[],d=0,g,e;d<a;d++){g=c.charCodeAt(d);if(55295<g&&57344>g)if(e)if(56320>g){b.push(239,191,189);e=g;continue}else g=e-55296<<10|g-56320|65536,e=null;else{56319<g||d+1===a?b.push(239,191,189):e=g;continue}else e&&
(b.push(239,191,189),e=null);128>g?b.push(g):2048>g?b.push(g>>6|192,g&63|128):65536>g?b.push(g>>12|224,g>>6&63|128,g&63|128):b.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}return b}p.exports=e;var n=a("ieee754"),q,c,l;q={readUInt32LE:function(c){return(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]},writeUInt32LE:function(c,a){this[a]=c;this[a+1]=c>>>8;this[a+2]=c>>>16;this[a+3]=c>>>24},readInt32LE:function(c){return(this[c]|this[c+1]<<8|this[c+2]<<16)+(this[c+3]<<24)},readFloatLE:function(c){return n.read(this,
c,!0,23,4)},readDoubleLE:function(c){return n.read(this,c,!0,52,8)},writeFloatLE:function(c,a){return n.write(this,c,a,!0,23,4)},writeDoubleLE:function(c,a){return n.write(this,c,a,!0,52,8)},toString:function(c,a,b){var d=c="";b=Math.min(this.length,b||this.length);for(a=a||0;a<b;a++){var g=this[a];127>=g?(c+=decodeURIComponent(d)+String.fromCharCode(g),d=""):d+="%"+g.toString(16)}return c+=decodeURIComponent(d)},write:function(a,e){for(var b=a===c?l:d(a),f=0;f<b.length;f++)this[e+f]=b[f]},slice:function(c,
a){return this.subarray(c,a)},copy:function(c,a){a=a||0;for(var b=0;b<this.length;b++)c[a+b]=this[b]}};q.writeInt32LE=q.writeUInt32LE;e.byteLength=function(a){c=a;l=d(a);return l.length};e.isBuffer=function(c){return!(!c||!c._isBuffer)}},{ieee754:24}],55:[function(a,p,k){(function(e){function d(b){this.buf=D.isBuffer(b)?b:new D(b||0);this.pos=0;this.length=this.buf.length}function n(b,c){var a=c.buf,g;g=a[c.pos++];b+=268435456*(g&127);if(128>g)return b;g=a[c.pos++];b+=34359738368*(g&127);if(128>g)return b;
g=a[c.pos++];b+=4398046511104*(g&127);if(128>g)return b;g=a[c.pos++];b+=562949953421312*(g&127);if(128>g)return b;g=a[c.pos++];b+=72057594037927936*(g&127);if(128>g)return b;g=a[c.pos++];if(128>g)return b+0x7fffffffffffffff*(g&127);throw Error("Expected varint not more than 10 bytes");}function q(b,c){for(var a=0;a<b.length;a++)c.writeVarint(b[a])}function c(b,c){for(var a=0;a<b.length;a++)c.writeSVarint(b[a])}function l(b,c){for(var a=0;a<b.length;a++)c.writeFloat(b[a])}function m(b,c){for(var a=
0;a<b.length;a++)c.writeDouble(b[a])}function h(b,c){for(var a=0;a<b.length;a++)c.writeBoolean(b[a])}function b(b,c){for(var a=0;a<b.length;a++)c.writeFixed32(b[a])}function f(b,c){for(var a=0;a<b.length;a++)c.writeSFixed32(b[a])}function g(b,c){for(var a=0;a<b.length;a++)c.writeFixed64(b[a])}function u(b,c){for(var a=0;a<b.length;a++)c.writeSFixed64(b[a])}p.exports=d;var D=e.Buffer||a("./buffer");d.Varint=0;d.Fixed64=1;d.Bytes=2;d.Fixed32=5;var z=1/4294967296,t=Math.pow(2,63);d.prototype={destroy:function(){this.buf=
null},readFields:function(b,c,a){for(a=a||this.length;this.pos<a;){var g=this.readVarint(),d=this.pos;b(g>>3,c,this);this.pos===d&&this.skip(g)}return c},readMessage:function(b,c){return this.readFields(b,c,this.readVarint()+this.pos)},readFixed32:function(){var b=this.buf.readUInt32LE(this.pos);this.pos+=4;return b},readSFixed32:function(){var b=this.buf.readInt32LE(this.pos);this.pos+=4;return b},readFixed64:function(){var b=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readUInt32LE(this.pos+
4);this.pos+=8;return b},readSFixed64:function(){var b=this.buf.readUInt32LE(this.pos)+4294967296*this.buf.readInt32LE(this.pos+4);this.pos+=8;return b},readFloat:function(){var b=this.buf.readFloatLE(this.pos);this.pos+=4;return b},readDouble:function(){var b=this.buf.readDoubleLE(this.pos);this.pos+=8;return b},readVarint:function(){var b=this.buf,c,a;a=b[this.pos++];c=a&127;if(128>a)return c;a=b[this.pos++];c|=(a&127)<<7;if(128>a)return c;a=b[this.pos++];c|=(a&127)<<14;if(128>a)return c;a=b[this.pos++];
c|=(a&127)<<21;return 128>a?c:n(c,this)},readVarint64:function(){var b=this.pos,c=this.readVarint();if(c<t)return c;for(var a=this.pos-2;255===this.buf[a];)a--;a<b&&(a=b);for(var g=c=0;g<a-b+1;g++)var d=~this.buf[b+g]&127,c=c+(4>g?d<<7*g:d*Math.pow(2,7*g));return-c-1},readSVarint:function(){var b=this.readVarint();return 1===b%2?(b+1)/-2:b/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var b=this.readVarint()+this.pos,c=this.buf.toString("utf8",this.pos,b);this.pos=b;return c},
readBytes:function(){var b=this.readVarint()+this.pos,c=this.buf.slice(this.pos,b);this.pos=b;return c},readPackedVarint:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readVarint());return c},readPackedSVarint:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readSVarint());return c},readPackedBoolean:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readBoolean());return c},readPackedFloat:function(){for(var b=this.readVarint()+
this.pos,c=[];this.pos<b;)c.push(this.readFloat());return c},readPackedDouble:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readDouble());return c},readPackedFixed32:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readFixed32());return c},readPackedSFixed32:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readSFixed32());return c},readPackedFixed64:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<
b;)c.push(this.readFixed64());return c},readPackedSFixed64:function(){for(var b=this.readVarint()+this.pos,c=[];this.pos<b;)c.push(this.readSFixed64());return c},skip:function(b){b&=7;if(b===d.Varint)for(;127<this.buf[this.pos++];);else if(b===d.Bytes)this.pos=this.readVarint()+this.pos;else if(b===d.Fixed32)this.pos+=4;else if(b===d.Fixed64)this.pos+=8;else throw Error("Unimplemented type: "+b);},writeTag:function(b,c){this.writeVarint(b<<3|c)},realloc:function(b){for(var c=this.length||16;c<this.pos+
b;)c*=2;c!==this.length&&(b=new D(c),this.buf.copy(b),this.buf=b,this.length=c)},finish:function(){this.length=this.pos;this.pos=0;return this.buf.slice(0,this.length)},writeFixed32:function(b){this.realloc(4);this.buf.writeUInt32LE(b,this.pos);this.pos+=4},writeSFixed32:function(b){this.realloc(4);this.buf.writeInt32LE(b,this.pos);this.pos+=4},writeFixed64:function(b){this.realloc(8);this.buf.writeInt32LE(b&-1,this.pos);this.buf.writeUInt32LE(Math.floor(b*z),this.pos+4);this.pos+=8},writeSFixed64:function(b){this.realloc(8);
this.buf.writeInt32LE(b&-1,this.pos);this.buf.writeInt32LE(Math.floor(b*z),this.pos+4);this.pos+=8},writeVarint:function(b){b=+b;if(268435455<b){this.realloc(10);for(var c=this.pos+10;1<=b;){if(this.pos>=c)throw Error("Given varint doesn't fit into 10 bytes");var a=b&255;this.buf[this.pos++]=a|(128<=b?128:0);b/=128}}else this.realloc(4),this.buf[this.pos++]=b&127|(127<b?128:0),127>=b||(this.buf[this.pos++]=(b>>>=7)&127|(127<b?128:0),127>=b||(this.buf[this.pos++]=(b>>>=7)&127|(127<b?128:0),127>=b||
(this.buf[this.pos++]=b>>>7&127)))},writeSVarint:function(b){this.writeVarint(0>b?2*-b-1:2*b)},writeBoolean:function(b){this.writeVarint(!!b)},writeString:function(b){b=String(b);var c=D.byteLength(b);this.writeVarint(c);this.realloc(c);this.buf.write(b,this.pos);this.pos+=c},writeFloat:function(b){this.realloc(4);this.buf.writeFloatLE(b,this.pos);this.pos+=4},writeDouble:function(b){this.realloc(8);this.buf.writeDoubleLE(b,this.pos);this.pos+=8},writeBytes:function(b){var c=b.length;this.writeVarint(c);
this.realloc(c);for(var a=0;a<c;a++)this.buf[this.pos++]=b[a]},writeRawMessage:function(b,c){this.pos++;var a=this.pos;b(c,this);var g=this.pos-a;if(128<=g){var d=16383>=g?1:2097151>=g?2:268435455>=g?3:Math.ceil(Math.log(g)/(7*Math.LN2));this.realloc(d);for(var f=this.pos-1;f>=a;f--)this.buf[f+d]=this.buf[f]}this.pos=a-1;this.writeVarint(g);this.pos+=g},writeMessage:function(b,c,a){this.writeTag(b,d.Bytes);this.writeRawMessage(c,a)},writePackedVarint:function(b,c){this.writeMessage(b,q,c)},writePackedSVarint:function(b,
a){this.writeMessage(b,c,a)},writePackedBoolean:function(b,c){this.writeMessage(b,h,c)},writePackedFloat:function(b,c){this.writeMessage(b,l,c)},writePackedDouble:function(b,c){this.writeMessage(b,m,c)},writePackedFixed32:function(c,a){this.writeMessage(c,b,a)},writePackedSFixed32:function(b,c){this.writeMessage(b,f,c)},writePackedFixed64:function(b,c){this.writeMessage(b,g,c)},writePackedSFixed64:function(b,c){this.writeMessage(b,u,c)},writeBytesField:function(b,c){this.writeTag(b,d.Bytes);this.writeBytes(c)},
writeFixed32Field:function(b,c){this.writeTag(b,d.Fixed32);this.writeFixed32(c)},writeSFixed32Field:function(b,c){this.writeTag(b,d.Fixed32);this.writeSFixed32(c)},writeFixed64Field:function(b,c){this.writeTag(b,d.Fixed64);this.writeFixed64(c)},writeSFixed64Field:function(b,c){this.writeTag(b,d.Fixed64);this.writeSFixed64(c)},writeVarintField:function(b,c){this.writeTag(b,d.Varint);this.writeVarint(c)},writeSVarintField:function(b,c){this.writeTag(b,d.Varint);this.writeSVarint(c)},writeStringField:function(b,
c){this.writeTag(b,d.Bytes);this.writeString(c)},writeFloatField:function(b,c){this.writeTag(b,d.Fixed32);this.writeFloat(c)},writeDoubleField:function(b,c){this.writeTag(b,d.Fixed64);this.writeDouble(c)},writeBooleanField:function(b,c){this.writeVarintField(b,!!c)}}}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./buffer":54}],56:[function(a,p,k){function e(a,e){this.x=a;this.y=e}p.exports=e;e.prototype={clone:function(){return new e(this.x,
this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===
a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var d=a.x-this.x;a=a.y-this.y;return d*d+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,e){return Math.atan2(this.x*e-this.y*a,this.x*a+this.y*e)},_matMult:function(a){var d=a[2]*this.x+a[3]*this.y;this.x=a[0]*this.x+a[1]*this.y;this.y=d;return this},_add:function(a){this.x+=
a.x;this.y+=a.y;return this},_sub:function(a){this.x-=a.x;this.y-=a.y;return this},_mult:function(a){this.x*=a;this.y*=a;return this},_div:function(a){this.x/=a;this.y/=a;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var a=this.y;this.y=this.x;this.x=-a;return this},_rotate:function(a){var d=Math.cos(a);a=Math.sin(a);var e=a*this.x+d*this.y;this.x=d*this.x-a*this.y;this.y=e;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};
e.convert=function(a){return a instanceof e?a:Array.isArray(a)?new e(a[0],a[1]):a}},{}],57:[function(a,p,k){function e(){throw Error("setTimeout has not been defined");}function d(){throw Error("clearTimeout has not been defined");}function n(c){if(b===setTimeout)return setTimeout(c,0);if((b===e||!b)&&setTimeout)return b=setTimeout,setTimeout(c,0);try{return b(c,0)}catch(r){try{return b.call(null,c,0)}catch(v){return b.call(this,c,0)}}}function q(b){if(f===clearTimeout)return clearTimeout(b);if((f===
d||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(b);try{return f(b)}catch(r){try{return f.call(null,b)}catch(v){return f.call(this,b)}}}function c(){u&&D&&(u=!1,D.length?g=D.concat(g):z=-1,g.length&&l())}function l(){if(!u){var b=n(c);u=!0;for(var a=g.length;a;){D=g;for(g=[];++z<a;)D&&D[z].run();z=-1;a=g.length}D=null;u=!1;q(b)}}function m(b,c){this.fun=b;this.array=c}function h(){}a=p.exports={};var b,f;try{b="function"===typeof setTimeout?setTimeout:e}catch(t){b=e}try{f="function"===typeof clearTimeout?
clearTimeout:d}catch(t){f=d}var g=[],u=!1,D,z=-1;a.nextTick=function(b){var c=Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)c[a-1]=arguments[a];g.push(new m(b,c));1!==g.length||u||n(l)};m.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=h;a.addListener=h;a.once=h;a.off=h;a.removeListener=h;a.removeAllListeners=h;a.emit=h;a.prependListener=h;a.prependOnceListener=h;a.listeners=
function(b){return[]};a.binding=function(b){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(b){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},{}],58:[function(a,p,k){function e(a,c,l,m,h){l=l||0;m=m||a.length-1;for(h=h||n;m>l;){if(600<m-l){var b=m-l+1,f=c-l+1,g=Math.log(b),u=.5*Math.exp(2*g/3),g=.5*Math.sqrt(g*u*(b-u)/b)*(0>f-b/2?-1:1);e(a,c,Math.max(l,Math.floor(c-f*u/b+g)),Math.min(m,Math.floor(c+(b-f)*u/b+g)),h)}b=a[c];
f=l;u=m;d(a,l,c);for(0<h(a[m],b)&&d(a,l,m);f<u;){d(a,f,u);f++;for(u--;0>h(a[f],b);)f++;for(;0<h(a[u],b);)u--}0===h(a[l],b)?d(a,l,u):(u++,d(a,u,m));u<=c&&(l=u+1);c<=u&&(m=u-1)}}function d(a,c,d){var e=a[c];a[c]=a[d];a[d]=e}function n(a,c){return a<c?-1:a>c?1:0}p.exports=e},{}],59:[function(a,p,k){function e(b){this.options=l(Object.create(this.options),b);this.trees=Array(this.options.maxZoom+1)}function d(b,a){var g=b.geometry.coordinates;return{x:g[0]/360+.5,y:c(g[1]),zoom:Infinity,id:a,parentId:-1}}
function n(b){return{type:"Feature",properties:q(b),geometry:{type:"Point",coordinates:[360*(b.x-.5),360*Math.atan(Math.exp((180-360*b.y)*Math.PI/180))/Math.PI-90]}}}function q(b){var c=b.numPoints,a=1E4<=c?Math.round(c/1E3)+"k":1E3<=c?Math.round(c/100)/10+"k":c;return l(l({},b.properties),{cluster:!0,cluster_id:b.id,point_count:c,point_count_abbreviated:a})}function c(b){b=Math.sin(b*Math.PI/180);b=.5-.25*Math.log((1+b)/(1-b))/Math.PI;return 0>b?0:1<b?1:b}function l(b,c){for(var a in c)b[a]=c[a];
return b}function m(b){return b.x}function h(b){return b.y}var b=a("kdbush");p.exports=function(b){return new e(b)};e.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(b){return b}},load:function(c){var a=this.options.log;a&&console.time("total time");var f="prepare "+c.length+" points";a&&console.time(f);this.points=c;c=c.map(d);a&&console.timeEnd(f);for(f=this.options.maxZoom;f>=this.options.minZoom;f--){var e=
+Date.now();this.trees[f+1]=b(c,m,h,this.options.nodeSize,Float32Array);c=this._cluster(c,f);a&&console.log("z%d: %d clusters in %dms",f,c.length,+Date.now()-e)}this.trees[this.options.minZoom]=b(c,m,h,this.options.nodeSize,Float32Array);a&&console.timeEnd("total time");return this},getClusters:function(b,a){for(var g=this.trees[this._limitZoom(a)],d=g.range(b[0]/360+.5,c(b[3]),b[2]/360+.5,c(b[1])),f=[],e=0;e<d.length;e++){var h=g.points[d[e]];f.push(h.numPoints?n(h):this.points[h.id])}return f},
getChildren:function(b,c){for(var a=this.trees[c+1].points[b],a=this.trees[c+1].within(a.x,a.y,this.options.radius/(this.options.extent*Math.pow(2,c))),g=[],d=0;d<a.length;d++){var f=this.trees[c+1].points[a[d]];f.parentId===b&&g.push(f.numPoints?n(f):this.points[f.id])}return g},getLeaves:function(b,c,a,d){var g=[];this._appendLeaves(g,b,c,a||10,d||0,0);return g},getTile:function(b,c,a){var g=this.trees[this._limitZoom(b)];b=Math.pow(2,b);var d=this.options.radius/this.options.extent,f=(a-d)/b,e=
(a+1+d)/b,h={features:[]};this._addTileFeatures(g.range((c-d)/b,f,(c+1+d)/b,e),g.points,c,a,b,h);0===c&&this._addTileFeatures(g.range(1-d/b,f,1,e),g.points,b,a,b,h);c===b-1&&this._addTileFeatures(g.range(0,f,d/b,e),g.points,-1,a,b,h);return h.features.length?h:null},getClusterExpansionZoom:function(b,c){for(;c<this.options.maxZoom;){var a=this.getChildren(b,c);c++;if(1!==a.length)break;b=a[0].properties.cluster_id}return c},_appendLeaves:function(b,c,a,d,e,h){c=this.getChildren(c,a);for(var g=0;g<
c.length;g++){var f=c[g].properties;f.cluster?h=h+f.point_count<=e?h+f.point_count:this._appendLeaves(b,f.cluster_id,a+1,d,e,h):h<e?h++:b.push(c[g]);if(b.length===d)break}return h},_addTileFeatures:function(b,c,a,d,e,h){for(var g=0;g<b.length;g++){var f=c[b[g]];h.features.push({type:1,geometry:[[Math.round(this.options.extent*(f.x*e-a)),Math.round(this.options.extent*(f.y*e-d))]],tags:f.numPoints?q(f):this.points[f.id].properties})}},_limitZoom:function(b){return Math.max(this.options.minZoom,Math.min(b,
this.options.maxZoom+1))},_cluster:function(b,c){for(var a=[],g=this.options.radius/(this.options.extent*Math.pow(2,c)),d=0;d<b.length;d++){var f=b[d];if(!(f.zoom<=c)){f.zoom=c;var e=this.trees[c+1],h=e.within(f.x,f.y,g),l=f.numPoints||1,m=f.x*l,n=f.y*l,q=null;this.options.reduce&&(q=this.options.initial(),this._accumulate(q,f));for(var k=0;k<h.length;k++){var p=e.points[h[k]];if(c<p.zoom){var G=p.numPoints||1;p.zoom=c;m+=p.x*G;n+=p.y*G;l+=G;p.parentId=d;this.options.reduce&&this._accumulate(q,p)}}1===
l?a.push(f):(f.parentId=d,a.push({x:m/l,y:n/l,zoom:Infinity,id:d,properties:q,parentId:-1,numPoints:l}))}}return a},_accumulate:function(b,c){var a=c.numPoints?c.properties:this.options.map(this.points[c.id].properties);this.options.reduce(b,a)}}},{kdbush:25}],60:[function(a,p,k){function e(a,q){if(!(this instanceof e))return new e(a,q);this.data=a||[];this.length=this.data.length;this.compare=q||d;if(0<this.length)for(var c=this.length>>1;0<=c;c--)this._down(c)}function d(a,d){return a<d?-1:a>d?
1:0}p.exports=e;e.prototype={push:function(a){this.data.push(a);this.length++;this._up(this.length-1)},pop:function(){if(0!==this.length){var a=this.data[0];this.length--;0<this.length&&(this.data[0]=this.data[this.length],this._down(0));this.data.pop();return a}},peek:function(){return this.data[0]},_up:function(a){for(var d=this.data,c=this.compare,e=d[a];0<a;){var m=a-1>>1,h=d[m];if(0<=c(e,h))break;d[a]=h;a=m}d[a]=e},_down:function(a){for(var d=this.data,c=this.compare,e=this.length,m=e>>1,h=d[a];a<
m;){var b=(a<<1)+1,f=b+1,g=d[b];f<e&&0>c(d[f],g)&&(b=f,g=d[f]);if(0<=c(g,h))break;d[a]=g;a=b}d[a]=h}}},{}],61:[function(a,p,k){p.exports="function"===typeof Object.create?function(a,d){a.super_=d;a.prototype=Object.create(d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,d){a.super_=d;var e=function(){};e.prototype=d.prototype;a.prototype=new e;a.prototype.constructor=a}},{}],62:[function(a,p,k){p.exports=function(a){return a&&"object"===typeof a&&"function"===
typeof a.copy&&"function"===typeof a.fill&&"function"===typeof a.readUInt8}},{}],63:[function(a,p,k){(function(e,d){function n(b,a){var g={seen:[],stylize:c};3<=arguments.length&&(g.depth=arguments[2]);4<=arguments.length&&(g.colors=arguments[3]);z(a)?g.showHidden=a:a&&k._extend(g,a);v(g.showHidden)&&(g.showHidden=!1);v(g.depth)&&(g.depth=2);v(g.colors)&&(g.colors=!1);v(g.customInspect)&&(g.customInspect=!0);g.colors&&(g.stylize=q);return m(g,b,g.depth)}function q(b,c){var a=n.styles[c];return a?
"\u001b["+n.colors[a][0]+"m"+b+"\u001b["+n.colors[a][1]+"m":b}function c(b,c){return b}function l(b){var c={};b.forEach(function(b,a){c[b]=!0});return c}function m(c,a,d){if(c.customInspect&&a&&x(a.inspect)&&a.inspect!==k.inspect&&(!a.constructor||a.constructor.prototype!==a)){var e=a.inspect(d,c);r(e)||(e=m(c,e,d));return e}if(e=h(c,a))return e;var n=Object.keys(a),q=l(n);c.showHidden&&(n=Object.getOwnPropertyNames(a));if(y(a)&&(0<=n.indexOf("message")||0<=n.indexOf("description")))return b(a);if(0===
n.length){if(x(a))return c.stylize("[Function"+(a.name?": "+a.name:"")+"]","special");if(p(a))return c.stylize(RegExp.prototype.toString.call(a),"regexp");if(A(a))return c.stylize(Date.prototype.toString.call(a),"date");if(y(a))return b(a)}var e="",z=!1,t=["{","}"];D(a)&&(z=!0,t=["[","]"]);x(a)&&(e=" [Function"+(a.name?": "+a.name:"")+"]");p(a)&&(e=" "+RegExp.prototype.toString.call(a));A(a)&&(e=" "+Date.prototype.toUTCString.call(a));y(a)&&(e=" "+b(a));if(0===n.length&&(!z||0==a.length))return t[0]+
e+t[1];if(0>d)return p(a)?c.stylize(RegExp.prototype.toString.call(a),"regexp"):c.stylize("[Object]","special");c.seen.push(a);n=z?f(c,a,d,q,n):n.map(function(b){return g(c,a,d,q,b,z)});c.seen.pop();return u(n,e,t)}function h(b,c){if(v(c))return b.stylize("undefined","undefined");if(r(c)){var a="'"+JSON.stringify(c).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return b.stylize(a,"string")}if(t(c))return b.stylize(""+c,"number");if(z(c))return b.stylize(""+c,"boolean");if(null===
c)return b.stylize("null","null")}function b(b){return"["+Error.prototype.toString.call(b)+"]"}function f(b,c,a,d,f){for(var e=[],h=0,l=c.length;h<l;++h)Object.prototype.hasOwnProperty.call(c,String(h))?e.push(g(b,c,a,d,String(h),!0)):e.push("");f.forEach(function(f){f.match(/^\d+$/)||e.push(g(b,c,a,d,f,!0))});return e}function g(b,c,a,g,d,f){var e,h;c=Object.getOwnPropertyDescriptor(c,d)||{value:c[d]};c.get?h=c.set?b.stylize("[Getter/Setter]","special"):b.stylize("[Getter]","special"):c.set&&(h=
b.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(g,d)||(e="["+d+"]");h||(0>b.seen.indexOf(c.value)?(h=null===a?m(b,c.value,null):m(b,c.value,a-1),-1<h.indexOf("\n")&&(h=f?h.split("\n").map(function(b){return"  "+b}).join("\n").substr(2):"\n"+h.split("\n").map(function(b){return"   "+b}).join("\n"))):h=b.stylize("[Circular]","special"));if(v(e)){if(f&&d.match(/^\d+$/))return h;e=JSON.stringify(""+d);e.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(e=e.substr(1,e.length-2),e=b.stylize(e,
"name")):(e=e.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e=b.stylize(e,"string"))}return e+": "+h}function u(b,c,a){var g=0;return 60<b.reduce(function(b,c){g++;0<=c.indexOf("\n")&&g++;return b+c.replace(/\u001b\[\d\d?m/g,"").length+1},0)?a[0]+(""===c?"":c+"\n ")+" "+b.join(",\n  ")+" "+a[1]:a[0]+c+" "+b.join(", ")+" "+a[1]}function D(b){return Array.isArray(b)}function z(b){return"boolean"===typeof b}function t(b){return"number"===typeof b}function r(b){return"string"===typeof b}
function v(b){return void 0===b}function p(b){return w(b)&&"[object RegExp]"===Object.prototype.toString.call(b)}function w(b){return"object"===typeof b&&null!==b}function A(b){return w(b)&&"[object Date]"===Object.prototype.toString.call(b)}function y(b){return w(b)&&("[object Error]"===Object.prototype.toString.call(b)||b instanceof Error)}function x(b){return"function"===typeof b}function F(b){return 10>b?"0"+b.toString(10):b.toString(10)}function G(){var b=new Date,c=[F(b.getHours()),F(b.getMinutes()),
F(b.getSeconds())].join(":");return[b.getDate(),I[b.getMonth()],c].join(" ")}var J=/%[sdj%]/g;k.format=function(b){if(!r(b)){for(var c=[],a=0;a<arguments.length;a++)c.push(n(arguments[a]));return c.join(" ")}for(var a=1,g=arguments,d=g.length,c=String(b).replace(J,function(b){if("%%"===b)return"%";if(a>=d)return b;switch(b){case "%s":return String(g[a++]);case "%d":return Number(g[a++]);case "%j":try{return JSON.stringify(g[a++])}catch(P){return"[Circular]"}default:return b}}),f=g[a];a<d;f=g[++a])c=
null!==f&&w(f)?c+(" "+n(f)):c+(" "+f);return c};k.deprecate=function(b,c){if(v(d.process))return function(){return k.deprecate(b,c).apply(this,arguments)};if(!0===e.noDeprecation)return b;var a=!1;return function(){if(!a){if(e.throwDeprecation)throw Error(c);e.traceDeprecation?console.trace(c):console.error(c);a=!0}return b.apply(this,arguments)}};var B={},K;k.debuglog=function(b){v(K)&&(K=e.env.NODE_DEBUG||"");b=b.toUpperCase();if(!B[b])if((new RegExp("\\b"+b+"\\b","i")).test(K)){var c=e.pid;B[b]=
function(){var a=k.format.apply(k,arguments);console.error("%s %d: %s",b,c,a)}}else B[b]=function(){};return B[b]};k.inspect=n;n.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};n.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};k.isArray=D;k.isBoolean=z;k.isNull=function(b){return null===
b};k.isNullOrUndefined=function(b){return null==b};k.isNumber=t;k.isString=r;k.isSymbol=function(b){return"symbol"===typeof b};k.isUndefined=v;k.isRegExp=p;k.isObject=w;k.isDate=A;k.isError=y;k.isFunction=x;k.isPrimitive=function(b){return null===b||"boolean"===typeof b||"number"===typeof b||"string"===typeof b||"symbol"===typeof b||"undefined"===typeof b};k.isBuffer=a("./support/isBuffer");var I="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");k.log=function(){console.log("%s - %s",G(),
k.format.apply(k,arguments))};k.inherits=a("inherits");k._extend=function(b,c){if(!c||!w(c))return b;for(var a=Object.keys(c),g=a.length;g--;)b[a[g]]=c[a[g]];return b}}).call(this,a("_process"),"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./support/isBuffer":62,_process:57,inherits:61}],64:[function(a,p,k){p.exports.VectorTile=a("./lib/vectortile.js");p.exports.VectorTileFeature=a("./lib/vectortilefeature.js");p.exports.VectorTileLayer=
a("./lib/vectortilelayer.js")},{"./lib/vectortile.js":65,"./lib/vectortilefeature.js":66,"./lib/vectortilelayer.js":67}],65:[function(a,p,k){function e(a,e,c){3===a&&(a=new d(c,c.readVarint()+c.pos),a.length&&(e[a.name]=a))}var d=a("./vectortilelayer");p.exports=function(a,d){this.layers=a.readFields(e,{},d)}},{"./vectortilelayer":67}],66:[function(a,p,k){function e(c,a,e,h,b){this.properties={};this.extent=e;this.type=0;this._pbf=c;this._geometry=-1;this._keys=h;this._values=b;c.readFields(d,this,
a)}function d(c,a,d){if(1==c)a.id=d.readVarint();else if(2==c)for(c=d.readVarint()+d.pos;d.pos<c;){var e=a._keys[d.readVarint()],b=a._values[d.readVarint()];a.properties[e]=b}else 3==c?a.type=d.readVarint():4==c&&(a._geometry=d.pos)}function n(c){var a=c.length;if(1>=a)return[c];for(var d=[],e,b,f=0;f<a;f++){var g,n,q=c[f],z=0,t=0,r=q.length;for(n=r-1;t<r;n=t++)g=q[t],n=q[n],z+=(n.x-g.x)*(g.y+n.y);g=z;0!==g&&(void 0===b&&(b=0>g),b===0>g?(e&&d.push(e),e=[c[f]]):e.push(c[f]))}e&&d.push(e);return d}
var q=a("point-geometry");p.exports=e;e.types=["Unknown","Point","LineString","Polygon"];e.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,d=1,e=0,b=0,f=0,g=[],n;c.pos<a;)if(e||(e=c.readVarint(),d=e&7,e>>=3),e--,1===d||2===d)b+=c.readSVarint(),f+=c.readSVarint(),1===d&&(n&&g.push(n),n=[]),n.push(new q(b,f));else if(7===d)n&&n.push(n[0].clone());else throw Error("unknown command "+d);n&&g.push(n);return g};e.prototype.bbox=function(){var c=this._pbf;
c.pos=this._geometry;for(var a=c.readVarint()+c.pos,d=1,e=0,b=0,f=0,g=Infinity,n=-Infinity,q=Infinity,z=-Infinity;c.pos<a;)if(e||(e=c.readVarint(),d=e&7,e>>=3),e--,1===d||2===d)b+=c.readSVarint(),f+=c.readSVarint(),b<g&&(g=b),b>n&&(n=b),f<q&&(q=f),f>z&&(z=f);else if(7!==d)throw Error("unknown command "+d);return[g,q,n,z]};e.prototype.toGeoJSON=function(c,a,d){function h(c){for(var a=0;a<c.length;a++){var d=c[a];c[a]=[360*(d.x+f)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(d.y+g)/b)*Math.PI/180))-
90]}}var b=this.extent*Math.pow(2,d),f=this.extent*c,g=this.extent*a;c=this.loadGeometry();a=e.types[this.type];var l;switch(this.type){case 1:l=[];for(d=0;d<c.length;d++)l[d]=c[d][0];c=l;h(c);break;case 2:for(d=0;d<c.length;d++)h(c[d]);break;case 3:for(c=n(c),d=0;d<c.length;d++)for(l=0;l<c[d].length;l++)h(c[d][l])}1===c.length?c=c[0]:a="Multi"+a;c={type:"Feature",geometry:{type:a,coordinates:c},properties:this.properties};"id"in this&&(c.id=this.id);return c}},{"point-geometry":56}],67:[function(a,
p,k){function e(c,a){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=c;this._keys=[];this._values=[];this._features=[];c.readFields(d,this,a);this.length=this._features.length}function d(c,a,d){15===c?a.version=d.readVarint():1===c?a.name=d.readString():5===c?a.extent=d.readVarint():2===c?a._features.push(d.pos):3===c?a._keys.push(d.readString()):4===c&&a._values.push(n(d))}function n(a){for(var c=null,d=a.readVarint()+a.pos;a.pos<d;)c=a.readVarint()>>3,c=1===c?a.readString():
2===c?a.readFloat():3===c?a.readDouble():4===c?a.readVarint64():5===c?a.readVarint():6===c?a.readSVarint():7===c?a.readBoolean():null;return c}var q=a("./vectortilefeature.js");p.exports=e;e.prototype.feature=function(a){if(0>a||a>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[a];a=this._pbf.readVarint()+this._pbf.pos;return new q(this._pbf,a,this.extent,this._keys,this._values)}},{"./vectortilefeature.js":66}],68:[function(a,p,k){function e(a){var c=
[],e;for(e in a.layers)c.push(d(a.layers[e]));a=new n;q.tile.write({layers:c},a);return a.finish()}function d(a){for(var c={name:a.name||"",version:a.version||1,extent:a.extent||4096,keys:[],values:[],features:[]},d={},b={},f=0;f<a.length;f++){for(var g=a.feature(f),e=g,l=g.loadGeometry(),n=[],q=0,r=0,k=l.length,p=0;p<k;p++){var w=l[p];n.push(9);for(var A=0;A<w.length;A++){1===A&&n.push((w.length-1<<3)+2);var y=w[A].x-q,x=w[A].y-r;n.push(y<<1^y>>31,x<<1^x>>31);q+=y;r+=x}}e.geometry=n;var e=[],F;for(F in g.properties)l=
d[F],"undefined"===typeof l&&(c.keys.push(F),l=c.keys.length-1,d[F]=l),q=g.properties[F],r=typeof q,"string"===r?n={string_value:q}:"boolean"===r?n={bool_value:q}:"number"===r?n=0!==q%1?{double_value:q}:0>q?{sint_value:q}:{uint_value:q}:(q=JSON.stringify(q),n={string_value:q}),n.key=r+":"+q,q=b[n.key],"undefined"===typeof q&&(c.values.push(n),q=c.values.length-1,b[n.key]=q),e.push(l),e.push(q);g.tags=e;c.features.push(g)}return c}var n=a("pbf"),q=a("./vector-tile-pb"),c=a("./lib/geojson_wrapper");
p.exports=e;p.exports.fromVectorTileJs=e;p.exports.fromGeojsonVt=function(a){var d={},h;for(h in a)d[h]=new c(a[h].features),d[h].name=h;return e({layers:d})};p.exports.GeoJSONWrapper=c},{"./lib/geojson_wrapper":69,"./vector-tile-pb":70,pbf:55}],69:[function(a,p,k){function e(a){this.features=a;this.length=a.length}function d(a){this.id="number"===typeof a.id?a.id:void 0;this.type=a.type;this.rawGeometry=1===a.type?[a.geometry]:a.geometry;this.properties=a.tags;this.extent=4096}var n=a("point-geometry");
a=a("vector-tile").VectorTileFeature;p.exports=e;e.prototype.feature=function(a){return new d(this.features[a])};d.prototype.loadGeometry=function(){var a=this.rawGeometry;this.geometry=[];for(var c=0;c<a.length;c++){for(var d=a[c],e=[],h=0;h<d.length;h++)e.push(new n(d[h][0],d[h][1]));this.geometry.push(e)}return this.geometry};d.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,c=Infinity,d=-Infinity,e=Infinity,h=-Infinity,b=0;b<a.length;b++)for(var f=a[b],g=0;g<
f.length;g++)var n=f[g],c=Math.min(c,n.x),d=Math.max(d,n.x),e=Math.min(e,n.y),h=Math.max(h,n.y);return[c,e,d,h]};d.prototype.toGeoJSON=a.prototype.toGeoJSON},{"point-geometry":56,"vector-tile":64}],70:[function(a,p,k){function e(b,a,c){3===b&&a.layers.push(h(c,c.readVarint()+c.pos))}function d(b,a){return b.readFields(n,{},a)}function n(b,a,c){1===b?a.string_value=c.readString():2===b?a.float_value=c.readFloat():3===b?a.double_value=c.readDouble():4===b?a.int_value=c.readVarint():5===b?a.uint_value=
c.readVarint():6===b?a.sint_value=c.readSVarint():7===b&&(a.bool_value=c.readBoolean())}function q(b,a){void 0!==b.string_value&&a.writeStringField(1,b.string_value);void 0!==b.float_value&&a.writeFloatField(2,b.float_value);void 0!==b.double_value&&a.writeDoubleField(3,b.double_value);void 0!==b.int_value&&a.writeVarintField(4,b.int_value);void 0!==b.uint_value&&a.writeVarintField(5,b.uint_value);void 0!==b.sint_value&&a.writeSVarintField(6,b.sint_value);void 0!==b.bool_value&&a.writeBooleanField(7,
b.bool_value)}function c(b,a){var c=b.readFields(l,{},a);void 0===c.type&&(c.type="Unknown");return c}function l(b,a,c){1===b?a.id=c.readVarint():2===b?a.tags=c.readPackedVarint():3===b?a.type=c.readVarint():4===b&&(a.geometry=c.readPackedVarint())}function m(b,a){void 0!==b.id&&a.writeVarintField(1,b.id);void 0!==b.tags&&a.writePackedVarint(2,b.tags);void 0!==b.type&&a.writeVarintField(3,b.type);void 0!==b.geometry&&a.writePackedVarint(4,b.geometry)}function h(a,c){return a.readFields(b,{features:[],
keys:[],values:[]},c)}function b(b,a,f){15===b?a.version=f.readVarint():1===b?a.name=f.readString():2===b?a.features.push(c(f,f.readVarint()+f.pos)):3===b?a.keys.push(f.readString()):4===b?a.values.push(d(f,f.readVarint()+f.pos)):5===b&&(a.extent=f.readVarint())}function f(b,a){void 0!==b.version&&a.writeVarintField(15,b.version);void 0!==b.name&&a.writeStringField(1,b.name);var c;if(void 0!==b.features)for(c=0;c<b.features.length;c++)a.writeMessage(2,m,b.features[c]);if(void 0!==b.keys)for(c=0;c<
b.keys.length;c++)a.writeStringField(3,b.keys[c]);if(void 0!==b.values)for(c=0;c<b.values.length;c++)a.writeMessage(4,q,b.values[c]);void 0!==b.extent&&a.writeVarintField(5,b.extent)}a=k.tile={read:function(b,a){return b.readFields(e,{layers:[]},a)},write:function(b,a){var c;if(void 0!==b.layers)for(c=0;c<b.layers.length;c++)a.writeMessage(3,f,b.layers[c])}};a.GeomType={Unknown:0,Point:1,LineString:2,Polygon:3};a.value={read:d,write:q};a.feature={read:c,write:m};a.layer={read:h,write:f}},{}],71:[function(a,
p,k,e,d,n){var q=JSON.stringify;p.exports=function(a,l){function c(b){z[b]=!0;for(var a in d[b][1]){var g=d[b][1][a];z[g]||c(g)}}for(var h,b=Object.keys(n),f=0,g=b.length;f<g;f++){var u=b[f],D=n[u].exports;if(D===a||D&&D["default"]===a){h=u;break}}if(!h){h=Math.floor(Math.pow(16,8)*Math.random()).toString(16);D={};f=0;for(g=b.length;f<g;f++)u=b[f],D[u]=u;d[h]=[Function(["require","module","exports"],"("+a+")(self)"),D]}b=Math.floor(Math.pow(16,8)*Math.random()).toString(16);f={};f[h]=h;d[b]=[Function(["require"],
"var f = require("+q(h)+");(f.default ? f.default : f)(self);"),f];var z={};c(b);b="("+e+")({"+Object.keys(z).map(function(b){return q(b)+":["+d[b][0]+","+q(d[b][1])+"]"}).join(",")+"},{},["+q(b)+"])";h=window.URL||window.webkitURL||window.mozURL||window.msURL;b=new Blob([b],{type:"text/javascript"});if(l&&l.bare)return b;h=h.createObjectURL(b);b=new Worker(h);b.objectURL=h;return b}},{}],72:[function(a,p,k){p.exports.RADIUS=6378137;p.exports.FLATTENING=1/298.257223563;p.exports.POLAR_RADIUS=6356752.3142},
{}],73:[function(a,p,k){p.exports={version:"0.38.0"}},{}],74:[function(a,p,k){var e=a("./program_configuration"),d=a("./vertex_array_type"),n=function(a,d){this.vertexOffset=a;this.primitiveOffset=d;this.primitiveLength=this.vertexLength=0},q=function(a,l,m){this.globalProperties={zoom:m};this.layoutVertexArray=new (d(a.layoutAttributes));a.dynamicLayoutAttributes&&(this.dynamicLayoutVertexArray=new (d(a.dynamicLayoutAttributes)));var c=a.elementArrayType;c&&(this.elementArray=new c);if(c=a.elementArrayType2)this.elementArray2=
new c;this.layerData={};for(c=0;c<l.length;c+=1){var b=l[c],f=e.createDynamic(a,b,m);this.layerData[b.id]={layer:b,programConfiguration:f,paintVertexArray:new f.PaintVertexArray,paintPropertyStatistics:f.createPaintPropertyStatistics()}}this.segments=[];this.segments2=[]};q.prototype.prepareSegment=function(a){var c=this.segments[this.segments.length-1];if(!c||c.vertexLength+a>q.MAX_VERTEX_ARRAY_LENGTH)c=new n(this.layoutVertexArray.length,this.elementArray.length),this.segments.push(c);return c};
q.prototype.prepareSegment2=function(a){var c=this.segments2[this.segments2.length-1];if(!c||c.vertexLength+a>q.MAX_VERTEX_ARRAY_LENGTH)c=new n(this.layoutVertexArray.length,this.elementArray2.length),this.segments2.push(c);return c};q.prototype.populatePaintArrays=function(a){for(var c in this.layerData){var d=this.layerData[c];0!==d.paintVertexArray.bytesPerElement&&d.programConfiguration.populatePaintArray(d.layer,d.paintVertexArray,d.paintPropertyStatistics,this.layoutVertexArray.length,a)}};
q.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length};q.prototype.serialize=function(a){var c=this.layoutVertexArray.serialize(a),d=this.dynamicLayoutVertexArray&&this.dynamicLayoutVertexArray.serialize(a),e=this.elementArray&&this.elementArray.serialize(a),b=this.elementArray2&&this.elementArray2.serialize(a),f=this.layerData,g={},n;for(n in f){var q=f[n].paintVertexArray;if(0!==q.length){var z=q.serialize(a),q=q.constructor.serialize();g[n]={array:z,type:q}}}return{layoutVertexArray:c,
dynamicLayoutVertexArray:d,elementArray:e,elementArray2:b,paintVertexArrays:g,segments:this.segments,segments2:this.segments2}};q.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;p.exports=q},{"./program_configuration":88,"./vertex_array_type":90}],75:[function(a,p,k){var e=a("./array_group"),d=a("./buffer_group"),n=a("../util/util");a=function(a,c){this.zoom=a.zoom;this.overscaling=a.overscaling;this.layers=a.layers;this.index=a.index;a.arrays?this.buffers=new d(c,a.layers,a.zoom,a.arrays):this.arrays=new e(c,
a.layers,a.zoom)};a.deserialize=function(a,c){var d={};if(!c)return d;for(var e=0;e<a.length;e+=1){var h=a[e],b=h.layerIds.map(function(b){return c.getLayer(b)}).filter(Boolean);if(0!==b.length)for(var h=b[0].createBucket(n.extend({layers:b},h)),f=0;f<b.length;f+=1)d[b[f].id]=h}return d};a.prototype.populate=function(a,c){for(var d=0;d<a.length;d+=1){var e=a[d],h=e.feature,b=e.index,e=e.sourceLayerIndex;this.layers[0].filter(h)&&(this.addFeature(h),c.featureIndex.insert(h,b,e,this.index))}};a.prototype.getPaintPropertyStatistics=
function(){return n.mapObject(this.arrays.layerData,function(a){return a.paintPropertyStatistics})};a.prototype.isEmpty=function(){return this.arrays.isEmpty()};a.prototype.serialize=function(a){return{zoom:this.zoom,layerIds:this.layers.map(function(a){return a.id}),arrays:this.arrays.serialize(a)}};a.prototype.destroy=function(){this.buffers&&(this.buffers.destroy(),this.buffers=null)};p.exports=a},{"../util/util":241,"./array_group":74,"./buffer_group":82}],76:[function(a,p,k){function e(a,c,d,
b,f){a.emplaceBack(2*c+(b+1)/2,2*d+(f+1)/2)}k=a("../bucket");var d=a("../element_array_type"),n=a("../load_geometry"),q=a("../extent"),c={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:d(),paintAttributes:[{property:"circle-color"},{property:"circle-radius"},{property:"circle-blur"},{property:"circle-opacity"},{property:"circle-stroke-color"},{property:"circle-stroke-width"},{property:"circle-stroke-opacity"}]};a=function(a){function d(d){a.call(this,d,c)}a&&(d.__proto__=
a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.addFeature=function(a){for(var b=this.arrays,c=0,d=n(a);c<d.length;c+=1)for(var h=0,l=d[c];h<l.length;h+=1){var m=l[h],t=m.x,m=m.y;if(!(0>t||t>=q||0>m||m>=q)){var r=b.prepareSegment(4),k=r.vertexLength;e(b.layoutVertexArray,t,m,-1,-1);e(b.layoutVertexArray,t,m,1,-1);e(b.layoutVertexArray,t,m,1,1);e(b.layoutVertexArray,t,m,-1,1);b.elementArray.emplaceBack(k,k+1,k+2);b.elementArray.emplaceBack(k,k+3,k+2);r.vertexLength+=
4;r.primitiveLength+=2}}b.populatePaintArrays(a.properties)};return d}(k);a.programInterface=c;p.exports=a},{"../bucket":75,"../element_array_type":83,"../extent":84,"../load_geometry":86}],77:[function(a,p,k){k=a("../bucket");var e=a("../element_array_type"),d=a("../load_geometry"),n=a("earcut"),q=a("../../util/classify_rings"),c=a("assert"),l={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"}],elementArrayType:e(3),elementArrayType2:e(2),paintAttributes:[{property:"fill-color"},{property:"fill-outline-color"},
{property:"fill-opacity"}]};a=function(a){function e(b){a.call(this,b,l)}a&&(e.__proto__=a);e.prototype=Object.create(a&&a.prototype);e.prototype.constructor=e;e.prototype.addFeature=function(b){for(var a=this.arrays,g=0,e=q(d(b),500);g<e.length;g+=1){for(var h=e[g],l=0,m=0,r=h;m<r.length;m+=1)l+=r[m].length;for(var m=a.prepareSegment(l),r=m.vertexLength,k=[],p=[],w=0,A=h;w<A.length;w+=1){var y=A[w];if(0!==y.length){y!==h[0]&&p.push(k.length/2);var x=a.prepareSegment2(y.length),F=x.vertexLength;a.layoutVertexArray.emplaceBack(y[0].x,
y[0].y);a.elementArray2.emplaceBack(F+y.length-1,F);k.push(y[0].x);k.push(y[0].y);for(var G=1;G<y.length;G++)a.layoutVertexArray.emplaceBack(y[G].x,y[G].y),a.elementArray2.emplaceBack(F+G-1,F+G),k.push(y[G].x),k.push(y[G].y);x.vertexLength+=y.length;x.primitiveLength+=y.length}}h=n(k,p);c(0===h.length%3);for(k=0;k<h.length;k+=3)a.elementArray.emplaceBack(r+h[k],r+h[k+1],r+h[k+2]);m.vertexLength+=l;m.primitiveLength+=h.length/3}a.populatePaintArrays(b.properties)};return e}(k);a.programInterface=l;
p.exports=a},{"../../util/classify_rings":223,"../bucket":75,"../element_array_type":83,"../load_geometry":86,assert:9,earcut:11}],78:[function(a,p,k){function e(a,c,d,e,h,l,m,n){a.emplaceBack(c,d,2*Math.floor(e*b)+m,h*b*2,l*b*2,Math.round(n))}k=a("../bucket");var d=a("../element_array_type"),n=a("../load_geometry"),q=a("../extent"),c=a("earcut"),l=a("../../util/classify_rings"),m=a("assert"),h={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_normal",components:3,type:"Int16"},
{name:"a_edgedistance",components:1,type:"Int16"}],elementArrayType:d(3),paintAttributes:[{property:"fill-extrusion-base"},{property:"fill-extrusion-height"},{property:"fill-extrusion-color"}]},b=Math.pow(2,13);a=function(b){function a(a){b.call(this,a,h)}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.addFeature=function(b){for(var a=this.arrays,d=0,g=l(n(b),500);d<g.length;d+=1){for(var f=g[d],h=0,u=0,k=f;u<k.length;u+=1)h+=k[u].length;for(var h=
a.prepareSegment(5*h),k=[],p=[],u=[],y=0,x=f;y<x.length;y+=1){var F=x[y];if(0!==F.length){F!==f[0]&&p.push(k.length/2);for(var G=0,J=0;J<F.length;J++){var B=F[J];e(a.layoutVertexArray,B.x,B.y,0,0,1,1,0);u.push(h.vertexLength++);if(1<=J){var K=F[J-1];if(!(B.x===K.x&&(0>B.x||B.x>q)||B.y===K.y&&(0>B.y||B.y>q))){var I=B.sub(K)._perp()._unit();e(a.layoutVertexArray,B.x,B.y,I.x,I.y,0,0,G);e(a.layoutVertexArray,B.x,B.y,I.x,I.y,0,1,G);G+=K.dist(B);e(a.layoutVertexArray,K.x,K.y,I.x,I.y,0,0,G);e(a.layoutVertexArray,
K.x,K.y,I.x,I.y,0,1,G);K=h.vertexLength;a.elementArray.emplaceBack(K,K+1,K+2);a.elementArray.emplaceBack(K+1,K+2,K+3);h.vertexLength+=4;h.primitiveLength+=2}}k.push(B.x);k.push(B.y)}}}f=c(k,p);m(0===f.length%3);for(k=0;k<f.length;k+=3)a.elementArray.emplaceBack(u[f[k]],u[f[k+1]],u[f[k+2]]);h.primitiveLength+=f.length/3}a.populatePaintArrays(b.properties)};return a}(k);a.programInterface=h;p.exports=a},{"../../util/classify_rings":223,"../bucket":75,"../element_array_type":83,"../extent":84,"../load_geometry":86,
assert:9,earcut:11}],79:[function(a,p,k){function e(b,a,c,d,e,h,l){b.emplaceBack(a.x<<1|d,a.y<<1|e,Math.round(63*c.x)+128,Math.round(63*c.y)+128,(0===h?0:0>h?-1:1)+1|(.5*l&63)<<2,.5*l>>6)}k=a("../bucket");var d=a("../element_array_type"),n=a("../load_geometry"),q=a("../extent"),c=a("vector-tile").VectorTileFeature.types,l=Math.cos(Math.PI/180*37.5),m=Math.pow(2,14)/.5,h={layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],paintAttributes:[{property:"line-color"},
{property:"line-blur"},{property:"line-opacity"},{property:"line-gap-width",name:"gapwidth"},{property:"line-offset"},{property:"line-width"},{property:"line-width",name:"floorwidth",useIntegerZoom:!0}],elementArrayType:d()};a=function(b){function a(a){b.call(this,a,h)}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.addFeature=function(b){for(var a=this.layers[0].layout,c=a["line-join"],d=a["line-cap"],g=a["line-miter-limit"],a=a["line-round-limit"],
f=0,e=n(b,15);f<e.length;f+=1)this.addLine(e[f],b,c,d,g,a)};a.prototype.addLine=function(b,a,d,f,e,h){var g=a.properties;a="Polygon"===c[a.type];for(var m=b.length;2<=m&&b[m-1].equals(b[m-2]);)m--;for(var n=0;n<m-1&&b[n].equals(b[n+1]);)n++;if(!(m<(a?3:2))){"bevel"===d&&(e=1.05);var u=q/(512*this.overscaling)*15,D=b[n],z=this.arrays,r=z.prepareSegment(10*m);this.distance=0;var k=a?"butt":f,t=!0,p,K=void 0,I,E=void 0,H=void 0,L,N;this.e1=this.e2=this.e3=-1;a&&(p=b[m-2],H=D.sub(p)._unit()._perp());
for(D=n;D<m;D++)if(I=a&&D===m-1?b[n+1]:b[D+1],!I||!b[D].equals(I)){H&&(E=H);p&&(K=p);p=b[D];var H=I?I.sub(p)._unit()._perp():E,E=E||H,Q=E.add(H);0===Q.x&&0===Q.y||Q._unit();var R=Q.x*H.x+Q.y*H.y;L=0!==R?1/R:Infinity;var O=R<l&&K&&I;if(O&&D>n){var P=p.dist(K);P>2*u&&(P=p.sub(p.sub(K)._mult(u/P)._round()),this.distance+=P.dist(K),this.addCurrentVertex(P,this.distance,E.mult(1),0,0,!1,r),K=P)}var S=(P=K&&I)?d:I?f:k;P&&"round"===S&&(L<h?S="miter":2>=L&&(S="fakeround"));"miter"===S&&L>e&&(S="bevel");"bevel"===
S&&(2<L&&(S="flipbevel"),L<e&&(S="miter"));K&&(this.distance+=p.dist(K));if("miter"===S)Q._mult(L),this.addCurrentVertex(p,this.distance,Q,0,0,!1,r);else if("flipbevel"===S)100<L?Q=H.clone().mult(-1):(t=0<E.x*H.y-E.y*H.x?-1:1,P=L*E.add(H).mag()/E.sub(H).mag(),Q._perp()._mult(P*t)),this.addCurrentVertex(p,this.distance,Q,0,0,!1,r),this.addCurrentVertex(p,this.distance,Q.mult(-1),0,0,!1,r);else if("bevel"===S||"fakeround"===S){var P=0<E.x*H.y-E.y*H.x,T=-Math.sqrt(L*L-1);P?(N=0,L=T):(L=0,N=T);t||this.addCurrentVertex(p,
this.distance,E,L,N,!1,r);if("fakeround"===S){t=Math.floor(8*(.5-(R-.5)));for(S=0;S<t;S++)R=H.mult((S+1)/(t+1))._add(E)._unit(),this.addPieSliceVertex(p,this.distance,R,P,r);this.addPieSliceVertex(p,this.distance,Q,P,r);for(Q=t-1;0<=Q;Q--)R=E.mult((Q+1)/(t+1))._add(H)._unit(),this.addPieSliceVertex(p,this.distance,R,P,r)}I&&this.addCurrentVertex(p,this.distance,H,-L,-N,!1,r)}else"butt"===S?(t||this.addCurrentVertex(p,this.distance,E,0,0,!1,r),I&&this.addCurrentVertex(p,this.distance,H,0,0,!1,r)):
"square"===S?(t||(this.addCurrentVertex(p,this.distance,E,1,1,!1,r),this.e1=this.e2=-1),I&&this.addCurrentVertex(p,this.distance,H,-1,-1,!1,r)):"round"===S&&(t||(this.addCurrentVertex(p,this.distance,E,0,0,!1,r),this.addCurrentVertex(p,this.distance,E,1,1,!0,r),this.e1=this.e2=-1),I&&(this.addCurrentVertex(p,this.distance,H,-1,-1,!0,r),this.addCurrentVertex(p,this.distance,H,0,0,!1,r)));O&&D<m-1&&(O=p.dist(I),O>2*u&&(I=p.add(I.sub(p)._mult(u/O)._round()),this.distance+=I.dist(p),this.addCurrentVertex(I,
this.distance,H.mult(1),0,0,!1,r),p=I));t=!1}z.populatePaintArrays(g)}};a.prototype.addCurrentVertex=function(b,a,c,d,f,h,l){var g=h?1:0,n;n=this.arrays;var q=n.layoutVertexArray,u=n.elementArray;n=c.clone();d&&n._sub(c.perp()._mult(d));e(q,b,n,g,0,d,a);this.e3=l.vertexLength++;0<=this.e1&&0<=this.e2&&(u.emplaceBack(this.e1,this.e2,this.e3),l.primitiveLength++);this.e1=this.e2;this.e2=this.e3;n=c.mult(-1);f&&n._sub(c.perp()._mult(f));e(q,b,n,g,1,-f,a);this.e3=l.vertexLength++;0<=this.e1&&0<=this.e2&&
(u.emplaceBack(this.e1,this.e2,this.e3),l.primitiveLength++);this.e1=this.e2;this.e2=this.e3;a>m/2&&(this.distance=0,this.addCurrentVertex(b,this.distance,c,d,f,h,l))};a.prototype.addPieSliceVertex=function(b,a,c,d,f){var g=d?1:0;c=c.mult(d?-1:1);var h=this.arrays,l=h.elementArray;e(h.layoutVertexArray,b,c,0,g,0,a);this.e3=f.vertexLength++;0<=this.e1&&0<=this.e2&&(l.emplaceBack(this.e1,this.e2,this.e3),f.primitiveLength++);d?this.e2=this.e3:this.e1=this.e3};return a}(k);a.programInterface=h;p.exports=
a},{"../bucket":75,"../element_array_type":83,"../extent":84,"../load_geometry":86,"vector-tile":64}],80:[function(a,p,k){function e(b,a,c,d,g,f,e,h){b.emplaceBack(a,c,Math.round(64*d),Math.round(64*g),f,e,h?h[0]:void 0,h?h[1]:void 0)}function d(b,a,c,d){var g=2*Math.PI;c=f((c+g)%g/g*255,10*d);b.emplaceBack(a.x,a.y,c);b.emplaceBack(a.x,a.y,c);b.emplaceBack(a.x,a.y,c);b.emplaceBack(a.x,a.y,c)}function n(b,a,c,d,g,f){return b.emplaceBack(a.x,a.y,c.x,c.y,Math.round(d.x),Math.round(d.y),10*g,10*f)}function q(b,
a,c){var d={isFeatureConstant:a.isLayoutValueFeatureConstant(c),isZoomConstant:a.isLayoutValueZoomConstant(c)};d.isFeatureConstant&&(d.layoutSize=a.getLayoutValue(c,{zoom:b+1}));if(!d.isZoomConstant){for(var g=a.getLayoutValueStopZoomLevels(c),f=0;f<g.length&&g[f]<=b;)f++;for(var e=f=Math.max(0,f-1);e<g.length&&g[e]<b+1;)e++;e=Math.min(g.length-1,e);d.coveringZoomRange=[g[f],g[e]];a.isLayoutValueFeatureConstant(c)&&(d.coveringStopValues=[a.getLayoutValue(c,{zoom:g[f]}),a.getLayoutValue(c,{zoom:g[e]})]);
d.functionBase=a.getLayoutProperty(c).base;"undefined"===typeof d.functionBase&&(d.functionBase=1);d.functionType=a.getLayoutProperty(c).type||"exponential"}return d}function c(b,a,c,d,g){return b.isLayoutValueZoomConstant(d)&&!b.isLayoutValueFeatureConstant(d)?[10*b.getLayoutValue(d,{},g)]:b.isLayoutValueZoomConstant(d)||b.isLayoutValueFeatureConstant(d)?null:[10*b.getLayoutValue(d,{zoom:c[0]},g),10*b.getLayoutValue(d,{zoom:c[1]},g)]}var l=a("point-geometry"),m=a("../array_group"),h=a("../buffer_group");
k=a("../element_array_type");var b=a("../extent"),f=a("../../shaders/encode_attribute").packUint8ToFloat,g=a("../../symbol/anchor"),u=a("../../symbol/get_anchors"),D=a("../../util/token"),z=a("../../symbol/quads"),t=a("../../symbol/shaping"),r=a("../../symbol/transform_text"),v=a("../../symbol/mergelines"),C=a("../../symbol/clip_line"),w=a("../../util/util"),A=a("../../util/script_detection"),y=a("../load_geometry"),x=a("../../symbol/collision_feature"),F=a("../../util/find_pole_of_inaccessibility"),
G=a("../../util/classify_rings"),J=a("vector-tile").VectorTileFeature;a=a("../../util/struct_array");var B=t.shapeText,K=t.shapeIcon,I=t.WritingMode,E=z.getGlyphQuads,H=z.getIconQuads,L=a({members:[{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",
name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Float32",name:"placementZoom"},{type:"Uint8",name:"vertical"}]}),N=a({members:[{type:"Float32",name:"offsetX"}]}),Q=a({members:[{type:"Int16",name:"x"},{type:"Int16",name:"y"}]});a=k();var z=[{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}],t=[{name:"a_projected_pos",components:3,type:"Float32"}],R={glyph:{layoutAttributes:z,dynamicLayoutAttributes:t,elementArrayType:a,paintAttributes:[{name:"fill_color",
property:"text-color",type:"Uint8"},{name:"halo_color",property:"text-halo-color",type:"Uint8"},{name:"halo_width",property:"text-halo-width",type:"Uint16",multiplier:10},{name:"halo_blur",property:"text-halo-blur",type:"Uint16",multiplier:10},{name:"opacity",property:"text-opacity",type:"Uint8",multiplier:255}]},icon:{layoutAttributes:z,dynamicLayoutAttributes:t,elementArrayType:a,paintAttributes:[{name:"fill_color",property:"icon-color",type:"Uint8"},{name:"halo_color",property:"icon-halo-color",
type:"Uint8"},{name:"halo_width",property:"icon-halo-width",type:"Uint16",multiplier:10},{name:"halo_blur",property:"icon-halo-blur",type:"Uint16",multiplier:10},{name:"opacity",property:"icon-opacity",type:"Uint8",multiplier:255}]},collisionBox:{layoutAttributes:[{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"},{name:"a_data",components:2,type:"Uint8"}],elementArrayType:k(2)}},O=function(b){this.collisionBoxArray=
b.collisionBoxArray;this.zoom=b.zoom;this.overscaling=b.overscaling;this.layers=b.layers;this.index=b.index;this.sdfIcons=b.sdfIcons;this.iconsNeedLinear=b.iconsNeedLinear;this.fontstack=b.fontstack;var a=this.layers[0];this.symbolInterfaces=R;if(b.arrays){this.buffers={};for(var c in b.arrays)b.arrays[c]&&(this.buffers[c]=new h(this.symbolInterfaces[c],b.layers,b.zoom,b.arrays[c]));this.textSizeData=b.textSizeData;this.iconSizeData=b.iconSizeData;this.placedGlyphArray=new L(b.placedGlyphArray);this.placedIconArray=
new L(b.placedIconArray);this.glyphOffsetArray=new N(b.glyphOffsetArray);this.lineVertexArray=new Q(b.lineVertexArray)}else this.textSizeData=q(this.zoom,a,"text-size"),this.iconSizeData=q(this.zoom,a,"icon-size")};O.prototype.populate=function(b,a){var c=this.layers[0],d=c.layout,g=d["text-font"],f=(!c.isLayoutValueFeatureConstant("text-field")||d["text-field"])&&g,e=!c.isLayoutValueFeatureConstant("icon-image")||d["icon-image"];this.features=[];if(f||e){for(var h=a.iconDependencies,l=a.glyphDependencies,
g=l[g]=l[g]||{},l={zoom:this.zoom},m=0;m<b.length;m+=1){var n=b[m],q=n.feature,u=n.index,z=n.sourceLayerIndex;if(c.filter(q)){n=void 0;f&&(n=c.getLayoutValue("text-field",l,q.properties),c.isLayoutValueFeatureConstant("text-field")&&(n=D(q.properties,n)),n=r(n,c,l,q.properties));var k=void 0;e&&(k=c.getLayoutValue("icon-image",l,q.properties),c.isLayoutValueFeatureConstant("icon-image")&&(k=D(q.properties,k)));if(n||k)if(this.features.push({text:n,icon:k,index:u,sourceLayerIndex:z,geometry:y(q),properties:q.properties,
type:J.types[q.type]}),k&&(h[k]=!0),n)for(q=0;q<n.length;q++)g[n.charCodeAt(q)]=!0}}"line"===d["symbol-placement"]&&(this.features=v(this.features))}};O.prototype.isEmpty=function(){return this.arrays.icon.isEmpty()&&this.arrays.glyph.isEmpty()&&this.arrays.collisionBox.isEmpty()};O.prototype.getPaintPropertyStatistics=function(){for(var b={},a=0,c=this.layers;a<c.length;a+=1){var d=c[a];b[d.id]=w.extend({},this.arrays.icon.layerData[d.id].paintPropertyStatistics,this.arrays.glyph.layerData[d.id].paintPropertyStatistics)}return b};
O.prototype.serialize=function(b){return{zoom:this.zoom,layerIds:this.layers.map(function(b){return b.id}),sdfIcons:this.sdfIcons,iconsNeedLinear:this.iconsNeedLinear,textSizeData:this.textSizeData,iconSizeData:this.iconSizeData,fontstack:this.fontstack,placedGlyphArray:this.placedGlyphArray.serialize(b),placedIconArray:this.placedIconArray.serialize(b),glyphOffsetArray:this.glyphOffsetArray.serialize(b),lineVertexArray:this.lineVertexArray.serialize(b),arrays:w.mapObject(this.arrays,function(a){return a.isEmpty()?
null:a.serialize(b)})}};O.prototype.destroy=function(){this.buffers&&(this.buffers.icon&&this.buffers.icon.destroy(),this.buffers.glyph&&this.buffers.glyph.destroy(),this.buffers.collisionBox&&this.buffers.collisionBox.destroy(),this.buffers=null)};O.prototype.createArrays=function(){var b=this;this.arrays=w.mapObject(this.symbolInterfaces,function(a){return new m(a,b.layers,b.zoom)})};O.prototype.prepare=function(a,c){this.symbolInstances=[];this.tilePixelRatio=b/(512*this.overscaling);this.compareText=
{};this.iconsNeedLinear=!1;for(var d=this.layers[0].layout,g=.5,f=.5,e=24*d["text-line-height"],h="line"!==d["symbol-placement"]?24*d["text-max-width"]:0,l=this.fontstack=d["text-font"].join(","),m="map"===d["text-rotation-alignment"]&&"line"===d["symbol-placement"],n=0,q=this.features;n<q.length;n+=1){var u=q[n],D=void 0;if(u.text){D=this.layers[0].getLayoutValue("text-anchor",{zoom:this.zoom},u.properties);switch(D){case "right":case "top-right":case "bottom-right":g=1;break;case "left":case "top-left":case "bottom-left":g=
0}switch(D){case "bottom":case "bottom-right":case "bottom-left":f=1;break;case "top":case "top-right":case "top-left":f=0}var D=this.layers[0].getLayoutValue("text-justify",{zoom:this.zoom},u.properties),z="right"===D?1:"left"===D?0:.5,r=A.allowsVerticalWritingMode(u.text),k=this.layers[0].getLayoutValue("text-offset",{zoom:this.zoom},u.properties).map(function(b){return 24*b}),D=24*this.layers[0].getLayoutValue("text-letter-spacing",{zoom:this.zoom},u.properties),t=A.allowsLetterSpacing(u.text)?
D:0,D={};D[I.horizontal]=B(u.text,a[l],h,e,g,f,z,t,k,24,I.horizontal);D[I.vertical]=r&&m&&B(u.text,a[l],h,e,g,f,z,t,k,24,I.vertical)}else D={};z=void 0;u.icon&&(r=c[u.icon])&&((z=K(r,this.layers[0].getLayoutValue("icon-offset",{zoom:this.zoom},u.properties)),void 0===this.sdfIcons?this.sdfIcons=r.sdf:this.sdfIcons!==r.sdf&&w.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),r.isNativePixelRatio)?0===d["icon-rotate"]&&this.layers[0].isLayoutValueFeatureConstant("icon-rotate")||
(this.iconsNeedLinear=!0):this.iconsNeedLinear=!0);(D[I.horizontal]||z)&&this.addFeature(u,D,z)}};O.prototype.addFeature=function(a,c,d){var f=this,e=this.layers[0].getLayoutValue("text-size",{zoom:this.zoom+1},a.properties),h=this.layers[0].getLayoutValue("icon-size",{zoom:this.zoom+1},a.properties),l=this.layers[0].getLayoutValue("text-offset",{zoom:this.zoom},a.properties),m=this.layers[0].getLayoutValue("icon-offset",{zoom:this.zoom},a.properties),n=this.layers[0].getLayoutValue("text-size",{zoom:18},
a.properties);void 0===n&&(n=e);var q=this.layers[0].layout,D=e/24*this.tilePixelRatio,e=this.tilePixelRatio*n/24,z=this.tilePixelRatio*h,n=this.tilePixelRatio*q["symbol-spacing"],r=q["symbol-avoid-edges"],k=q["text-padding"]*this.tilePixelRatio,t=q["icon-padding"]*this.tilePixelRatio,p=q["text-max-angle"]/180*Math.PI,x="map"===q["text-rotation-alignment"]&&"line"===q["symbol-placement"],v="map"===q["icon-rotation-alignment"]&&"line"===q["symbol-placement"],y=q["text-allow-overlap"]||q["icon-allow-overlap"]||
q["text-ignore-placement"]||q["icon-ignore-placement"],w=n/2,h=function(g,e){var h=!(0>e.x||e.x>b||0>e.y||e.y>b);r&&!h||f.addSymbolInstance(e,g,c,d,f.layers[0],h||y,f.collisionBoxArray,a.index,a.sourceLayerIndex,f.index,D,k,x,l,z,t,v,m,{zoom:f.zoom},a.properties)};if("line"===q["symbol-placement"])for(var q=0,A=C(a.geometry,0,0,b,b);q<A.length;q+=1)for(var E=A[q],B=0,H=u(E,n,p,c[I.vertical]||c[I.horizontal],d,24,e,f.overscaling,b);B<H.length;B+=1){var K=H[B],L=c[I.horizontal];L&&f.anchorIsTooClose(L.text,
w,K)||h(E,K)}else if("Polygon"===a.type)for(e=0,n=G(a.geometry,0);e<n.length;e+=1)p=n[e],w=F(p,16),h(p[0],new g(w.x,w.y,0));else if("LineString"===a.type)for(e=0,n=a.geometry;e<n.length;e+=1)p=n[e],h(p,new g(p[0].x,p[0].y,0));else if("Point"===a.type)for(e=0,n=a.geometry;e<n.length;e+=1)for(p=0,w=n[e];p<w.length;p+=1)q=w[p],h([q],new g(q.x,q.y,0))};O.prototype.anchorIsTooClose=function(b,a,c){var d=this.compareText;if(b in d)for(var g=d[b],f=g.length-1;0<=f;f--){if(c.dist(g[f])<a)return!0}else d[b]=
[];d[b].push(c);return!1};O.prototype.place=function(b,a){this.createArrays();this.placedGlyphArray=new L;this.placedIconArray=new L;this.glyphOffsetArray=new N;this.lineVertexArray=new Q;var d=this.layers[0],g=d.layout,f=b.maxScale,e="map"===g["text-rotation-alignment"]&&"line"===g["symbol-placement"],h="map"===g["icon-rotation-alignment"]&&"line"===g["symbol-placement"];if(g["text-allow-overlap"]||g["icon-allow-overlap"]||g["text-ignore-placement"]||g["icon-ignore-placement"]){var l=b.angle,m=Math.sin(l),
n=Math.cos(l);this.symbolInstances.sort(function(b,a){return(m*b.anchor.x+n*b.anchor.y|0)-(m*a.anchor.x+n*a.anchor.y|0)||a.featureIndex-b.featureIndex})}for(var l=0,q=this.symbolInstances;l<q.length;l+=1){var u=q[l],D={boxStartIndex:u.textBoxStartIndex,boxEndIndex:u.textBoxEndIndex},z={boxStartIndex:u.iconBoxStartIndex,boxEndIndex:u.iconBoxEndIndex},r=u.textBoxStartIndex!==u.textBoxEndIndex,k=u.iconBoxStartIndex!==u.iconBoxEndIndex,t=g["text-optional"]||!r,p=g["icon-optional"]||!k,x=r?b.placeCollisionFeature(D,
g["text-allow-overlap"],g["symbol-avoid-edges"]):b.minScale,v=k?b.placeCollisionFeature(z,g["icon-allow-overlap"],g["symbol-avoid-edges"]):b.minScale;t||p?!p&&x?x=Math.max(v,x):!t&&v&&(v=Math.max(v,x)):v=x=Math.max(v,x);if(r||k){for(var p=u.line,t=this.lineVertexArray.length,y=0;y<p.length;y++)this.lineVertexArray.emplaceBack(p[y].x,p[y].y);p=this.lineVertexArray.length-t;r&&(b.insertCollisionFeature(D,x,g["text-ignore-placement"]),x<=f&&(D=c(d,this.zoom,this.textSizeData.coveringZoomRange,"text-size",
u.featureProperties),this.addSymbols(this.arrays.glyph,u.glyphQuads,x,D,g["text-keep-upright"],u.textOffset,e,b.angle,u.featureProperties,u.writingModes,u.anchor,t,p,this.placedGlyphArray)));k&&(b.insertCollisionFeature(z,v,g["icon-ignore-placement"]),v<=f&&(z=c(d,this.zoom,this.iconSizeData.coveringZoomRange,"icon-size",u.featureProperties),this.addSymbols(this.arrays.icon,u.iconQuads,v,z,g["icon-keep-upright"],u.iconOffset,h,b.angle,u.featureProperties,null,u.anchor,t,p,this.placedIconArray)))}}a&&
this.addToDebugBuffers(b)};O.prototype.addSymbols=function(b,a,c,g,f,h,l,m,n,q,u,D,z,r){var k=b.elementArray,t=b.layoutVertexArray,p=b.dynamicLayoutVertexArray;c=Math.max(Math.log(c)/Math.LN2+this.zoom,0);var x=this.glyphOffsetArray.length;m=(u.angle+m+2*Math.PI)%(2*Math.PI);m=m>1*Math.PI/4&&m<=3*Math.PI/4||m>5*Math.PI/4&&m<=7*Math.PI/4;q=!!(q&I.vertical)&&m;for(m=0;m<a.length;m+=1){var v=a[m];if(!l||!f||v.writingMode===I.vertical===q){var y=v.tl,C=v.tr,w=v.bl,A=v.br,F=v.tex,E=b.prepareSegment(4),
B=E.vertexLength,G=v.glyphOffset[1];e(t,u.x,u.y,y.x,G+y.y,F.x,F.y,g);e(t,u.x,u.y,C.x,G+C.y,F.x+F.w,F.y,g);e(t,u.x,u.y,w.x,G+w.y,F.x,F.y+F.h,g);e(t,u.x,u.y,A.x,G+A.y,F.x+F.w,F.y+F.h,g);d(p,u,0,c);k.emplaceBack(B,B+1,B+2);k.emplaceBack(B+1,B+2,B+3);E.vertexLength+=4;E.primitiveLength+=2;this.glyphOffsetArray.emplaceBack(v.glyphOffset[0])}}r.emplaceBack(u.x,u.y,x,this.glyphOffsetArray.length-x,D,z,u.segment,g?g[0]:0,g?g[1]:0,h[0],h[1],c,q);b.populatePaintArrays(n)};O.prototype.addToDebugBuffers=function(b){for(var a=
this.arrays.collisionBox,c=a.layoutVertexArray,d=a.elementArray,g=-b.angle,f=b.yStretch,e=0,h=this.symbolInstances;e<h.length;e+=1){var m=h[e];m.textCollisionFeature={boxStartIndex:m.textBoxStartIndex,boxEndIndex:m.textBoxEndIndex};m.iconCollisionFeature={boxStartIndex:m.iconBoxStartIndex,boxEndIndex:m.iconBoxEndIndex};for(var q=0;2>q;q++){var u=m[0===q?"textCollisionFeature":"iconCollisionFeature"];if(u)for(var D=u.boxStartIndex;D<u.boxEndIndex;D++){var z=this.collisionBoxArray.get(D);if(!(1===b.perspectiveRatio&&
1>z.maxScale)){var r=z.anchorPoint,k=(new l(z.x1,z.y1*f))._rotate(g),t=(new l(z.x2,z.y1*f))._rotate(g),p=(new l(z.x1,z.y2*f))._rotate(g),x=(new l(z.x2,z.y2*f))._rotate(g),v=Math.max(0,Math.min(25,this.zoom+Math.log(z.maxScale)/Math.LN2)),z=Math.max(0,Math.min(25,this.zoom+Math.log(z.placementScale)/Math.LN2)),y=a.prepareSegment(4),C=y.vertexLength;n(c,r,m.anchor,k,v,z);n(c,r,m.anchor,t,v,z);n(c,r,m.anchor,x,v,z);n(c,r,m.anchor,p,v,z);d.emplaceBack(C,C+1);d.emplaceBack(C+1,C+2);d.emplaceBack(C+2,C+
3);d.emplaceBack(C+3,C);y.vertexLength+=4;y.primitiveLength+=4}}}}};O.prototype.addSymbolInstance=function(b,a,c,d,g,f,e,h,l,m,n,q,u,D,z,r,k,t,p,v){var y,C,A=[],F=[],B;for(B in c){var G=parseInt(B,10);c[G]&&(F=F.concat(f?E(b,c[G],g,u,p,v):[]),y=new x(e,a,b,h,l,m,c[G],n,q,u,!1))}n=y?y.boxStartIndex:this.collisionBoxArray.length;y=y?y.boxEndIndex:this.collisionBoxArray.length;d&&(A=f?H(b,d,g,k,c[I.horizontal],p,v):[],C=new x(e,a,b,h,l,m,d,z,r,k,!0));d=C?C.boxStartIndex:this.collisionBoxArray.length;
C=C?C.boxEndIndex:this.collisionBoxArray.length;y>O.MAX_INSTANCES&&w.warnOnce("Too many symbols being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");C>O.MAX_INSTANCES&&w.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");this.symbolInstances.push({textBoxStartIndex:n,textBoxEndIndex:y,iconBoxStartIndex:d,iconBoxEndIndex:C,glyphQuads:F,iconQuads:A,textOffset:D,iconOffset:t,anchor:b,line:a,featureIndex:h,featureProperties:v,
writingModes:(c[I.vertical]?I.vertical:0)|(c[I.horizontal]?I.horizontal:0)})};O.programInterfaces=R;O.MAX_INSTANCES=65535;O.addDynamicAttributes=d;p.exports=O},{"../../shaders/encode_attribute":111,"../../symbol/anchor":183,"../../symbol/clip_line":185,"../../symbol/collision_feature":187,"../../symbol/get_anchors":189,"../../symbol/mergelines":192,"../../symbol/quads":194,"../../symbol/shaping":195,"../../symbol/transform_text":198,"../../util/classify_rings":223,"../../util/find_pole_of_inaccessibility":229,
"../../util/script_detection":236,"../../util/struct_array":238,"../../util/token":240,"../../util/util":241,"../array_group":74,"../buffer_group":82,"../element_array_type":83,"../extent":84,"../load_geometry":86,"point-geometry":56,"vector-tile":64}],81:[function(a,p,k){var e={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},d=function(a,d,c,e){this.arrayBuffer=a.arrayBuffer;this.length=a.length;this.attributes=d.members;
this.itemSize=d.bytesPerElement;this.type=c;this.arrayType=d;this.dynamicDraw=e};d.fromStructArray=function(a,e){return new d(a.serialize(),a.constructor.serialize(),e)};d.prototype.bind=function(a){var d=a[this.type];this.buffer?(a.bindBuffer(d,this.buffer),this.dynamicDraw&&this.arrayBuffer&&(a.bufferSubData(d,0,this.arrayBuffer),this.arrayBuffer=null)):(this.gl=a,this.buffer=a.createBuffer(),a.bindBuffer(d,this.buffer),a.bufferData(d,this.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),
this.arrayBuffer=null)};d.prototype.updateData=function(a){this.arrayBuffer=a.arrayBuffer};d.prototype.enableAttributes=function(a,d){for(var c=0;c<this.attributes.length;c++){var e=d[this.attributes[c].name];void 0!==e&&a.enableVertexAttribArray(e)}};d.prototype.setVertexAttribPointers=function(a,d,c){for(var l=0;l<this.attributes.length;l++){var m=this.attributes[l],h=d[m.name];void 0!==h&&a.vertexAttribPointer(h,m.components,a[e[m.type]],!1,this.arrayType.bytesPerElement,m.offset+(this.arrayType.bytesPerElement*
c||0))}};d.prototype.destroy=function(){this.buffer&&this.gl.deleteBuffer(this.buffer)};d.BufferType={VERTEX:"ARRAY_BUFFER",ELEMENT:"ELEMENT_ARRAY_BUFFER"};p.exports=d},{}],82:[function(a,p,k){var e=a("../util/util"),d=a("./buffer"),n=a("./program_configuration"),q=a("./vertex_array_type"),c=a("../render/vertex_array_object");a=function(a,m,h,b){var f=q(a.layoutAttributes);this.layoutVertexBuffer=new d(b.layoutVertexArray,f.serialize(),d.BufferType.VERTEX);b.dynamicLayoutVertexArray&&a.dynamicLayoutAttributes&&
(f=q(a.dynamicLayoutAttributes),this.dynamicLayoutVertexArray=new f(b.dynamicLayoutVertexArray),this.dynamicLayoutVertexBuffer=new d(b.dynamicLayoutVertexArray,f.serialize(),d.BufferType.VERTEX,!0));b.elementArray&&a.elementArrayType&&(this.elementBuffer=new d(b.elementArray,a.elementArrayType.serialize(),d.BufferType.ELEMENT));b.elementArray2&&a.elementArrayType2&&(this.elementBuffer2=new d(b.elementArray2,a.elementArrayType2.serialize(),d.BufferType.ELEMENT));this.layerData={};for(f=0;f<m.length;f+=
1){var g=m[f],l=b.paintVertexArrays&&b.paintVertexArrays[g.id],D=n.createDynamic(a,g,h),l=l?new d(l.array,l.type,d.BufferType.VERTEX):null;this.layerData[g.id]={programConfiguration:D,paintVertexBuffer:l}}this.segments=b.segments;this.segments2=b.segments2;a=0;for(m=[this.segments,this.segments2];a<m.length;a+=1)for(h=0,b=m[a]||[];h<b.length;h+=1)b[h].vaos=e.mapObject(this.layerData,function(){return new c})};a.prototype.destroy=function(){this.layoutVertexBuffer.destroy();this.dynamicLayoutVertexBuffer&&
this.dynamicLayoutVertexBuffer.destroy();this.elementBuffer&&this.elementBuffer.destroy();this.elementBuffer2&&this.elementBuffer2.destroy();for(var a in this.layerData){var c=this.layerData[a].paintVertexBuffer;c&&c.destroy()}a=0;for(c=[this.segments,this.segments2];a<c.length;a+=1)for(var d=0,b=c[a]||[];d<b.length;d+=1){var f=b[d],g;for(g in f.vaos)f.vaos[g].destroy()}};p.exports=a},{"../render/vertex_array_object":110,"../util/util":241,"./buffer":81,"./program_configuration":88,"./vertex_array_type":90}],
83:[function(a,p,k){var e=a("../util/struct_array");p.exports=function(a){return e({members:[{type:"Uint16",name:"vertices",components:a||3}]})}},{"../util/struct_array":238}],84:[function(a,p,k){p.exports=8192},{}],85:[function(a,p,k){function e(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1])}function d(b,a){return a-b}function n(b,a){return 0<a?a+2*b:b}function q(b,a,c,d,g){if(!a[0]&&!a[1])return b;a=l.convert(a);"viewport"===c&&a._rotate(-d);c=[];for(d=0;d<b.length;d++){for(var f=b[d],e=[],h=0;h<f.length;h++)e.push(f[h].sub(a._mult(g)));
c.push(e)}return c}var c=a("assert"),l=a("point-geometry"),m=a("./load_geometry"),h=a("./extent"),b=a("../style-spec/feature_filter");k=a("../util/struct_array");var f=a("grid-index"),g=a("../util/dictionary_coder"),u=a("vector-tile"),D=a("pbf"),z=a("../util/vectortile_to_geojson"),t=a("../util/util").arraysIntersect;a=a("../util/intersection_tests");var r=a.multiPolygonIntersectsBufferedMultiPoint,v=a.multiPolygonIntersectsMultiPolygon,C=a.multiPolygonIntersectsBufferedMultiLine,w=k({members:[{type:"Uint32",
name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]}),A=function(b,a,c,d){this.coord=b;this.overscaling=a;this.x=b.x;this.y=b.y;this.z=b.z-Math.log(a)/Math.LN2;this.grid=c||new f(h,16,0);this.featureIndexArray=d||new w};A.deserialize=function(b,a,c){var d=new A(b.coord,b.overscaling,new f(b.grid),new w(b.featureIndexArray));d.rawTileData=a;d.bucketLayerIDs=b.bucketLayerIDs;d.paintPropertyStatistics=b.paintPropertyStatistics;d.setCollisionTile(c);return d};
A.prototype.insert=function(b,a,c,d){var g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,c,d);b=m(b);for(a=0;a<b.length;a++){c=b[a];d=[Infinity,Infinity,-Infinity,-Infinity];for(var f=0;f<c.length;f++){var e=c[f];d[0]=Math.min(d[0],e.x);d[1]=Math.min(d[1],e.y);d[2]=Math.max(d[2],e.x);d[3]=Math.max(d[3],e.y)}this.grid.insert(g,d[0],d[1],d[2],d[3])}};A.prototype.setCollisionTile=function(b){this.collisionTile=b};A.prototype.serialize=function(b){var a=this.grid.toArrayBuffer();
b&&b.push(a);return{coord:this.coord,overscaling:this.overscaling,grid:a,featureIndexArray:this.featureIndexArray.serialize(b),bucketLayerIDs:this.bucketLayerIDs,paintPropertyStatistics:this.paintPropertyStatistics}};A.prototype.query=function(a,c){this.vtLayers||(this.vtLayers=(new u.VectorTile(new D(this.rawTileData))).layers,this.sourceLayerCoder=new g(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]));var f={},m=a.params||{},q=h/a.tileSize/a.scale,z=b(m.filter),r=0,k;for(k in c)if(this.hasLayer(k)){var t=
c[k],p=0;if("line"===t.type)var p=n(this.getPaintValue("line-width",t),this.getPaintValue("line-gap-width",t)),v=this.getPaintValue("line-offset",t),t=this.getPaintValue("line-translate",t),p=p/2+Math.abs(v)+e(t);else"fill"===t.type?p=e(this.getPaintValue("fill-translate",t)):"fill-extrusion"===t.type?p=e(this.getPaintValue("fill-extrusion-translate",t)):"circle"===t.type&&(p=this.getPaintValue("circle-radius",t)+e(this.getPaintValue("circle-translate",t)));r=Math.max(r,p*q)}k=a.queryGeometry.map(function(b){return b.map(function(b){return new l(b.x,
b.y)})});for(var p=t=Infinity,x=v=-Infinity,C=0;C<k.length;C++)for(var y=k[C],w=0;w<y.length;w++)var A=y[w],t=Math.min(t,A.x),p=Math.min(p,A.y),v=Math.max(v,A.x),x=Math.max(x,A.y);r=this.grid.query(t-r,p-r,v+r,x+r);r.sort(d);this.filterMatching(f,r,this.featureIndexArray,k,z,m.layers,c,a.bearing,q);r=this.collisionTile.queryRenderedSymbols(k,a.scale);r.sort();this.filterMatching(f,r,this.collisionTile.collisionBoxArray,k,z,m.layers,c,a.bearing,q);return f};A.prototype.filterMatching=function(b,a,
c,d,g,f,e,h,u){for(var D,k=0;k<a.length;k++){var p=a[k];if(p!==D){D=p;var x=c.get(p),y=this.bucketLayerIDs[x.bucketIndex];if(!f||t(f,y)){var w=this.sourceLayerCoder.decode(x.sourceLayerIndex),x=this.vtLayers[w].feature(x.featureIndex);if(g(x))for(var A=null,w=0;w<y.length;w++){var F=y[w];if(!(f&&0>f.indexOf(F))){var E=e[F];if(E){var I;if("symbol"!==E.type)if(A||(A=m(x)),"line"===E.type){I=q(d,this.getPaintValue("line-translate",E,x),this.getPaintValue("line-translate-anchor",E,x),h,u);var B=u/2*n(this.getPaintValue("line-width",
E,x),this.getPaintValue("line-gap-width",E,x)),G=this.getPaintValue("line-offset",E,x);if(G){for(var G=G*u,K=[],J=new l(0,0),Z=0;Z<A.length;Z++){for(var X=A[Z],ba=[],W=0;W<X.length;W++){var U=X[W-1],aa=X[W],Y=X[W+1],U=0===W?J:aa.sub(U)._unit()._perp(),Y=W===X.length-1?J:Y.sub(aa)._unit()._perp(),U=U._add(Y)._unit();U._mult(1/(U.x*Y.x+U.y*Y.y));ba.push(U._mult(G)._add(aa))}K.push(ba)}A=K}if(!C(I,A,B))continue}else if("fill"===E.type||"fill-extrusion"===E.type){if(I=E.type,I=q(d,this.getPaintValue(I+
"-translate",E,x),this.getPaintValue(I+"-translate-anchor",E,x),h,u),!v(I,A))continue}else if("circle"===E.type&&(I=q(d,this.getPaintValue("circle-translate",E,x),this.getPaintValue("circle-translate-anchor",E,x),h,u),B=this.getPaintValue("circle-radius",E,x)*u,!r(I,A,B)))continue;I=new z(x,this.z,this.x,this.y);I.layer=E.serialize();E=b[F];void 0===E&&(E=b[F]=[]);E.push({featureIndex:p,feature:I})}}}}}}};A.prototype.hasLayer=function(b){for(var a=0,c=this.bucketLayerIDs;a<c.length;a+=1)for(var d=
0,g=c[a];d<g.length;d+=1)if(b===g[d])return!0;return!1};A.prototype.getPaintValue=function(b,a,d){if(a.isPaintValueFeatureConstant(b)||d)return a.getPaintValue(b,{zoom:this.z},d?d.properties:{});c(b in this.paintPropertyStatistics[a.id]);return this.paintPropertyStatistics[a.id][b].max};p.exports=A},{"../style-spec/feature_filter":138,"../util/dictionary_coder":225,"../util/intersection_tests":232,"../util/struct_array":238,"../util/util":241,"../util/vectortile_to_geojson":242,"./extent":84,"./load_geometry":86,
assert:9,"grid-index":23,pbf:55,"point-geometry":56,"vector-tile":64}],86:[function(a,p,k){function e(a){return{min:-1*Math.pow(2,a-1),max:Math.pow(2,a-1)-1}}var d=a("../util/util"),n=a("./extent"),q=a("assert"),c={15:e(15),16:e(16)};p.exports=function(a,e){var h=c[e||16];q(h);for(var b=n/a.extent,f=a.loadGeometry(),g=0;g<f.length;g++)for(var l=f[g],m=0;m<l.length;m++){var z=l[m];z.x=Math.round(z.x*b);z.y=Math.round(z.y*b);(z.x<h.min||z.x>h.max||z.y<h.min||z.y>h.max)&&d.warnOnce("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return f}},
{"../util/util":241,"./extent":84,assert:9}],87:[function(a,p,k){a=a("../util/struct_array")({members:[{name:"a_pos",type:"Int16",components:2}]});p.exports=a},{"../util/struct_array":238}],88:[function(a,p,k){function e(b){return[q(255*b[0],255*b[1]),q(255*b[2],255*b[3])]}var d=a("./vertex_array_type"),n=a("../style-spec/function").interpolationFactor,q=a("../shaders/encode_attribute").packUint8ToFloat,c=function(b,a,c,d){this.name=b;this.type=a;this.property=c;this.useIntegerZoom=d};c.prototype.defines=
function(){return["#define HAS_UNIFORM_u_"+this.name]};c.prototype.populatePaintArray=function(){};c.prototype.setUniforms=function(b,a,c,d){d=d.zoom;c=c.getPaintValue(this.property,{zoom:this.useIntegerZoom?Math.floor(d):d});"color"===this.type?b.uniform4fv(a["u_"+this.name],c):b.uniform1f(a["u_"+this.name],c)};var l=function(b,a,c){this.name=b;this.type=a;this.property=c};l.prototype.defines=function(){return[]};l.prototype.populatePaintArray=function(b,a,c,d,h,l){b=b.getPaintValue(this.property,
void 0,l);if("color"===this.type)for(c=e(b);d<h;d++)b=a.get(d),b["a_"+this.name+"0"]=c[0],b["a_"+this.name+"1"]=c[1];else{for(;d<h;d++)a.get(d)["a_"+this.name]=b;a=c[this.property];a.max=Math.max(a.max,b)}};l.prototype.setUniforms=function(b,a){b.uniform1f(a["a_"+this.name+"_t"],0)};var m=function(b,a,c,d,e){this.name=b;this.type=a;this.property=c;this.useIntegerZoom=d;this.zoom=e};m.prototype.defines=function(){return[]};m.prototype.populatePaintArray=function(b,a,c,d,h,l){var g=b.getPaintValue(this.property,
{zoom:this.zoom},l);b=b.getPaintValue(this.property,{zoom:this.zoom+1},l);if("color"===this.type)for(g=e(g),c=e(b);d<h;d++)b=a.get(d),b["a_"+this.name+"0"]=g[0],b["a_"+this.name+"1"]=g[1],b["a_"+this.name+"2"]=c[0],b["a_"+this.name+"3"]=c[1];else{for(;d<h;d++)l=a.get(d),l["a_"+this.name+"0"]=g,l["a_"+this.name+"1"]=b;a=c[this.property];a.max=Math.max(a.max,g,b)}};m.prototype.setUniforms=function(b,a,c,d){c=d.zoom;c=n(this.useIntegerZoom?Math.floor(c):c,1,this.zoom,this.zoom+1);b.uniform1f(a["a_"+
this.name+"_t"],c)};var h=function(){this.binders={};this.cacheKey=""};h.createDynamic=function(b,a,g){for(var f=new h,e=[],n=0,q=b.paintAttributes||[];n<q.length;n+=1){var r=q[n],k=r.property,p=r.useIntegerZoom||!1,r=r.name||k.replace(a.type+"-","").replace(/-/g,"_"),w=a._paintSpecifications[k].type;a.isPaintValueFeatureConstant(k)?(f.binders[r]=new c(r,w,k,p),f.cacheKey+="/u_"+r):a.isPaintValueZoomConstant(k)?(f.binders[r]=new l(r,w,k),f.cacheKey+="/a_"+r,e.push({name:"a_"+r,type:"Float32",components:"color"===
w?2:1})):(f.binders[r]=new m(r,w,k,p,g),f.cacheKey+="/z_"+r,e.push({name:"a_"+r,type:"Float32",components:"color"===w?4:2}))}f.PaintVertexArray=d(e);f["interface"]=b;return f};h.createBasicFill=function(){var b=new h;b.binders.color=new c("color","color","fill-color",!1);b.cacheKey+="/u_color";b.binders.opacity=new c("opacity","number","fill-opacity",!1);b.cacheKey+="/u_opacity";return b};h.prototype.createPaintPropertyStatistics=function(){var b={},a;for(a in this.binders)b[this.binders[a].property]=
{max:-Infinity};return b};h.prototype.populatePaintArray=function(b,a,c,d,e){var g=a.length;a.resize(d);for(var f in this.binders)this.binders[f].populatePaintArray(b,a,c,g,d,e)};h.prototype.defines=function(){var b=[],a;for(a in this.binders)b.push.apply(b,this.binders[a].defines());return b};h.prototype.setUniforms=function(b,a,c,d){for(var g in this.binders)this.binders[g].setUniforms(b,a,c,d)};p.exports=h},{"../shaders/encode_attribute":111,"../style-spec/function":140,"./vertex_array_type":90}],
89:[function(a,p,k){a=a("../util/struct_array")({members:[{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]});p.exports=a},{"../util/struct_array":238}],90:[function(a,p,k){var e=a("../util/struct_array");p.exports=function(a){return e({members:a,alignment:4})}},{"../util/struct_array":238}],91:[function(a,p,k){var e=function(a,e,q){this.column=a;this.row=e;this.zoom=q};e.prototype.clone=function(){return new e(this.column,this.row,this.zoom)};e.prototype.zoomTo=
function(a){return this.clone()._zoomTo(a)};e.prototype.sub=function(a){return this.clone()._sub(a)};e.prototype._zoomTo=function(a){var d=Math.pow(2,a-this.zoom);this.column*=d;this.row*=d;this.zoom=a;return this};e.prototype._sub=function(a){a=a.zoomTo(this.zoom);this.column-=a.column;this.row-=a.row;return this};p.exports=e},{}],92:[function(a,p,k){var e=a("../util/util").wrap,d=function(a,d){if(isNaN(a)||isNaN(d))throw Error("Invalid LngLat object: ("+a+", "+d+")");this.lng=+a;this.lat=+d;if(90<
this.lat||-90>this.lat)throw Error("Invalid LngLat latitude value: must be between -90 and 90");};d.prototype.wrap=function(){return new d(e(this.lng,-180,180),this.lat)};d.prototype.toArray=function(){return[this.lng,this.lat]};d.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"};d.prototype.toBounds=function(e){e=360*e/40075017;var n=e/Math.cos(Math.PI/180*this.lat);return new (a("./lng_lat_bounds"))(new d(this.lng-n,this.lat-e),new d(this.lng+n,this.lat+e))};d.convert=function(a){if(a instanceof
d)return a;if(Array.isArray(a)&&2===a.length)return new d(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&"object"===typeof a&&null!==a)return new d(Number(a.lng),Number(a.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]");};p.exports=d},{"../util/util":241,"./lng_lat_bounds":93}],93:[function(a,p,k){var e=a("./lng_lat"),d=function(a,d){a&&(d?this.setSouthWest(a).setNorthEast(d):4===a.length?this.setSouthWest([a[0],
a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))};d.prototype.setNorthEast=function(a){this._ne=a instanceof e?new e(a.lng,a.lat):e.convert(a);return this};d.prototype.setSouthWest=function(a){this._sw=a instanceof e?new e(a.lng,a.lat):e.convert(a);return this};d.prototype.extend=function(a){var n=this._sw,c=this._ne,l;if(a instanceof e)l=a;else if(a instanceof d){if(l=a._sw,a=a._ne,!l||!a)return this}else return Array.isArray(a)?a.every(Array.isArray)?this.extend(d.convert(a)):
this.extend(e.convert(a)):this;n||c?(n.lng=Math.min(l.lng,n.lng),n.lat=Math.min(l.lat,n.lat),c.lng=Math.max(a.lng,c.lng),c.lat=Math.max(a.lat,c.lat)):(this._sw=new e(l.lng,l.lat),this._ne=new e(a.lng,a.lat));return this};d.prototype.getCenter=function(){return new e((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)};d.prototype.getSouthWest=function(){return this._sw};d.prototype.getNorthEast=function(){return this._ne};d.prototype.getNorthWest=function(){return new e(this.getWest(),this.getNorth())};
d.prototype.getSouthEast=function(){return new e(this.getEast(),this.getSouth())};d.prototype.getWest=function(){return this._sw.lng};d.prototype.getSouth=function(){return this._sw.lat};d.prototype.getEast=function(){return this._ne.lng};d.prototype.getNorth=function(){return this._ne.lat};d.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]};d.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"};d.convert=function(a){return!a||
a instanceof d?a:new d(a)};p.exports=d},{"./lng_lat":92}],94:[function(a,p,k){var e=a("./lng_lat"),d=a("point-geometry"),n=a("./coordinate"),q=a("../util/util"),c=a("../style-spec/util/interpolate"),l=a("../source/tile_coord"),m=a("../data/extent");a=a("@mapbox/gl-matrix");var h=a.vec4,b=a.mat4,f=a.mat2;a=function(b,a,c){this.tileSize=512;this._renderWorldCopies=void 0===c?!0:c;this._minZoom=b||0;this._maxZoom=a||22;this.latRange=[-85.05113,85.05113];this.height=this.width=0;this._center=new e(0,
0);this.angle=this.zoom=0;this._fov=.6435011087932844;this._pitch=0;this._unmodified=!0};k={minZoom:{},maxZoom:{},renderWorldCopies:{},worldSize:{},centerPoint:{},size:{},bearing:{},pitch:{},fov:{},zoom:{},center:{},unmodified:{},x:{},y:{},point:{}};k.minZoom.get=function(){return this._minZoom};k.minZoom.set=function(b){this._minZoom!==b&&(this._minZoom=b,this.zoom=Math.max(this.zoom,b))};k.maxZoom.get=function(){return this._maxZoom};k.maxZoom.set=function(b){this._maxZoom!==b&&(this._maxZoom=b,
this.zoom=Math.min(this.zoom,b))};k.renderWorldCopies.get=function(){return this._renderWorldCopies};k.worldSize.get=function(){return this.tileSize*this.scale};k.centerPoint.get=function(){return this.size._div(2)};k.size.get=function(){return new d(this.width,this.height)};k.bearing.get=function(){return-this.angle/Math.PI*180};k.bearing.set=function(b){b=-q.wrap(b,-180,180)*Math.PI/180;this.angle!==b&&(this._unmodified=!1,this.angle=b,this._calcMatrices(),this.rotationMatrix=f.create(),f.rotate(this.rotationMatrix,
this.rotationMatrix,this.angle))};k.pitch.get=function(){return this._pitch/Math.PI*180};k.pitch.set=function(b){b=q.clamp(b,0,60)/180*Math.PI;this._pitch!==b&&(this._unmodified=!1,this._pitch=b,this._calcMatrices())};k.fov.get=function(){return this._fov/Math.PI*180};k.fov.set=function(b){b=Math.max(.01,Math.min(60,b));this._fov!==b&&(this._unmodified=!1,this._fov=b/180*Math.PI,this._calcMatrices())};k.zoom.get=function(){return this._zoom};k.zoom.set=function(b){b=Math.min(Math.max(b,this.minZoom),
this.maxZoom);this._zoom!==b&&(this._unmodified=!1,this._zoom=b,this.scale=this.zoomScale(b),this.tileZoom=Math.floor(b),this.zoomFraction=b-this.tileZoom,this._constrain(),this._calcMatrices())};k.center.get=function(){return this._center};k.center.set=function(b){if(b.lat!==this._center.lat||b.lng!==this._center.lng)this._unmodified=!1,this._center=b,this._constrain(),this._calcMatrices()};a.prototype.coveringZoomLevel=function(b){return(b.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/
b.tileSize))};a.prototype.getVisibleWrappedCoordinates=function(b){for(var a=this.pointCoordinate(new d(0,0),0),c=this.pointCoordinate(new d(this.width,0),0),c=Math.floor(c.column),g=[b],a=Math.floor(a.column);a<=c;a++)0!==a&&g.push(new l(b.z,b.x,b.y,a));return g};a.prototype.coveringTiles=function(b){var a=this.coveringZoomLevel(b),c=a;if(a<b.minzoom)return[];a>b.maxzoom&&(a=b.maxzoom);var g=this.pointCoordinate(this.centerPoint,a),e=new d(g.column-.5,g.row-.5),g=[this.pointCoordinate(new d(0,0),
a),this.pointCoordinate(new d(this.width,0),a),this.pointCoordinate(new d(this.width,this.height),a),this.pointCoordinate(new d(0,this.height),a)];return l.cover(a,g,b.reparseOverscaled?c:a,this._renderWorldCopies).sort(function(b,a){return e.dist(b)-e.dist(a)})};a.prototype.resize=function(b,a){this.width=b;this.height=a;this.pixelsToGLUnits=[2/b,-2/a];this._constrain();this._calcMatrices()};k.unmodified.get=function(){return this._unmodified};a.prototype.zoomScale=function(b){return Math.pow(2,
b)};a.prototype.scaleZoom=function(b){return Math.log(b)/Math.LN2};a.prototype.project=function(b){return new d(this.lngX(b.lng),this.latY(b.lat))};a.prototype.unproject=function(b){return new e(this.xLng(b.x),this.yLat(b.y))};k.x.get=function(){return this.lngX(this.center.lng)};k.y.get=function(){return this.latY(this.center.lat)};k.point.get=function(){return new d(this.x,this.y)};a.prototype.lngX=function(b){return(180+b)*this.worldSize/360};a.prototype.latY=function(b){return(180-180/Math.PI*
Math.log(Math.tan(Math.PI/4+b*Math.PI/360)))*this.worldSize/360};a.prototype.xLng=function(b){return 360*b/this.worldSize-180};a.prototype.yLat=function(b){return 360/Math.PI*Math.atan(Math.exp((180-360*b/this.worldSize)*Math.PI/180))-90};a.prototype.setLocationAtPoint=function(b,a){var c=this.pointCoordinate(a)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(b)._sub(c));this._renderWorldCopies&&(this.center=this.center.wrap())};a.prototype.locationPoint=
function(b){return this.coordinatePoint(this.locationCoordinate(b))};a.prototype.pointLocation=function(b){return this.coordinateLocation(this.pointCoordinate(b))};a.prototype.locationCoordinate=function(b){return(new n(this.lngX(b.lng)/this.tileSize,this.latY(b.lat)/this.tileSize,this.zoom)).zoomTo(this.tileZoom)};a.prototype.coordinateLocation=function(b){b=b.zoomTo(this.zoom);return new e(this.xLng(b.column*this.tileSize),this.yLat(b.row*this.tileSize))};a.prototype.pointCoordinate=function(b,
a){void 0===a&&(a=this.tileZoom);var d=[b.x,b.y,0,1],e=[b.x,b.y,1,1];h.transformMat4(d,d,this.pixelMatrixInverse);h.transformMat4(e,e,this.pixelMatrixInverse);var f=d[3],g=e[3],l=d[1]/f,m=e[1]/g,q=d[2]/f,u=e[2]/g,q=q===u?0:(0-q)/(u-q);return(new n(c(d[0]/f,e[0]/g,q)/this.tileSize,c(l,m,q)/this.tileSize,this.zoom))._zoomTo(a)};a.prototype.coordinatePoint=function(b){b=b.zoomTo(this.zoom);b=[b.column*this.tileSize,b.row*this.tileSize,0,1];h.transformMat4(b,b,this.pixelMatrix);return new d(b[0]/b[3],
b[1]/b[3])};a.prototype.calculatePosMatrix=function(a,c){var d=a.toCoordinate(c),e=this.worldSize/this.zoomScale(d.zoom),f=b.identity(new Float64Array(16));b.translate(f,f,[d.column*e,d.row*e,0]);b.scale(f,f,[e/m,e/m,1]);b.multiply(f,this.projMatrix,f);return new Float32Array(f)};a.prototype.cameraToTileDistance=function(b){var a=this.calculatePosMatrix(b.coord,b.sourceMaxZoom);b=[b.tileSize/2,b.tileSize/2,0,1];h.transformMat4(b,b,a);return b[3]};a.prototype._constrain=function(){if(this.center&&
this.width&&this.height&&!this._constraining){this._constraining=!0;var b=-90,a=90,c=-180,e=180,f,h,l,m,n=this.size,q=this._unmodified;this.latRange&&(a=this.latRange,b=this.latY(a[1]),a=this.latY(a[0]),f=a-b<n.y?n.y/(a-b):0);this.lngRange&&(e=this.lngRange,c=this.lngX(e[0]),e=this.lngX(e[1]),h=e-c<n.x?n.x/(e-c):0);var k=Math.max(h||0,f||0);if(k)this.center=this.unproject(new d(h?(e+c)/2:this.x,f?(a+b)/2:this.y)),this.zoom+=this.scaleZoom(k);else if(this.latRange&&(f=this.y,h=n.y/2,f-h<b&&(m=b+h),
f+h>a&&(m=a-h)),this.lngRange&&(b=this.x,n=n.x/2,b-n<c&&(l=c+n),b+n>e&&(l=e-n)),void 0!==l||void 0!==m)this.center=this.unproject(new d(void 0!==l?l:this.x,void 0!==m?m:this.y));this._unmodified=q;this._constraining=!1}};a.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=this._fov/2,a=1.01*(Math.sin(a)*this.cameraToCenterDistance/Math.sin(Math.PI-(Math.PI/2+this._pitch)-a)*Math.cos(Math.PI/2-this._pitch)+this.cameraToCenterDistance),
c=new Float64Array(16);b.perspective(c,this._fov,this.width/this.height,1,a);b.scale(c,c,[1,-1,1]);b.translate(c,c,[0,0,-this.cameraToCenterDistance]);b.rotateX(c,c,this._pitch);b.rotateZ(c,c,this.angle);b.translate(c,c,[-this.x,-this.y,0]);b.scale(c,c,[1,1,this.worldSize/(12756274*Math.PI*Math.abs(Math.cos(Math.PI/180*this.center.lat))),1]);this.projMatrix=c;c=b.create();b.scale(c,c,[this.width/2,-this.height/2,1]);b.translate(c,c,[1,-1,0]);this.pixelMatrix=b.multiply(new Float64Array(16),c,this.projMatrix);
c=b.invert(new Float64Array(16),this.pixelMatrix);if(!c)throw Error("failed to invert matrix");this.pixelMatrixInverse=c}};Object.defineProperties(a.prototype,k);p.exports=a},{"../data/extent":84,"../source/tile_coord":127,"../style-spec/util/interpolate":146,"../util/util":241,"./coordinate":91,"./lng_lat":92,"@mapbox/gl-matrix":1,"point-geometry":56}],95:[function(a,p,k){k=a("mapbox-gl-supported");var e=a("./util/browser"),d=a("../package.json").version,n=a("./ui/map"),q=a("./ui/control/navigation_control"),
c=a("./ui/control/geolocate_control"),l=a("./ui/control/attribution_control"),m=a("./ui/control/scale_control"),h=a("./ui/control/fullscreen_control"),b=a("./ui/popup"),f=a("./ui/marker"),g=a("./style/style"),u=a("./geo/lng_lat"),D=a("./geo/lng_lat_bounds"),z=a("point-geometry"),t=a("./util/evented"),r=a("./util/config");a=a("./source/rtl_text_plugin");p.exports={version:d,supported:k,workerCount:Math.max(Math.floor(e.hardwareConcurrency/2),1),setRTLTextPlugin:a.setRTLTextPlugin,Map:n,NavigationControl:q,
GeolocateControl:c,AttributionControl:l,ScaleControl:m,FullscreenControl:h,Popup:b,Marker:f,Style:g,LngLat:u,LngLatBounds:D,Point:z,Evented:t,config:r,get accessToken(){return r.ACCESS_TOKEN},set accessToken(b){r.ACCESS_TOKEN=b}}},{"../package.json":73,"./geo/lng_lat":92,"./geo/lng_lat_bounds":93,"./source/rtl_text_plugin":122,"./style/style":172,"./ui/control/attribution_control":201,"./ui/control/fullscreen_control":202,"./ui/control/geolocate_control":203,"./ui/control/navigation_control":205,
"./ui/control/scale_control":206,"./ui/map":215,"./ui/marker":216,"./ui/popup":217,"./util/browser":220,"./util/config":224,"./util/evented":228,"mapbox-gl-supported":37,"point-geometry":56}],96:[function(a,p,k){var e=a("./pattern");p.exports=function(a,n,q){n=a.gl;var c=a.transform,d=c.tileSize,m=q.paint["background-color"],h=q.paint["background-pattern"],b=q.paint["background-opacity"];if(a.isOpaquePass===(!h&&1===m[3]&&1===b)){n.disable(n.STENCIL_TEST);a.setDepthSublayer(0);if(h){if(e.isPatternMissing(h,
a))return;q=a.useProgram("fillPattern",a.basicFillProgramConfiguration);e.prepare(h,a,q);a.tileExtentPatternVAO.bind(n,q,a.tileExtentBuffer)}else q=a.useProgram("fill",a.basicFillProgramConfiguration),n.uniform4fv(q.u_color,m),a.tileExtentVAO.bind(n,q,a.tileExtentBuffer);n.uniform1f(q.u_opacity,b);m=0;for(c=c.coveringTiles({tileSize:d});m<c.length;m+=1)b=c[m],h&&e.setTile({coord:b,tileSize:d},a,q),n.uniformMatrix4fv(q.u_matrix,!1,a.transform.calculatePosMatrix(b)),n.drawArrays(n.TRIANGLE_STRIP,0,
a.tileExtentBuffer.length)}}},{"./pattern":109}],97:[function(a,p,k){var e=a("../util/browser"),d=a("../source/pixels_to_tile_units");p.exports=function(a,q,c,l){if(!a.isOpaquePass){var m=a.gl;a.setDepthSublayer(0);a.depthMask(!1);m.disable(m.STENCIL_TEST);for(var h=0;h<l.length;h++){var b=l[h],f=q.getTile(b),g=f.getBucket(c);if(g){var g=g.buffers,n=g.layerData[c.id],D=n.programConfiguration,k=a.useProgram("circle",D);D.setUniforms(m,k,c,{zoom:a.transform.zoom});m.uniform1f(k.u_camera_to_center_distance,
a.transform.cameraToCenterDistance);m.uniform1i(k.u_scale_with_map,"map"===c.paint["circle-pitch-scale"]);"map"===c.paint["circle-pitch-alignment"]?(m.uniform1i(k.u_pitch_with_map,!0),D=d(f,1,a.transform.zoom),m.uniform2f(k.u_extrude_scale,D,D)):(m.uniform1i(k.u_pitch_with_map,!1),m.uniform2fv(k.u_extrude_scale,a.transform.pixelsToGLUnits));m.uniform1f(k.u_devicepixelratio,e.devicePixelRatio);m.uniformMatrix4fv(k.u_matrix,!1,a.translatePosMatrix(b.posMatrix,f,c.paint["circle-translate"],c.paint["circle-translate-anchor"]));
b=0;for(f=g.segments;b<f.length;b+=1)D=f[b],D.vaos[c.id].bind(m,k,g.layoutVertexBuffer,g.elementBuffer,n.paintVertexBuffer,D.vertexOffset),m.drawElements(m.TRIANGLES,3*D.primitiveLength,m.UNSIGNED_SHORT,6*D.primitiveOffset)}}}}},{"../source/pixels_to_tile_units":119,"../util/browser":220}],98:[function(a,p,k){p.exports=function(a,d,n,q){var c=a.gl;c.enable(c.STENCIL_TEST);var e=a.useProgram("collisionBox");c.activeTexture(c.TEXTURE1);a.frameHistory.bind(c);c.uniform1i(e.u_fadetexture,1);for(var m=
0;m<q.length;m++){var h=q[m],b=d.getTile(h),f=b.getBucket(n);if(f&&(f=f.buffers.collisionBox))for(c.uniformMatrix4fv(e.u_matrix,!1,h.posMatrix),a.enableTileClippingMask(h),a.lineWidth(1),c.uniform1f(e.u_scale,Math.pow(2,a.transform.zoom-b.coord.z)),c.uniform1f(e.u_zoom,10*a.transform.zoom),c.uniform1f(e.u_maxzoom,10*Math.max(0,Math.min(25,b.coord.z+Math.log(b.collisionTile.maxScale)/Math.LN2))),c.uniform1f(e.u_collision_y_stretch,b.collisionTile.yStretch),c.uniform1f(e.u_pitch,a.transform.pitch/360*
2*Math.PI),c.uniform1f(e.u_camera_to_center_distance,a.transform.cameraToCenterDistance),h=0,b=f.segments;h<b.length;h+=1){var g=b[h];g.vaos[n.id].bind(c,e,f.layoutVertexBuffer,f.elementBuffer,null,g.vertexOffset);c.drawElements(c.LINES,2*g.primitiveLength,c.UNSIGNED_SHORT,4*g.primitiveOffset)}}}},{}],99:[function(a,p,k){var e=a("../util/browser"),d=a("@mapbox/gl-matrix").mat4,n=a("../data/extent"),q=a("../data/buffer"),c=a("./vertex_array_object"),l=a("../data/pos_array");p.exports=function(a,b,
f){for(var g=0;g<f.length;g++){var h=a,D=b,k=f[g],t=h.gl;t.disable(t.STENCIL_TEST);h.lineWidth(1*e.devicePixelRatio);var r=k.posMatrix,p=h.useProgram("debug");t.uniformMatrix4fv(p.u_matrix,!1,r);t.uniform4f(p.u_color,1,0,0,1);h.debugVAO.bind(t,p,h.debugBuffer);t.drawArrays(t.LINE_STRIP,0,h.debugBuffer.length);var C,w,A,y,x,F,G,J,B=k.toString(),K=50,I=5,I=I||1,E=[];J=0;for(G=B.length;J<G;J++)if(y=m[B[J]]){C=null;F=0;for(x=y[1].length;F<x;F+=2)-1===y[1][F]&&-1===y[1][F+1]?C=null:(A=K+y[1][F]*I,w=200-
y[1][F+1]*I,C&&E.push(C.x,C.y,A,w),C={x:A,y:w});K+=y[0]*I}C=E;w=new l;for(A=0;A<C.length;A+=2)w.emplaceBack(C[A],C[A+1]);C=q.fromStructArray(w,q.BufferType.VERTEX);(new c).bind(t,p,C);t.uniform4f(p.u_color,1,1,1,1);D=D.getTile(k).tileSize;h=n/(Math.pow(2,h.transform.zoom-k.z)*D);k=[[-1,-1],[-1,1],[1,-1],[1,1]];for(D=0;D<k.length;D++)w=k[D],t.uniformMatrix4fv(p.u_matrix,!1,d.translate([],r,[h*w[0],h*w[1],0])),t.drawArrays(t.LINES,0,C.length);t.uniform4f(p.u_color,0,0,0,1);t.uniformMatrix4fv(p.u_matrix,
!1,r);t.drawArrays(t.LINES,0,C.length)}};var m={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,
0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,
5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,
1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,
14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,
12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,
17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,
-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,
3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,
-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,
4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,
-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,
[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,
6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,
18,6,20,7,21,10,21,12]]}},{"../data/buffer":81,"../data/extent":84,"../data/pos_array":87,"../util/browser":220,"./vertex_array_object":110,"@mapbox/gl-matrix":1}],100:[function(a,p,k){function e(a,d,e,b,f){if(!c.isPatternMissing(e.paint["fill-pattern"],a))for(var g=!0,h=0;h<b.length;h+=1){var l=b[h],m=d.getTile(l),n=m.getBucket(e);n&&(a.enableTileClippingMask(l),f(a,d,e,m,l,n.buffers,g),g=!1)}}function d(a,c,d,b,e,g,n){c=a.gl;var f=g.layerData[d.id];a=q("fill",d.paint["fill-pattern"],a,f,d,b,e,n);
b=0;for(e=g.segments;b<e.length;b+=1)n=e[b],n.vaos[d.id].bind(c,a,g.layoutVertexBuffer,g.elementBuffer,f.paintVertexBuffer,n.vertexOffset),c.drawElements(c.TRIANGLES,3*n.primitiveLength,c.UNSIGNED_SHORT,6*n.primitiveOffset)}function n(a,c,d,b,e,g,n){c=a.gl;var f=g.layerData[d.id],h=d.paint["fill-pattern"]&&!d.getPaintProperty("fill-outline-color");a=q("fillOutline",h,a,f,d,b,e,n);c.uniform2f(a.u_world,c.drawingBufferWidth,c.drawingBufferHeight);b=0;for(e=g.segments2;b<e.length;b+=1)n=e[b],n.vaos[d.id].bind(c,
a,g.layoutVertexBuffer,g.elementBuffer2,f.paintVertexBuffer,n.vertexOffset),c.drawElements(c.LINES,2*n.primitiveLength,c.UNSIGNED_SHORT,4*n.primitiveOffset)}function q(a,d,e,b,f,g,n,q){var h=e.currentProgram;if(d){a=e.useProgram(a+"Pattern",b.programConfiguration);if(q||a!==h)b.programConfiguration.setUniforms(e.gl,a,f,{zoom:e.transform.zoom}),c.prepare(f.paint["fill-pattern"],e,a);c.setTile(g,e,a)}else a=e.useProgram(a,b.programConfiguration),(q||a!==h)&&b.programConfiguration.setUniforms(e.gl,a,
f,{zoom:e.transform.zoom});e.gl.uniformMatrix4fv(a.u_matrix,!1,e.translatePosMatrix(n.posMatrix,g,f.paint["fill-translate"],f.paint["fill-translate-anchor"]));return a}var c=a("./pattern");p.exports=function(a,c,h,b){var f=a.gl;f.enable(f.STENCIL_TEST);f=!h.paint["fill-pattern"]&&h.isPaintValueFeatureConstant("fill-color")&&h.isPaintValueFeatureConstant("fill-opacity")&&1===h.paint["fill-color"][3]&&1===h.paint["fill-opacity"];a.isOpaquePass===f&&(a.setDepthSublayer(1),e(a,c,h,b,d));!a.isOpaquePass&&
h.paint["fill-antialias"]&&(a.lineWidth(2),a.depthMask(!1),a.setDepthSublayer(h.getPaintProperty("fill-outline-color")?2:0),e(a,c,h,b,n))}},{"./pattern":109}],101:[function(a,p,k){k=a("@mapbox/gl-matrix");var e=a("../data/buffer"),d=a("./vertex_array_object"),n=a("../data/pos_array"),q=a("./pattern"),c=k.mat3,l=k.mat4,m=k.vec3;p.exports=function(a,b,f,g){if(!a.isOpaquePass&&0!==f.paint["fill-extrusion-opacity"]){var h=a.gl;h.disable(h.STENCIL_TEST);h.enable(h.DEPTH_TEST);a.depthMask(!0);var D;h.activeTexture(h.TEXTURE1);
(D=a.viewportTexture)?h.bindTexture(h.TEXTURE_2D,D):(D=h.createTexture(),h.bindTexture(h.TEXTURE_2D,D),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,a.width,a.height,0,h.RGBA,h.UNSIGNED_BYTE,null),a.viewportTexture=D);var k=a.viewportFbo;if(k)h.bindFramebuffer(h.FRAMEBUFFER,
k);else{k=h.createFramebuffer();h.bindFramebuffer(h.FRAMEBUFFER,k);var t=h.createRenderbuffer();h.bindRenderbuffer(h.RENDERBUFFER,t);h.renderbufferStorage(h.RENDERBUFFER,h.DEPTH_COMPONENT16,a.width,a.height);h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,t);a.viewportFbo=k}h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,D,0);h.clearColor(0,0,0,0);h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT);k=Date.now();for(t=0;t<g.length;t++){var r=b.getTile(g[t]),
p=f.paint["fill-extrusion-duration"],C=1;f.paint["fill-extrusion-animate"]&&r.sourceCache&&0<p&&(C=(k-r.timeAdded)/p,1<C?r=1:(r=C,r=1- --r*r*r*r),C=r);a:{var w=a,r=f,A=g[t],y=C||1,x=b.getTile(A);if(C=x.getBucket(r)){var C=C.buffers,p=w.gl,F=r.paint["fill-extrusion-pattern"],G=C.layerData[r.id],J=G.programConfiguration,B=w.useProgram(F?"fillExtrusionPattern":"fillExtrusion",J);J.setUniforms(p,B,r,{zoom:w.transform.zoom});if(F){if(q.isPatternMissing(F,w))break a;q.prepare(F,w,B);q.setTile(x,w,B);p.uniform1f(B.u_height_factor,
-Math.pow(2,A.z)/x.tileSize/8)}p.uniformMatrix4fv(B.u_matrix,!1,w.translatePosMatrix(A.posMatrix,x,r.paint["fill-extrusion-translate"],r.paint["fill-extrusion-translate-anchor"]));p.uniform1f(B.u_anim_t,y);p.uniform1i(B.u_reversed,r.paint["fill-extrusion-animation-reversed"]);A=B;y=w.gl;x=w.style.light;F=x.calculated.position;F=[F.x,F.y,F.z];J=c.create();"viewport"===x.calculated.anchor&&c.fromRotation(J,-w.transform.angle);m.transformMat3(F,F,J);y.uniform3fv(A.u_lightpos,F);y.uniform1f(A.u_lightintensity,
x.calculated.intensity);y.uniform3fv(A.u_lightcolor,x.calculated.color.slice(0,3));w=0;for(A=C.segments;w<A.length;w+=1)y=A[w],y.vaos[r.id].bind(p,B,C.layoutVertexBuffer,C.elementBuffer,G.paintVertexBuffer,y.vertexOffset),p.drawElements(p.TRIANGLES,3*y.primitiveLength,p.UNSIGNED_SHORT,6*y.primitiveOffset)}}}h.bindFramebuffer(h.FRAMEBUFFER,null);b=a.useProgram("extrusionTexture");h.activeTexture(h.TEXTURE0);h.bindTexture(h.TEXTURE_2D,D);h.uniform1f(b.u_opacity,f.paint["fill-extrusion-opacity"]);h.uniform1i(b.u_image,
1);f=l.create();l.ortho(f,0,a.width,a.height,0,0,1);h.uniformMatrix4fv(b.u_matrix,!1,f);h.disable(h.DEPTH_TEST);h.uniform2f(b.u_world,h.drawingBufferWidth,h.drawingBufferHeight);a=new n;a.emplaceBack(0,0);a.emplaceBack(1,0);a.emplaceBack(0,1);a.emplaceBack(1,1);a=e.fromStructArray(a,e.BufferType.VERTEX);(new d).bind(h,b,a);h.drawArrays(h.TRIANGLE_STRIP,0,4);h.enable(h.DEPTH_TEST)}}},{"../data/buffer":81,"../data/pos_array":87,"./pattern":109,"./vertex_array_object":110,"@mapbox/gl-matrix":1}],102:[function(a,
p,k){var e=a("../util/browser"),d=a("../source/pixels_to_tile_units");p.exports=function(a,q,c,l){if(!a.isOpaquePass){a.setDepthSublayer(0);a.depthMask(!1);var m=a.gl;m.enable(m.STENCIL_TEST);if(!(0>=c.paint["line-width"]))for(var m=c.paint["line-dasharray"]?"lineSDF":c.paint["line-pattern"]?"linePattern":"line",h,b=!0,f=0;f<l.length;f+=1){var g=l[f],n=q.getTile(g),D=n.getBucket(c);if(D){var k=D.buffers.layerData[c.id],p=a.currentProgram,r=a.useProgram(m,k.programConfiguration),v=b||r!==p,C=h!==n.coord.z;
v&&k.programConfiguration.setUniforms(a.gl,r,c,{zoom:a.transform.zoom});a:{var w=p=b=void 0,A=void 0,y=a,x=n,D=D.buffers;h=c;var F=g,g=y.gl,G=h.paint["line-dasharray"],J=h.paint["line-pattern"];if(v||C){C=1/d(x,1,y.transform.tileZoom);if(G){var A=y.lineAtlas.getDash(G.from,"round"===h.layout["line-cap"]),w=y.lineAtlas.getDash(G.to,"round"===h.layout["line-cap"]),B=A.width*G.fromScale,K=w.width*G.toScale;g.uniform2f(r.u_patternscale_a,C/B,-A.height/2);g.uniform2f(r.u_patternscale_b,C/K,-w.height/2);
g.uniform1f(r.u_sdfgamma,y.lineAtlas.width/(256*Math.min(B,K)*e.devicePixelRatio)/2)}else if(J){p=y.spriteAtlas.getPattern(J.from);b=y.spriteAtlas.getPattern(J.to);if(!p||!b)break a;g.uniform2f(r.u_pattern_size_a,p.displaySize[0]*J.fromScale/C,b.displaySize[1]);g.uniform2f(r.u_pattern_size_b,b.displaySize[0]*J.toScale/C,b.displaySize[1]);g.uniform2fv(r.u_texsize,y.spriteAtlas.getPixelSize())}g.uniform2f(r.u_gl_units_to_pixels,1/y.transform.pixelsToGLUnits[0],1/y.transform.pixelsToGLUnits[1])}v&&(G?
(g.uniform1i(r.u_image,0),g.activeTexture(g.TEXTURE0),y.lineAtlas.bind(g),g.uniform1f(r.u_tex_y_a,A.y),g.uniform1f(r.u_tex_y_b,w.y),g.uniform1f(r.u_mix,G.t)):J&&(g.uniform1i(r.u_image,0),g.activeTexture(g.TEXTURE0),y.spriteAtlas.bind(g,!0),g.uniform2fv(r.u_pattern_tl_a,p.tl),g.uniform2fv(r.u_pattern_br_a,p.br),g.uniform2fv(r.u_pattern_tl_b,b.tl),g.uniform2fv(r.u_pattern_br_b,b.br),g.uniform1f(r.u_fade,J.t)));y.enableTileClippingMask(F);b=y.translatePosMatrix(F.posMatrix,x,h.paint["line-translate"],
h.paint["line-translate-anchor"]);g.uniformMatrix4fv(r.u_matrix,!1,b);g.uniform1f(r.u_ratio,1/d(x,1,y.transform.zoom));b=0;for(p=D.segments;b<p.length;b+=1)w=p[b],w.vaos[h.id].bind(g,r,D.layoutVertexBuffer,D.elementBuffer,k.paintVertexBuffer,w.vertexOffset),g.drawElements(g.TRIANGLES,3*w.primitiveLength,g.UNSIGNED_SHORT,6*w.primitiveOffset)}h=n.coord.z;b=!1}}}}},{"../source/pixels_to_tile_units":119,"../util/browser":220}],103:[function(a,p,k){function e(a){a*=Math.PI/180;var c=Math.sin(a);a=Math.cos(a);
return[(2*a+1)/3,(-Math.sqrt(3)*c-a+1)/3,(Math.sqrt(3)*c-a+1)/3]}function d(a){return 0<a?1/(1-a):1+a}function n(a){return 0<a?1-1/(1.001-a):-a}var q=a("../util/util"),c=a("@mapbox/gl-matrix");p.exports=function(a,m,h,b){if(!a.isOpaquePass){var f=a.gl;f.enable(f.DEPTH_TEST);a.depthMask(!0);f.depthFunc(f.LESS);for(var g=b.length&&b[0].z,l=0;l<b.length;l++){var D=b[l];a.setDepthSublayer(D.z-g);var k=void 0,p=void 0,r=a,v=m,C=h,w=D,D=r.gl;D.disable(D.STENCIL_TEST);var A=v.getTile(w),y=r.transform.calculatePosMatrix(w,
v.getSource().maxzoom);A.registerFadeDuration(r.style.animationLoop,C.paint["normal-fade-duration"]);var x=v=r.useProgram("normal"),F=r,G=F.gl,J=F.style.light,B=c.mat3,K=c.vec3,I=J.calculated.position,I=[I.x,I.y,I.z],E=B.create();"viewport"===J.calculated.anchor&&B.fromRotation(E,-F.transform.angle);K.transformMat3(I,I,E);G.uniform3fv(x.u_lightpos,I);G.uniform1f(x.u_lightintensity,J.calculated.intensity);G.uniform3fv(x.u_lightcolor,J.calculated.color.slice(0,3));D.uniformMatrix4fv(v.u_matrix,!1,y);
D.uniform1f(v.u_brightness_low,C.paint["normal-brightness-min"]);D.uniform1f(v.u_brightness_high,C.paint["normal-brightness-max"]);D.uniform1f(v.u_saturation_factor,n(C.paint["normal-saturation"]));D.uniform1f(v.u_contrast_factor,d(C.paint["normal-contrast"]));D.uniform3fv(v.u_spin_weights,e(C.paint["normal-hue-rotate"]));w=A.sourceCache&&A.sourceCache.findLoadedParent(w,0,{});y=A;x=w;G=r.transform;J=C.paint["normal-fade-duration"];y.sourceCache&&0<J?(B=Date.now(),F=(B-y.timeAdded)/J,J=x?(B-x.timeAdded)/
J:-1,B=y.sourceCache.getSource(),G=G.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),G=(G=!x||Math.abs(x.coord.z-G)>Math.abs(y.coord.z-G))&&y.refreshedUponExpiration?1:q.clamp(G?F:1-J,0,1),y.refreshedUponExpiration&&1<=F&&(y.refreshedUponExpiration=!1),y=x?{opacity:1,mix:1-G}:{opacity:G,mix:0}):y={opacity:1,mix:0};D.activeTexture(D.TEXTURE0);D.bindTexture(D.TEXTURE_2D,A.texture);D.activeTexture(D.TEXTURE1);w?(D.bindTexture(D.TEXTURE_2D,w.texture),p=Math.pow(2,w.coord.z-A.coord.z),k=
[A.coord.x*p%1,A.coord.y*p%1]):D.bindTexture(D.TEXTURE_2D,A.texture);D.uniform2fv(v.u_tl_parent,k||[0,0]);D.uniform1f(v.u_scale_parent,p||1);D.uniform1f(v.u_buffer_scale,1);D.uniform1f(v.u_fade_t,y.mix);D.uniform1f(v.u_opacity,y.opacity*C.paint["normal-opacity"]);D.uniform1i(v.u_image0,0);D.uniform1i(v.u_image1,1);k=A.boundsBuffer||r.rasterBoundsBuffer;(A.boundsVAO||r.rasterBoundsVAO).bind(D,v,k);D.drawArrays(D.TRIANGLE_STRIP,0,k.length)}f.depthFunc(f.LEQUAL)}}},{"../util/util":241,"@mapbox/gl-matrix":1}],
104:[function(a,p,k){function e(a){a*=Math.PI/180;var c=Math.sin(a);a=Math.cos(a);return[(2*a+1)/3,(-Math.sqrt(3)*c-a+1)/3,(Math.sqrt(3)*c-a+1)/3]}function d(a){return 0<a?1/(1-a):1+a}function n(a){return 0<a?1-1/(1.001-a):-a}var q=a("../util/util");p.exports=function(a,l,m,h){if(!a.isOpaquePass){var b=a.gl;b.enable(b.DEPTH_TEST);a.depthMask(!0);b.depthFunc(b.LESS);for(var c=h.length&&h[0].z,g=0;g<h.length;g++){var u=h[g];a.setDepthSublayer(u.z-c);var D=void 0,k=void 0,p=a,r=l,v=m,C=u,u=p.gl;u.disable(u.STENCIL_TEST);
var w=r.getTile(C),A=p.transform.calculatePosMatrix(C,r.getSource().maxzoom);w.registerFadeDuration(p.style.animationLoop,v.paint["raster-fade-duration"]);r=p.useProgram("raster");u.uniformMatrix4fv(r.u_matrix,!1,A);u.uniform1f(r.u_brightness_low,v.paint["raster-brightness-min"]);u.uniform1f(r.u_brightness_high,v.paint["raster-brightness-max"]);u.uniform1f(r.u_saturation_factor,n(v.paint["raster-saturation"]));u.uniform1f(r.u_contrast_factor,d(v.paint["raster-contrast"]));u.uniform3fv(r.u_spin_weights,
e(v.paint["raster-hue-rotate"]));C=w.sourceCache&&w.sourceCache.findLoadedParent(C,0,{});var A=w,y=C,x=p.transform,F=v.paint["raster-fade-duration"];if(A.sourceCache&&0<F){var G=Date.now(),J=(G-A.timeAdded)/F,F=y?(G-y.timeAdded)/F:-1,G=A.sourceCache.getSource(),x=x.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),x=(x=!y||Math.abs(y.coord.z-x)>Math.abs(A.coord.z-x))&&A.refreshedUponExpiration?1:q.clamp(x?J:1-F,0,1);A.refreshedUponExpiration&&1<=J&&(A.refreshedUponExpiration=!1);A=y?
{opacity:1,mix:1-x}:{opacity:x,mix:0}}else A={opacity:1,mix:0};u.activeTexture(u.TEXTURE0);u.bindTexture(u.TEXTURE_2D,w.texture);u.activeTexture(u.TEXTURE1);C?(u.bindTexture(u.TEXTURE_2D,C.texture),k=Math.pow(2,C.coord.z-w.coord.z),D=[w.coord.x*k%1,w.coord.y*k%1]):u.bindTexture(u.TEXTURE_2D,w.texture);u.uniform2fv(r.u_tl_parent,D||[0,0]);u.uniform1f(r.u_scale_parent,k||1);u.uniform1f(r.u_buffer_scale,1);u.uniform1f(r.u_fade_t,A.mix);u.uniform1f(r.u_opacity,A.opacity*v.paint["raster-opacity"]);u.uniform1i(r.u_image0,
0);u.uniform1i(r.u_image1,1);D=w.boundsBuffer||p.rasterBoundsBuffer;(w.boundsVAO||p.rasterBoundsVAO).bind(u,r,D);u.drawArrays(u.TRIANGLE_STRIP,0,D.length)}b.depthFunc(b.LEQUAL)}}},{"../util/util":241}],105:[function(a,p,k){function e(a,b,e,g,n,D,k,p,r,v){if(n||!a.style.sprite||a.style.sprite.loaded()){var f=a.gl;p="map"===p;r="map"===r;var h=p&&"line"===e.layout["symbol-placement"],u=p&&!r&&!h;r?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST);for(var z,t,F=0;F<g.length;F+=1){var G=g[F],J=b.getTile(G),
B=J.getBucket(e);if(B){var K=n?B.buffers.glyph:B.buffers.icon;if(K&&K.segments.length){var I=K.layerData[e.id].programConfiguration,E=n||B.sdfIcons,H=n?B.textSizeData:B.iconSizeData;if(!z||B.fontstack!==t)a:{z=a.useProgram(E?"symbolSDF":"symbolIcon",I),I.setUniforms(f,z,e,{zoom:a.transform.zoom}),t=z;var L=a,N=e,Q=n,R=E,I=u,O=r,P=B.fontstack,S=B.iconsNeedLinear,T=H,H=L.gl,V=L.transform;H.uniform1i(t.u_pitch_with_map,O);H.activeTexture(H.TEXTURE0);H.uniform1i(t.u_texture,0);H.uniform1f(t.u_is_text,
Q?1:0);if(Q){R=P&&L.glyphSource.getGlyphAtlas(P);if(!R)break a;R.updateTexture(H);H.uniform2f(t.u_texsize,R.width,R.height)}else{var P=L.options.rotating||L.options.zooming,ca=!N.isLayoutValueFeatureConstant("icon-size")||!N.isLayoutValueZoomConstant("icon-size")||1!==N.getLayoutValue("icon-size",{zoom:V.zoom}),O=O||V.pitch;L.spriteAtlas.bind(H,R||P||ca||S||O);H.uniform2fv(t.u_texsize,L.spriteAtlas.getPixelSize())}H.activeTexture(H.TEXTURE1);L.frameHistory.bind(H);H.uniform1i(t.u_fadetexture,1);H.uniform1f(t.u_pitch,
V.pitch/360*2*Math.PI);H.uniform1i(t.u_is_size_zoom_constant,T.isZoomConstant?1:0);H.uniform1i(t.u_is_size_feature_constant,T.isFeatureConstant?1:0);H.uniform1f(t.u_camera_to_center_distance,V.cameraToCenterDistance);L=l.evaluateSizeForZoom(T,V,N,Q);void 0!==L.uSizeT&&H.uniform1f(t.u_size_t,L.uSizeT);void 0!==L.uSize&&H.uniform1f(t.u_size,L.uSize);H.uniform1f(t.u_aspect_ratio,V.width/V.height);H.uniform1i(t.u_rotate_symbol,I)}a.enableTileClippingMask(G);f.uniformMatrix4fv(z.u_matrix,!1,a.translatePosMatrix(G.posMatrix,
J,D,k));t=q(J,1,a.transform.zoom);I=c.getLabelPlaneMatrix(G.posMatrix,r,p,a.transform,t);L=c.getGlCoordMatrix(G.posMatrix,r,p,a.transform,t);f.uniformMatrix4fv(z.u_gl_coord_matrix,!1,a.translatePosMatrix(L,J,D,k,!0));h?(f.uniformMatrix4fv(z.u_label_plane_matrix,!1,m),c.updateLineLabels(B,G.posMatrix,a,n,I,L,r,v,t,e)):f.uniformMatrix4fv(z.u_label_plane_matrix,!1,I);f.uniform1f(z.u_collision_y_stretch,J.collisionTile.yStretch);G=z;J=e;t=r;I=a.gl;L=a.transform;E&&(E=(n?"text":"icon")+"-halo-width",E=
!J.isPaintValueFeatureConstant(E)||J.paint[E],I.uniform1f(G.u_gamma_scale,t?Math.cos(L._pitch)*L.cameraToCenterDistance:1),E&&(I.uniform1f(G.u_is_halo,1),d(K,J,I,G)),I.uniform1f(G.u_is_halo,0));d(K,J,I,G);t=B.fontstack}}}r||f.enable(f.DEPTH_TEST)}}function d(a,b,c,d){for(var e=a.layerData[b.id],e=e&&e.paintVertexBuffer,f=0,g=a.segments;f<g.length;f+=1){var h=g[f];h.vaos[b.id].bind(c,d,a.layoutVertexBuffer,a.elementBuffer,e,h.vertexOffset,a.dynamicLayoutVertexBuffer);c.drawElements(c.TRIANGLES,3*h.primitiveLength,
c.UNSIGNED_SHORT,6*h.primitiveOffset)}}var n=a("./draw_collision_debug"),q=a("../source/pixels_to_tile_units"),c=a("../symbol/projection"),l=a("../symbol/symbol_size"),m=a("@mapbox/gl-matrix").mat4.identity(new Float32Array(16));p.exports=function(a,b,c,d){if(!a.isOpaquePass){var f=a.gl;c.layout["text-allow-overlap"]||c.layout["icon-allow-overlap"]||c.layout["text-ignore-placement"]||c.layout["icon-ignore-placement"]?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST);a.setDepthSublayer(0);a.depthMask(!1);
e(a,b,c,d,!1,c.paint["icon-translate"],c.paint["icon-translate-anchor"],c.layout["icon-rotation-alignment"],c.layout["icon-pitch-alignment"],c.layout["icon-keep-upright"]);e(a,b,c,d,!0,c.paint["text-translate"],c.paint["text-translate-anchor"],c.layout["text-rotation-alignment"],c.layout["text-pitch-alignment"],c.layout["text-keep-upright"]);b.map.showCollisionBoxes&&n(a,b,c,d)}}},{"../source/pixels_to_tile_units":119,"../symbol/projection":193,"../symbol/symbol_size":197,"./draw_collision_debug":98,
"@mapbox/gl-matrix":1}],106:[function(a,p,k){a=function(){this.changeTimes=new Float64Array(256);this.changeOpacities=new Uint8Array(256);this.opacities=new Uint8ClampedArray(256);this.array=new Uint8Array(this.opacities.buffer);this.previousZoom=0;this.firstFrame=!0};a.prototype.record=function(a,d,n){this.firstFrame&&(a=0,this.firstFrame=!1);d=Math.floor(10*d);var e;if(d<this.previousZoom)for(e=d+1;e<=this.previousZoom;e++)this.changeTimes[e]=a,this.changeOpacities[e]=this.opacities[e];else for(e=
d;e>this.previousZoom;e--)this.changeTimes[e]=a,this.changeOpacities[e]=this.opacities[e];for(e=0;256>e;e++){var c=a-this.changeTimes[e],c=255*(n?c/n:1);this.opacities[e]=e<=d?this.changeOpacities[e]+c:this.changeOpacities[e]-c}this.changed=!0;this.previousZoom=d};a.prototype.isVisible=function(a){return 0!==this.opacities[Math.floor(10*a)]};a.prototype.bind=function(a){this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.changed&&(a.texSubImage2D(a.TEXTURE_2D,0,0,0,256,1,a.ALPHA,a.UNSIGNED_BYTE,
this.array),this.changed=!1)):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,256,1,0,a.ALPHA,a.UNSIGNED_BYTE,this.array))};p.exports=a},{}],107:[function(a,p,k){var e=a("../util/util");a=function(a,
e){this.width=a;this.height=e;this.nextRow=0;this.bytes=4;this.data=new Uint8Array(this.width*this.height*this.bytes);this.positions={}};a.prototype.setSprite=function(a){this.sprite=a};a.prototype.getDash=function(a,e){var d=a.join(",")+e;this.positions[d]||(this.positions[d]=this.addDash(a,e));return this.positions[d]};a.prototype.addDash=function(a,n){var d=n?7:0,c=2*d+1;if(this.nextRow+c>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var l=0,m=0;m<a.length;m++)l+=a[m];for(var m=
this.width/l,h=m/2,b=1===a.length%2,f=-d;f<=d;f++)for(var g=this.width*(this.nextRow+d+f),u=b?-a[a.length-1]:0,D=a[0],k=1,p=0;p<this.width;p++){for(;D<p/m;)u=D,D+=a[k],b&&k===a.length-1&&(D+=a[0]),k++;var r=Math.min(Math.abs(p-u*m),Math.abs(p-D*m)),v=1===k%2;if(n){var C=d?f/d*(h+1):0;v?(v=h-Math.abs(C),r=Math.sqrt(r*r+v*v)):r=h-Math.sqrt(r*r+C*C)}else r*=v?1:-1;this.data[3+4*(g+p)]=Math.max(0,Math.min(255,r+128))}d={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:l};this.nextRow+=c;
this.dirty=!0;return d};a.prototype.bind=function(a){this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,this.data))};p.exports=a},{"../util/util":241}],108:[function(a,p,k){var e=a("../util/browser"),d=a("@mapbox/gl-matrix").mat4,n=a("./frame_history"),q=a("../source/source_cache"),c=a("../data/extent"),l=a("../source/pixels_to_tile_units"),m=a("../util/util"),h=a("../data/buffer"),b=a("./vertex_array_object"),f=a("../data/raster_bounds_array"),g=a("../data/pos_array"),u=a("../data/program_configuration"),
D=a("../shaders"),z=a("assert"),t={symbol:a("./draw_symbol"),circle:a("./draw_circle"),line:a("./draw_line"),fill:a("./draw_fill"),"fill-extrusion":a("./draw_fill_extrusion"),raster:a("./draw_raster"),background:a("./draw_background"),normal:a("./draw_normal"),debug:a("./draw_debug")};a=function(b,a){this.gl=b;this.transform=a;this._tileTextures={};this.frameHistory=new n;this.setup();this.numSublayers=q.maxUnderzooming+q.maxOverzooming+1;this.depthEpsilon=1/Math.pow(2,16);this.lineWidthRange=b.getParameter(b.ALIASED_LINE_WIDTH_RANGE);
this.basicFillProgramConfiguration=u.createBasicFill();this.emptyProgramConfiguration=new u};a.prototype.resize=function(b,a){var c=this.gl;this.width=b*e.devicePixelRatio;this.height=a*e.devicePixelRatio;c.viewport(0,0,this.width,this.height);this.viewportTexture&&(this.gl.deleteTexture(this.viewportTexture),this.viewportTexture=null);this.viewportFbo&&(this.gl.deleteFramebuffer(this.viewportFbo),this.viewportFbo=null)};a.prototype.setup=function(){var a=this.gl;a.enable(a.BLEND);a.blendFunc(a.ONE,
a.ONE_MINUS_SRC_ALPHA);a.enable(a.STENCIL_TEST);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);this._depthMask=!1;a.depthMask(!1);var d=new g;d.emplaceBack(0,0);d.emplaceBack(c,0);d.emplaceBack(0,c);d.emplaceBack(c,c);this.tileExtentBuffer=h.fromStructArray(d,h.BufferType.VERTEX);this.tileExtentVAO=new b;this.tileExtentPatternVAO=new b;d=new g;d.emplaceBack(0,0);d.emplaceBack(c,0);d.emplaceBack(c,c);d.emplaceBack(0,c);d.emplaceBack(0,0);this.debugBuffer=h.fromStructArray(d,h.BufferType.VERTEX);this.debugVAO=
new b;d=new f;d.emplaceBack(0,0,0,0);d.emplaceBack(c,0,32767,0);d.emplaceBack(0,c,0,32767);d.emplaceBack(c,c,32767,32767);this.rasterBoundsBuffer=h.fromStructArray(d,h.BufferType.VERTEX);this.rasterBoundsVAO=new b;if(this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"))this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)};
a.prototype.clearColor=function(){var b=this.gl;b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT)};a.prototype.clearStencil=function(){var b=this.gl;b.clearStencil(0);b.stencilMask(255);b.clear(b.STENCIL_BUFFER_BIT)};a.prototype.clearDepth=function(){var b=this.gl;b.clearDepth(1);this.depthMask(!0);b.clear(b.DEPTH_BUFFER_BIT)};a.prototype._renderTileClippingMasks=function(b){var a=this.gl;a.colorMask(!1,!1,!1,!1);this.depthMask(!1);a.disable(a.DEPTH_TEST);a.enable(a.STENCIL_TEST);a.stencilMask(255);
a.stencilOp(a.KEEP,a.KEEP,a.REPLACE);var c=1;this._tileClippingMaskIDs={};for(var d=0;d<b.length;d+=1){var e=b[d],f=this._tileClippingMaskIDs[e.id]=c++;a.stencilFunc(a.ALWAYS,f,255);f=this.useProgram("fill",this.basicFillProgramConfiguration);a.uniformMatrix4fv(f.u_matrix,!1,e.posMatrix);this.tileExtentVAO.bind(a,f,this.tileExtentBuffer);a.drawArrays(a.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}a.stencilMask(0);a.colorMask(!0,!0,!0,!0);this.depthMask(!0);a.enable(a.DEPTH_TEST)};a.prototype.enableTileClippingMask=
function(b){var a=this.gl;a.stencilFunc(a.EQUAL,this._tileClippingMaskIDs[b.id],255)};a.prototype.prepareBuffers=function(){};a.prototype.render=function(b,a){this.style=b;this.options=a;this.lineAtlas=b.lineAtlas;this.spriteAtlas=b.spriteAtlas;this.spriteAtlas.setSprite(b.sprite);this.glyphSource=b.glyphSource;this.frameHistory.record(Date.now(),this.transform.zoom,b.getTransition().duration);this.prepareBuffers();this.clearColor();this.clearDepth();this.showOverdrawInspector(a.showOverdrawInspector);
this.depthRange=(b._order.length+2)*this.numSublayers*this.depthEpsilon;this.isOpaquePass=!0;this.renderPass();this.isOpaquePass=!1;this.renderPass();if(this.options.showTileBoundaries){var c=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];c&&t.debug(this,c,c.getVisibleCoordinates())}};a.prototype.renderPass=function(){var b=this.style._order,a,c=[];this.currentLayer=this.isOpaquePass?b.length-1:0;this.isOpaquePass?this._showOverdrawInspector||this.gl.disable(this.gl.BLEND):this.gl.enable(this.gl.BLEND);
for(var d=0;d<b.length;d++){var e=this.style._layers[b[this.currentLayer]];e.source!==(a&&a.id)&&(a=this.style.sourceCaches[e.source],c=[],a&&(a.prepare&&a.prepare(),this.clearStencil(),c=a.getVisibleCoordinates(),a.getSource().isTileClipped&&this._renderTileClippingMasks(c)),this.isOpaquePass||c.reverse());this.renderLayer(this,a,e,c);this.currentLayer+=this.isOpaquePass?-1:1}};a.prototype.depthMask=function(b){b!==this._depthMask&&(this._depthMask=b,this.gl.depthMask(b))};a.prototype.renderLayer=
function(b,a,c,d){c.isHidden(this.transform.zoom)||"background"!==c.type&&!d.length||(this.id=c.id,t[c.type](b,a,c,d))};a.prototype.setDepthSublayer=function(b){b=1-((1+this.currentLayer)*this.numSublayers+b)*this.depthEpsilon;this.gl.depthRange(b-1+this.depthRange,b)};a.prototype.translatePosMatrix=function(b,a,c,e,f){if(!c[0]&&!c[1])return b;var g=f?"map"===e?this.transform.angle:0:"viewport"===e?-this.transform.angle:0;g&&(e=Math.sin(g),g=Math.cos(g),c=[c[0]*g-c[1]*e,c[0]*e+c[1]*g]);a=[f?c[0]:
l(a,c[0],this.transform.zoom),f?c[1]:l(a,c[1],this.transform.zoom),0];c=new Float32Array(16);d.translate(c,b,a);return c};a.prototype.saveTileTexture=function(b){var a=this._tileTextures[b.size];a?a.push(b):this._tileTextures[b.size]=[b]};a.prototype.getTileTexture=function(b){return(b=this._tileTextures[b])&&0<b.length?b.pop():null};a.prototype.lineWidth=function(b){this.gl.lineWidth(m.clamp(b,this.lineWidthRange[0],this.lineWidthRange[1]))};a.prototype.showOverdrawInspector=function(b){if(b||this._showOverdrawInspector){this._showOverdrawInspector=
b;var a=this.gl;b?(a.blendFunc(a.CONSTANT_COLOR,a.ONE),a.blendColor(.125,.125,.125,0),a.clearColor(0,0,0,1),a.clear(a.COLOR_BUFFER_BIT)):a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA)}};a.prototype.createProgram=function(b,a){var c=this.gl,d=c.createProgram(),f=a.defines().concat("#define DEVICE_PIXEL_RATIO "+e.devicePixelRatio.toFixed(1));this._showOverdrawInspector&&f.push("#define OVERDRAW_INSPECTOR;");var g=f.concat(D.prelude.fragmentSource,D[b].fragmentSource).join("\n"),f=f.concat(D.prelude.vertexSource,
D[b].vertexSource).join("\n"),h=c.createShader(c.FRAGMENT_SHADER);c.shaderSource(h,g);c.compileShader(h);z(c.getShaderParameter(h,c.COMPILE_STATUS),c.getShaderInfoLog(h));c.attachShader(d,h);g=c.createShader(c.VERTEX_SHADER);c.shaderSource(g,f);c.compileShader(g);z(c.getShaderParameter(g,c.COMPILE_STATUS),c.getShaderInfoLog(g));c.attachShader(d,g);g=a["interface"]?a["interface"].layoutAttributes:[];for(f=0;f<g.length;f++)c.bindAttribLocation(d,f,g[f].name);c.linkProgram(d);z(c.getProgramParameter(d,
c.LINK_STATUS),c.getProgramInfoLog(d));f=c.getProgramParameter(d,c.ACTIVE_ATTRIBUTES);g={program:d,numAttributes:f};for(h=0;h<f;h++){var l=c.getActiveAttrib(d,h);l&&(g[l.name]=c.getAttribLocation(d,l.name))}f=c.getProgramParameter(d,c.ACTIVE_UNIFORMS);for(h=0;h<f;h++)(l=c.getActiveUniform(d,h))&&(g[l.name]=c.getUniformLocation(d,l.name));return g};a.prototype._createProgramCached=function(b,a){this.cache=this.cache||{};var c=""+b+(a.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");this.cache[c]||
(this.cache[c]=this.createProgram(b,a));return this.cache[c]};a.prototype.useProgram=function(b,a){var c=this.gl,d=this._createProgramCached(b,a||this.emptyProgramConfiguration);this.currentProgram!==d&&(c.useProgram(d.program),this.currentProgram=d);return d};p.exports=a},{"../data/buffer":81,"../data/extent":84,"../data/pos_array":87,"../data/program_configuration":88,"../data/raster_bounds_array":89,"../shaders":112,"../source/pixels_to_tile_units":119,"../source/source_cache":124,"../util/browser":220,
"../util/util":241,"./draw_background":96,"./draw_circle":97,"./draw_debug":99,"./draw_fill":100,"./draw_fill_extrusion":101,"./draw_line":102,"./draw_normal":103,"./draw_raster":104,"./draw_symbol":105,"./frame_history":106,"./vertex_array_object":110,"@mapbox/gl-matrix":1,assert:9}],109:[function(a,p,k){var e=a("assert"),d=a("../source/pixels_to_tile_units");k.isPatternMissing=function(a,d){if(!a)return!1;var c=d.spriteAtlas.getPattern(a.from),e=d.spriteAtlas.getPattern(a.to);return!c||!e};k.prepare=
function(a,d,c){var l=d.gl,m=d.spriteAtlas.getPattern(a.from),h=d.spriteAtlas.getPattern(a.to);e(m&&h);l.uniform1i(c.u_image,0);l.uniform2fv(c.u_pattern_tl_a,m.tl);l.uniform2fv(c.u_pattern_br_a,m.br);l.uniform2fv(c.u_pattern_tl_b,h.tl);l.uniform2fv(c.u_pattern_br_b,h.br);l.uniform2fv(c.u_texsize,d.spriteAtlas.getPixelSize());l.uniform1f(c.u_mix,a.t);l.uniform2fv(c.u_pattern_size_a,m.displaySize);l.uniform2fv(c.u_pattern_size_b,h.displaySize);l.uniform1f(c.u_scale_a,a.fromScale);l.uniform1f(c.u_scale_b,
a.toScale);l.activeTexture(l.TEXTURE0);d.spriteAtlas.bind(l,!0)};k.setTile=function(a,e,c){var l=e.gl;l.uniform1f(c.u_tile_units_to_pixels,1/d(a,1,e.transform.tileZoom));var m=Math.pow(2,a.coord.z);e=a.tileSize*Math.pow(2,e.transform.tileZoom)/m;m=e*(a.coord.x+a.coord.w*m);a=e*a.coord.y;l.uniform2f(c.u_pixel_coord_upper,m>>16,a>>16);l.uniform2f(c.u_pixel_coord_lower,m&65535,a&65535)}},{"../source/pixels_to_tile_units":119,assert:9}],110:[function(a,p,k){var e=a("assert");a=function(){this.vao=this.boundVertexOffset=
this.boundElementBuffer=this.boundVertexBuffer2=this.boundVertexBuffer=this.boundProgram=null};a.prototype.bind=function(a,e,q,c,l,m,h){void 0===a.extVertexArrayObject&&(a.extVertexArrayObject=a.getExtension("OES_vertex_array_object"));var b=!this.vao||this.boundProgram!==e||this.boundVertexBuffer!==q||this.boundVertexBuffer2!==l||this.boundElementBuffer!==c||this.boundVertexOffset!==m||this.boundDynamicVertexBuffer!==h;!a.extVertexArrayObject||b?(this.freshBind(a,e,q,c,l,m,h),this.gl=a):(a.extVertexArrayObject.bindVertexArrayOES(this.vao),
h&&h.bind(a))};a.prototype.freshBind=function(a,n,q,c,l,m,h){var b,d=n.numAttributes;if(a.extVertexArrayObject)this.vao&&this.destroy(),this.vao=a.extVertexArrayObject.createVertexArrayOES(),a.extVertexArrayObject.bindVertexArrayOES(this.vao),this.boundProgram=n,this.boundVertexBuffer=q,this.boundVertexBuffer2=l,this.boundElementBuffer=c,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=h;else{b=a.currentNumAttributes||0;for(var g=d;g<b;g++)e(0!==g),a.disableVertexAttribArray(g)}q.enableAttributes(a,
n);l&&l.enableAttributes(a,n);h&&h.enableAttributes(a,n);q.bind(a);q.setVertexAttribPointers(a,n,m);l&&(l.bind(a),l.setVertexAttribPointers(a,n,m));h&&(h.bind(a),h.setVertexAttribPointers(a,n,m));c&&c.bind(a);a.currentNumAttributes=d};a.prototype.destroy=function(){this.vao&&(this.gl.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};p.exports=a},{assert:9}],111:[function(a,p,k){var e=a("../util/util");k.packUint8ToFloat=function(a,n){a=e.clamp(Math.floor(a),0,255);n=e.clamp(Math.floor(n),
0,255);return 256*a+n}},{"../util/util":241}],112:[function(a,p,k){p.exports={prelude:{fragmentSource:"#ifdef GL_ES\r\nprecision mediump float;\r\n#else\r\n\r\n#if !defined(lowp)\r\n#define lowp\r\n#endif\r\n\r\n#if !defined(mediump)\r\n#define mediump\r\n#endif\r\n\r\n#if !defined(highp)\r\n#define highp\r\n#endif\r\n\r\n#endif\r\n",vertexSource:"#ifdef GL_ES\r\nprecision highp float;\r\n#else\r\n\r\n#if !defined(lowp)\r\n#define lowp\r\n#endif\r\n\r\n#if !defined(mediump)\r\n#define mediump\r\n#endif\r\n\r\n#if !defined(highp)\r\n#define highp\r\n#endif\r\n\r\n#endif\r\n\r\n// Unpack a pair of values that have been packed into a single float.\r\n// The packed values are assumed to be 8-bit unsigned integers, and are\r\n// packed like so:\r\n// packedValue = floor(input[0]) * 256 + input[1],\r\nvec2 unpack_float(const float packedValue) {\r\n    int packedIntValue = int(packedValue);\r\n    int v0 = packedIntValue / 256;\r\n    return vec2(v0, packedIntValue - v0 * 256);\r\n}\r\n\r\n\r\n// To minimize the number of attributes needed, we encode a 4-component\r\n// color into a pair of floats (i.e. a vec2) as follows:\r\n// [ floor(color.r * 255) * 256 + color.g * 255,\r\n//   floor(color.b * 255) * 256 + color.g * 255 ]\r\nvec4 decode_color(const vec2 encodedColor) {\r\n    return vec4(\r\n        unpack_float(encodedColor[0]) / 255.0,\r\n        unpack_float(encodedColor[1]) / 255.0\r\n    );\r\n}\r\n\r\n// Unpack a pair of paint values and interpolate between them.\r\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\r\n    return mix(packedValue[0], packedValue[1], t);\r\n}\r\n\r\n// Unpack a pair of paint values and interpolate between them.\r\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\r\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\r\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\r\n    return mix(minColor, maxColor, t);\r\n}\r\n\r\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\r\n// vec2 offset = mod(pixel_coord, size)\r\n//\r\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\r\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\r\n//\r\n// The pixel_coord is passed in as two 16 bit values:\r\n// pixel_coord_upper = floor(pixel_coord / 2^16)\r\n// pixel_coord_lower = mod(pixel_coord, 2^16)\r\n//\r\n// The offset is calculated in a series of steps that should preserve this precision:\r\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\r\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\r\n\r\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\r\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\r\n}\r\n"},
circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define mediump float radius\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define highp vec4 stroke_color\r\n#pragma mapbox: define mediump float stroke_width\r\n#pragma mapbox: define lowp float stroke_opacity\r\n\r\nvarying vec3 v_data;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize mediump float radius\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize highp vec4 stroke_color\r\n    #pragma mapbox: initialize mediump float stroke_width\r\n    #pragma mapbox: initialize lowp float stroke_opacity\r\n\r\n    vec2 extrude = v_data.xy;\r\n    float extrude_length = length(extrude);\r\n\r\n    lowp float antialiasblur = v_data.z;\r\n    float antialiased_blur = -max(blur, antialiasblur);\r\n\r\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\r\n\r\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\r\n        antialiased_blur,\r\n        0.0,\r\n        extrude_length - radius / (radius + stroke_width)\r\n    );\r\n\r\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform bool u_scale_with_map;\r\nuniform bool u_pitch_with_map;\r\nuniform vec2 u_extrude_scale;\r\nuniform highp float u_camera_to_center_distance;\r\n\r\nattribute vec2 a_pos;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define mediump float radius\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define highp vec4 stroke_color\r\n#pragma mapbox: define mediump float stroke_width\r\n#pragma mapbox: define lowp float stroke_opacity\r\n\r\nvarying vec3 v_data;\r\n\r\nvoid main(void) {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize mediump float radius\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize highp vec4 stroke_color\r\n    #pragma mapbox: initialize mediump float stroke_width\r\n    #pragma mapbox: initialize lowp float stroke_opacity\r\n\r\n    // unencode the extrusion vector that we snuck into the a_pos vector\r\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\r\n\r\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\r\n    // in extrusion data\r\n    vec2 circle_center = floor(a_pos * 0.5);\r\n    if (u_pitch_with_map) {\r\n        vec2 corner_position = circle_center;\r\n        if (u_scale_with_map) {\r\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\r\n        } else {\r\n            // Pitching the circle with the map effectively scales it with the map\r\n            // To counteract the effect for pitch-scale: viewport, we rescale the\r\n            // whole circle based on the pitch scaling effect at its central point\r\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\r\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\r\n        }\r\n\r\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\r\n    } else {\r\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\r\n\r\n        if (u_scale_with_map) {\r\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\r\n        } else {\r\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\r\n        }\r\n    }\r\n\r\n    // This is a minimum blur distance that serves as a faux-antialiasing for\r\n    // the circle. since blur is a ratio of the circle's size and the intent is\r\n    // to keep the blur at roughly 1px, the two are inversely related.\r\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\r\n\r\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\r\n}\r\n"},
collisionBox:{fragmentSource:"uniform float u_zoom;\r\n// u_maxzoom is derived from the maximum scale considered by the CollisionTile\r\n// Labels with placement zoom greater than this value will not be placed,\r\n// regardless of perspective effects.\r\nuniform float u_maxzoom;\r\nuniform sampler2D u_fadetexture;\r\n\r\n// v_max_zoom is a collision-box-specific value that controls when line-following\r\n// collision boxes are used.\r\nvarying float v_max_zoom;\r\nvarying float v_placement_zoom;\r\nvarying float v_perspective_zoom_adjust;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n\r\n    float alpha = 0.5;\r\n\r\n    // Green = no collisions, label is showing\r\n    gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0) * alpha;\r\n\r\n    // Red = collision, label hidden\r\n    if (texture2D(u_fadetexture, v_fade_tex).a < 1.0) {\r\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\r\n    }\r\n\r\n    // Faded black = this collision box is not used at this zoom (for curved labels)\r\n    if (u_zoom >= v_max_zoom + v_perspective_zoom_adjust) {\r\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) * alpha * 0.25;\r\n    }\r\n\r\n    // Faded blue = the placement scale for this label is beyond the CollisionTile\r\n    // max scale, so it's impossible for this label to show without collision detection\r\n    // being run again (the label's glyphs haven't even been added to the symbol bucket)\r\n    if (v_placement_zoom >= u_maxzoom) {\r\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0) * alpha * 0.2;\r\n    }\r\n}\r\n",
vertexSource:"attribute vec2 a_pos;\r\nattribute vec2 a_anchor_pos;\r\nattribute vec2 a_extrude;\r\nattribute vec2 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform float u_scale;\r\nuniform float u_pitch;\r\nuniform float u_collision_y_stretch;\r\nuniform float u_camera_to_center_distance;\r\n\r\nvarying float v_max_zoom;\r\nvarying float v_placement_zoom;\r\nvarying float v_perspective_zoom_adjust;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\r\n    highp float camera_to_anchor_distance = projectedPoint.w;\r\n    highp float collision_perspective_ratio = 1.0 + 0.5 * ((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\r\n\r\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\r\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\r\n\r\n    gl_Position = u_matrix * vec4(a_pos + a_extrude * collision_perspective_ratio * collision_adjustment / u_scale, 0.0, 1.0);\r\n\r\n    v_max_zoom = a_data.x;\r\n    v_placement_zoom = a_data.y;\r\n\r\n    v_perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\r\n    v_fade_tex = vec2((v_placement_zoom + v_perspective_zoom_adjust) / 255.0, 0.0);\r\n}\r\n"},
debug:{fragmentSource:"uniform highp vec4 u_color;\r\n\r\nvoid main() {\r\n    gl_FragColor = u_color;\r\n}\r\n",vertexSource:"attribute vec2 a_pos;\r\n\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos, step(32767.0, a_pos.x), 1);\r\n}\r\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_FragColor = color * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"attribute vec2 a_pos;\r\n\r\nuniform mat4 u_matrix;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n}\r\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvarying vec2 v_pos;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 outline_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    float dist = length(v_pos - gl_FragCoord.xy);\r\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\r\n    gl_FragColor = outline_color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"attribute vec2 a_pos;\r\n\r\nuniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\n\r\nvarying vec2 v_pos;\r\n\r\n#pragma mapbox: define highp vec4 outline_color\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 outline_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\r\n}\r\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_mix;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec2 v_pos;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    vec2 imagecoord = mod(v_pos_a, 1.0);\r\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\r\n    vec4 color1 = texture2D(u_image, pos);\r\n\r\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\r\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\r\n    vec4 color2 = texture2D(u_image, pos2);\r\n\r\n    // find distance to outline for alpha interpolation\r\n\r\n    float dist = length(v_pos - gl_FragCoord.xy);\r\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\r\n\r\n\r\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\nuniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_scale_a;\r\nuniform float u_scale_b;\r\nuniform float u_tile_units_to_pixels;\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec2 v_pos;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n\r\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\r\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\r\n\r\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\r\n}\r\n"},
fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_mix;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    vec2 imagecoord = mod(v_pos_a, 1.0);\r\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\r\n    vec4 color1 = texture2D(u_image, pos);\r\n\r\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\r\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\r\n    vec4 color2 = texture2D(u_image, pos2);\r\n\r\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_scale_a;\r\nuniform float u_scale_b;\r\nuniform float u_tile_units_to_pixels;\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n\r\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\r\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\r\n}\r\n"},
fillExtrusion:{fragmentSource:"varying vec4 v_color;\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n#pragma mapbox: define highp vec4 color\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n    #pragma mapbox: initialize highp vec4 color\r\n\r\n    gl_FragColor = v_color;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",vertexSource:"uniform mat4 u_matrix;\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\nuniform float u_anim_t;\r\nuniform bool u_reversed; \r\n\r\nattribute vec2 a_pos;\r\nattribute vec3 a_normal;\r\nattribute float a_edgedistance;\r\n\r\nvarying vec4 v_color;\r\n\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n\r\n#pragma mapbox: define highp vec4 color\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n    #pragma mapbox: initialize highp vec4 color\r\n\r\n    base = max(0.0, base);\r\n\r\n    if(!u_reversed)\r\n        height = mix(0.0, height, u_anim_t);\r\n    else\r\n        height = mix(0.0, height, 1.0 - u_anim_t);\r\n\r\n    float ed = a_edgedistance; // use each attrib in order to not trip a VAO assert\r\n    float t = mod(a_normal.x, 2.0);\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\r\n\r\n    // Relative luminance (how dark/bright is the surface color?)\r\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\r\n\r\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\r\n\r\n    // Add slight ambient lighting so no extrusions are totally black\r\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\r\n    color += ambientlight;\r\n\r\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\r\n    float directional = clamp(dot(a_normal / 16384.0, u_lightpos), 0.0, 1.0);\r\n\r\n    // Adjust directional so that\r\n    // the range of values for highlight/shading is narrower\r\n    // with lower light intensity\r\n    // and with lighter/brighter surface colors\r\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\r\n\r\n    // Add gradient along z axis of side surfaces\r\n    if (a_normal.y != 0.0) {\r\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\r\n    }\r\n\r\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\r\n    // with lower bounds adjusted to hue of light\r\n    // so that shading is tinted with the complementary (opposite) color to the light color\r\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\r\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\r\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\r\n}\r\n"},
fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_mix;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec4 v_lighting;\r\n\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n\r\n    vec2 imagecoord = mod(v_pos_a, 1.0);\r\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\r\n    vec4 color1 = texture2D(u_image, pos);\r\n\r\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\r\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\r\n    vec4 color2 = texture2D(u_image, pos2);\r\n\r\n    vec4 mixedColor = mix(color1, color2, u_mix);\r\n\r\n    gl_FragColor = mixedColor * v_lighting;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pixel_coord_upper;\r\nuniform vec2 u_pixel_coord_lower;\r\nuniform float u_scale_a;\r\nuniform float u_scale_b;\r\nuniform float u_tile_units_to_pixels;\r\nuniform float u_height_factor;\r\n\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec3 a_normal;\r\nattribute float a_edgedistance;\r\n\r\nvarying vec2 v_pos_a;\r\nvarying vec2 v_pos_b;\r\nvarying vec4 v_lighting;\r\nvarying float v_directional;\r\n\r\n#pragma mapbox: define lowp float base\r\n#pragma mapbox: define lowp float height\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float base\r\n    #pragma mapbox: initialize lowp float height\r\n\r\n    base = max(0.0, base);\r\n    height = max(0.0, height);\r\n\r\n    float t = mod(a_normal.x, 2.0);\r\n    float z = t > 0.0 ? height : base;\r\n\r\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\r\n\r\n    vec2 pos = a_normal.x == 1.0 && a_normal.y == 0.0 && a_normal.z == 16384.0\r\n        ? a_pos // extrusion top\r\n        : vec2(a_edgedistance, z * u_height_factor); // extrusion side\r\n\r\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\r\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\r\n\r\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\r\n    float directional = clamp(dot(a_normal / 16383.0, u_lightpos), 0.0, 1.0);\r\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\r\n\r\n    if (a_normal.y != 0.0) {\r\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\r\n    }\r\n\r\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\r\n}\r\n"},
extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\r\nuniform float u_opacity;\r\nvarying vec2 v_pos;\r\n\r\nvoid main() {\r\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(0.0);\r\n#endif\r\n}\r\n",vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_world;\r\nattribute vec2 a_pos;\r\nvarying vec2 v_pos;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\r\n\r\n    v_pos.x = a_pos.x;\r\n    v_pos.y = 1.0 - a_pos.y;\r\n}\r\n"},
line:{fragmentSource:"#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvarying vec2 v_width2;\r\nvarying vec2 v_normal;\r\nvarying float v_gamma_scale;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    // Calculate the distance of the pixel from the line in pixels.\r\n    float dist = length(v_normal) * v_width2.s;\r\n\r\n    // Calculate the antialiasing fade factor. This is either when fading in\r\n    // the line in case of an offset line (v_width2.t) or when fading out\r\n    // (v_width2.s)\r\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\r\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\r\n\r\n    gl_FragColor = color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"\r\n\r\n// the distance over which the line edge fades out.\r\n// Retina devices need a smaller distance to avoid aliasing.\r\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\r\n\r\n// floor(127 / 2) == 63.0\r\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\r\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\r\n// there are also \"special\" normals that have a bigger length (of up to 126 in\r\n// this case).\r\n// #define scale 63.0\r\n#define scale 0.015873016\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform vec2 u_gl_units_to_pixels;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float width\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize mediump float gapwidth\r\n    #pragma mapbox: initialize lowp float offset\r\n    #pragma mapbox: initialize mediump float width\r\n\r\n    vec2 a_extrude = a_data.xy - 128.0;\r\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\r\n\r\n    // We store the texture normals in the most insignificant bit\r\n    // transform y so that 0 => -1 and 1 => 1\r\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\r\n    // y is 1 if the normal points up, and -1 if it points down\r\n    mediump vec2 normal = mod(a_pos, 2.0);\r\n    normal.y = sign(normal.y - 0.5);\r\n    v_normal = normal;\r\n\r\n\r\n    // these transformations used to be applied in the JS and native code bases. \r\n    // moved them into the shader for clarity and simplicity. \r\n    gapwidth = gapwidth / 2.0;\r\n    float halfwidth = width / 2.0;\r\n    offset = -1.0 * offset; \r\n\r\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\r\n\r\n    // Scale the extrusion vector down to a normal and then up by the line width\r\n    // of this vertex.\r\n    mediump vec2 dist = outset * a_extrude * scale;\r\n\r\n    // Calculate the offset when drawing a line that is to the side of the actual line.\r\n    // We do this by creating a vector that points towards the extrude, but rotate\r\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\r\n    // extrude vector points in another direction.\r\n    mediump float u = 0.5 * a_direction;\r\n    mediump float t = 1.0 - abs(u);\r\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\r\n\r\n    // Remove the texture normal bit to get the position\r\n    vec2 pos = floor(a_pos * 0.5);\r\n\r\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\r\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\r\n\r\n    // calculate how much the perspective view squishes or stretches the extrude\r\n    float extrude_length_without_perspective = length(dist);\r\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\r\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\r\n\r\n    v_width2 = vec2(outset, inset);\r\n}\r\n"},
linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\r\nuniform vec2 u_pattern_size_b;\r\nuniform vec2 u_pattern_tl_a;\r\nuniform vec2 u_pattern_br_a;\r\nuniform vec2 u_pattern_tl_b;\r\nuniform vec2 u_pattern_br_b;\r\nuniform vec2 u_texsize;\r\nuniform float u_fade;\r\n\r\nuniform sampler2D u_image;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_linesofar;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    // Calculate the distance of the pixel from the line in pixels.\r\n    float dist = length(v_normal) * v_width2.s;\r\n\r\n    // Calculate the antialiasing fade factor. This is either when fading in\r\n    // the line in case of an offset line (v_width2.t) or when fading out\r\n    // (v_width2.s)\r\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\r\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\r\n\r\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\r\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\r\n    float y_a = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_a.y);\r\n    float y_b = 0.5 + (v_normal.y * v_width2.s / u_pattern_size_b.y);\r\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\r\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\r\n\r\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\r\n\r\n    gl_FragColor = color * alpha * opacity;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"// floor(127 / 2) == 63.0\r\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\r\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\r\n// there are also \"special\" normals that have a bigger length (of up to 126 in\r\n// this case).\r\n// #define scale 63.0\r\n#define scale 0.015873016\r\n\r\n// We scale the distance before adding it to the buffers so that we can store\r\n// long distances for long segments. Use this value to unscale the distance.\r\n#define LINE_DISTANCE_SCALE 2.0\r\n\r\n// the distance over which the line edge fades out.\r\n// Retina devices need a smaller distance to avoid aliasing.\r\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform vec2 u_gl_units_to_pixels;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_linesofar;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define mediump float width\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize lowp float offset\r\n    #pragma mapbox: initialize mediump float gapwidth\r\n    #pragma mapbox: initialize mediump float width\r\n\r\n    vec2 a_extrude = a_data.xy - 128.0;\r\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\r\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\r\n\r\n    // We store the texture normals in the most insignificant bit\r\n    // transform y so that 0 => -1 and 1 => 1\r\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\r\n    // y is 1 if the normal points up, and -1 if it points down\r\n    mediump vec2 normal = mod(a_pos, 2.0);\r\n    normal.y = sign(normal.y - 0.5);\r\n    v_normal = normal;\r\n\r\n    // these transformations used to be applied in the JS and native code bases. \r\n    // moved them into the shader for clarity and simplicity. \r\n    gapwidth = gapwidth / 2.0;\r\n    float halfwidth = width / 2.0;\r\n    offset = -1.0 * offset; \r\n\r\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\r\n\r\n    // Scale the extrusion vector down to a normal and then up by the line width\r\n    // of this vertex.\r\n    mediump vec2 dist = outset * a_extrude * scale;\r\n\r\n    // Calculate the offset when drawing a line that is to the side of the actual line.\r\n    // We do this by creating a vector that points towards the extrude, but rotate\r\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\r\n    // extrude vector points in another direction.\r\n    mediump float u = 0.5 * a_direction;\r\n    mediump float t = 1.0 - abs(u);\r\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\r\n\r\n    // Remove the texture normal bit to get the position\r\n    vec2 pos = floor(a_pos * 0.5);\r\n\r\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\r\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\r\n\r\n    // calculate how much the perspective view squishes or stretches the extrude\r\n    float extrude_length_without_perspective = length(dist);\r\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\r\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\r\n\r\n    v_linesofar = a_linesofar;\r\n    v_width2 = vec2(outset, inset);\r\n}\r\n"},
lineSDF:{fragmentSource:"\r\nuniform sampler2D u_image;\r\nuniform float u_sdfgamma;\r\nuniform float u_mix;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_tex_a;\r\nvarying vec2 v_tex_b;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float width\r\n#pragma mapbox: define lowp float floorwidth\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize mediump float width\r\n    #pragma mapbox: initialize lowp float floorwidth\r\n\r\n    // Calculate the distance of the pixel from the line in pixels.\r\n    float dist = length(v_normal) * v_width2.s;\r\n\r\n    // Calculate the antialiasing fade factor. This is either when fading in\r\n    // the line in case of an offset line (v_width2.t) or when fading out\r\n    // (v_width2.s)\r\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\r\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\r\n\r\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\r\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\r\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\r\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\r\n\r\n    gl_FragColor = color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"// floor(127 / 2) == 63.0\r\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\r\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\r\n// there are also \"special\" normals that have a bigger length (of up to 126 in\r\n// this case).\r\n// #define scale 63.0\r\n#define scale 0.015873016\r\n\r\n// We scale the distance before adding it to the buffers so that we can store\r\n// long distances for long segments. Use this value to unscale the distance.\r\n#define LINE_DISTANCE_SCALE 2.0\r\n\r\n// the distance over which the line edge fades out.\r\n// Retina devices need a smaller distance to avoid aliasing.\r\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_data;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform vec2 u_patternscale_a;\r\nuniform float u_tex_y_a;\r\nuniform vec2 u_patternscale_b;\r\nuniform float u_tex_y_b;\r\nuniform vec2 u_gl_units_to_pixels;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying vec2 v_tex_a;\r\nvarying vec2 v_tex_b;\r\nvarying float v_gamma_scale;\r\n\r\n#pragma mapbox: define highp vec4 color\r\n#pragma mapbox: define lowp float blur\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define mediump float gapwidth\r\n#pragma mapbox: define lowp float offset\r\n#pragma mapbox: define mediump float width\r\n#pragma mapbox: define lowp float floorwidth\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 color\r\n    #pragma mapbox: initialize lowp float blur\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize mediump float gapwidth\r\n    #pragma mapbox: initialize lowp float offset\r\n    #pragma mapbox: initialize mediump float width\r\n    #pragma mapbox: initialize lowp float floorwidth\r\n\r\n    vec2 a_extrude = a_data.xy - 128.0;\r\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\r\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\r\n\r\n    // We store the texture normals in the most insignificant bit\r\n    // transform y so that 0 => -1 and 1 => 1\r\n    // In the texture normal, x is 0 if the normal points straight up/down and 1 if it's a round cap\r\n    // y is 1 if the normal points up, and -1 if it points down\r\n    mediump vec2 normal = mod(a_pos, 2.0);\r\n    normal.y = sign(normal.y - 0.5);\r\n    v_normal = normal;\r\n\r\n    // these transformations used to be applied in the JS and native code bases. \r\n    // moved them into the shader for clarity and simplicity. \r\n    gapwidth = gapwidth / 2.0;\r\n    float halfwidth = width / 2.0;\r\n    offset = -1.0 * offset;\r\n \r\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\r\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\r\n\r\n    // Scale the extrusion vector down to a normal and then up by the line width\r\n    // of this vertex.\r\n    mediump vec2 dist =outset * a_extrude * scale;\r\n\r\n    // Calculate the offset when drawing a line that is to the side of the actual line.\r\n    // We do this by creating a vector that points towards the extrude, but rotate\r\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\r\n    // extrude vector points in another direction.\r\n    mediump float u = 0.5 * a_direction;\r\n    mediump float t = 1.0 - abs(u);\r\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\r\n\r\n    // Remove the texture normal bit to get the position\r\n    vec2 pos = floor(a_pos * 0.5);\r\n\r\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\r\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\r\n\r\n    // calculate how much the perspective view squishes or stretches the extrude\r\n    float extrude_length_without_perspective = length(dist);\r\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\r\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\r\n\r\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\r\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\r\n\r\n    v_width2 = vec2(outset, inset);\r\n}\r\n"},
raster:{fragmentSource:"uniform float u_fade_t;\r\nuniform float u_opacity;\r\nuniform sampler2D u_image0;\r\nuniform sampler2D u_image1;\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nuniform float u_brightness_low;\r\nuniform float u_brightness_high;\r\n\r\nuniform float u_saturation_factor;\r\nuniform float u_contrast_factor;\r\nuniform vec3 u_spin_weights;\r\n\r\nvoid main() {\r\n\r\n    // read and cross-fade colors from the main and parent tiles\r\n    vec4 color0 = texture2D(u_image0, v_pos0);\r\n    vec4 color1 = texture2D(u_image1, v_pos1);\r\n    if (color0.a > 0.0) {\r\n        color0.rgb = color0.rgb / color0.a;\r\n    }\r\n    if (color1.a > 0.0) {\r\n        color1.rgb = color1.rgb / color1.a;\r\n    }\r\n    vec4 color = mix(color0, color1, u_fade_t);\r\n    color.a *= u_opacity;\r\n    vec3 rgb = color.rgb;\r\n\r\n    // spin\r\n    rgb = vec3(\r\n        dot(rgb, u_spin_weights.xyz),\r\n        dot(rgb, u_spin_weights.zxy),\r\n        dot(rgb, u_spin_weights.yzx));\r\n\r\n    // saturation\r\n    float average = (color.r + color.g + color.b) / 3.0;\r\n    rgb += (average - rgb) * u_saturation_factor;\r\n\r\n    // contrast\r\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\r\n\r\n    // brightness\r\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\r\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\r\n\r\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_tl_parent;\r\nuniform float u_scale_parent;\r\nuniform float u_buffer_scale;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec2 a_texture_pos;\r\n\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\r\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\r\n}\r\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\r\nuniform sampler2D u_fadetexture;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nvarying vec2 v_tex;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    lowp float alpha = texture2D(u_fadetexture, v_fade_tex).a * opacity;\r\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"const float PI = 3.141592653589793;\r\n\r\nattribute vec4 a_pos_offset;\r\nattribute vec4 a_data;\r\nattribute vec3 a_projected_pos;\r\n\r\nuniform bool u_is_size_zoom_constant;\r\nuniform bool u_is_size_feature_constant;\r\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\r\nuniform highp float u_size; // used when size is both zoom and feature constant\r\nuniform highp float u_camera_to_center_distance;\r\nuniform highp float u_pitch;\r\nuniform bool u_rotate_symbol;\r\nuniform highp float u_aspect_ratio;\r\nuniform highp float u_collision_y_stretch;\r\n\r\n#pragma mapbox: define lowp float opacity\r\n\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_label_plane_matrix;\r\nuniform mat4 u_gl_coord_matrix;\r\n\r\nuniform bool u_is_text;\r\nuniform bool u_pitch_with_map;\r\n\r\nuniform vec2 u_texsize;\r\n\r\nvarying vec2 v_tex;\r\nvarying vec2 v_fade_tex;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize lowp float opacity\r\n\r\n    vec2 a_pos = a_pos_offset.xy;\r\n    vec2 a_offset = a_pos_offset.zw;\r\n\r\n    vec2 a_tex = a_data.xy;\r\n    vec2 a_size = a_data.zw;\r\n\r\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\r\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\r\n    mediump float a_labelminzoom = angle_labelminzoom[1];\r\n\r\n    float size;\r\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\r\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        size = a_size[0] / 10.0;\r\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\r\n        size = u_size;\r\n    } else {\r\n        size = u_size;\r\n    }\r\n\r\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\r\n    highp float camera_to_anchor_distance = projectedPoint.w;\r\n    // See comments in symbol_sdf.vertex\r\n    highp float distance_ratio = u_pitch_with_map ?\r\n        camera_to_anchor_distance / u_camera_to_center_distance :\r\n        u_camera_to_center_distance / camera_to_anchor_distance;\r\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\r\n\r\n    size *= perspective_ratio;\r\n\r\n    float fontScale = u_is_text ? size / 24.0 : size;\r\n\r\n    highp float symbol_rotation = 0.0;\r\n    if (u_rotate_symbol) {\r\n        // See comments in symbol_sdf.vertex\r\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\r\n\r\n        vec2 a = projectedPoint.xy / projectedPoint.w;\r\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\r\n\r\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\r\n    }\r\n\r\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\r\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\r\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\r\n\r\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\r\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\r\n\r\n    v_tex = a_tex / u_texsize;\r\n    // See comments in symbol_sdf.vertex\r\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\r\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\r\n\r\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\r\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\r\n    v_fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\r\n}\r\n"},
symbolSDF:{fragmentSource:"#define SDF_PX 8.0\r\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\r\n\r\nuniform bool u_is_halo;\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\n\r\nuniform sampler2D u_texture;\r\nuniform sampler2D u_fadetexture;\r\nuniform highp float u_gamma_scale;\r\nuniform bool u_is_text;\r\n\r\nvarying vec4 v_data0;\r\nvarying vec2 v_data1;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 fill_color\r\n    #pragma mapbox: initialize highp vec4 halo_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize lowp float halo_width\r\n    #pragma mapbox: initialize lowp float halo_blur\r\n\r\n    vec2 tex = v_data0.xy;\r\n    vec2 fade_tex = v_data0.zw;\r\n    float gamma_scale = v_data1.x;\r\n    float size = v_data1.y;\r\n\r\n    float fontScale = u_is_text ? size / 24.0 : size;\r\n\r\n    lowp vec4 color = fill_color;\r\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\r\n    lowp float buff = (256.0 - 64.0) / 256.0;\r\n    if (u_is_halo) {\r\n        color = halo_color;\r\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\r\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\r\n    }\r\n\r\n    lowp float dist = texture2D(u_texture, tex).a;\r\n    lowp float fade_alpha = texture2D(u_fadetexture, fade_tex).a;\r\n    highp float gamma_scaled = gamma * gamma_scale;\r\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist) * fade_alpha;\r\n\r\n    gl_FragColor = color * (alpha * opacity);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"const float PI = 3.141592653589793;\r\n\r\nattribute vec4 a_pos_offset;\r\nattribute vec4 a_data;\r\nattribute vec3 a_projected_pos;\r\n\r\n// contents of a_size vary based on the type of property value\r\n// used for {text,icon}-size.\r\n// For constants, a_size is disabled.\r\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\r\n// For composite functions:\r\n// [ text-size(lowerZoomStop, feature),\r\n//   text-size(upperZoomStop, feature) ]\r\nuniform bool u_is_size_zoom_constant;\r\nuniform bool u_is_size_feature_constant;\r\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\r\nuniform highp float u_size; // used when size is both zoom and feature constant\r\n\r\n#pragma mapbox: define highp vec4 fill_color\r\n#pragma mapbox: define highp vec4 halo_color\r\n#pragma mapbox: define lowp float opacity\r\n#pragma mapbox: define lowp float halo_width\r\n#pragma mapbox: define lowp float halo_blur\r\n\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_label_plane_matrix;\r\nuniform mat4 u_gl_coord_matrix;\r\n\r\nuniform bool u_is_text;\r\nuniform bool u_pitch_with_map;\r\nuniform highp float u_pitch;\r\nuniform bool u_rotate_symbol;\r\nuniform highp float u_aspect_ratio;\r\nuniform highp float u_camera_to_center_distance;\r\nuniform highp float u_collision_y_stretch;\r\n\r\nuniform vec2 u_texsize;\r\n\r\nvarying vec4 v_data0;\r\nvarying vec2 v_data1;\r\n\r\nvoid main() {\r\n    #pragma mapbox: initialize highp vec4 fill_color\r\n    #pragma mapbox: initialize highp vec4 halo_color\r\n    #pragma mapbox: initialize lowp float opacity\r\n    #pragma mapbox: initialize lowp float halo_width\r\n    #pragma mapbox: initialize lowp float halo_blur\r\n\r\n    vec2 a_pos = a_pos_offset.xy;\r\n    vec2 a_offset = a_pos_offset.zw;\r\n\r\n    vec2 a_tex = a_data.xy;\r\n    vec2 a_size = a_data.zw;\r\n\r\n    highp vec2 angle_labelminzoom = unpack_float(a_projected_pos[2]);\r\n    highp float segment_angle = -angle_labelminzoom[0] / 255.0 * 2.0 * PI;\r\n    mediump float a_labelminzoom = angle_labelminzoom[1];\r\n    float size;\r\n\r\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\r\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\r\n        size = a_size[0] / 10.0;\r\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\r\n        size = u_size;\r\n    } else {\r\n        size = u_size;\r\n    }\r\n\r\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\r\n    highp float camera_to_anchor_distance = projectedPoint.w;\r\n    // If the label is pitched with the map, layout is done in pitched space,\r\n    // which makes labels in the distance smaller relative to viewport space.\r\n    // We counteract part of that effect by multiplying by the perspective ratio.\r\n    // If the label isn't pitched with the map, we do layout in viewport space,\r\n    // which makes labels in the distance larger relative to the features around\r\n    // them. We counteract part of that effect by dividing by the perspective ratio.\r\n    highp float distance_ratio = u_pitch_with_map ?\r\n        camera_to_anchor_distance / u_camera_to_center_distance :\r\n        u_camera_to_center_distance / camera_to_anchor_distance;\r\n    highp float perspective_ratio = 0.5 + 0.5 * distance_ratio;\r\n\r\n    size *= perspective_ratio;\r\n\r\n    float fontScale = u_is_text ? size / 24.0 : size;\r\n\r\n    highp float symbol_rotation = 0.0;\r\n    if (u_rotate_symbol) {\r\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\r\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\r\n        // space, project it, and measure its angle in projected space.\r\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\r\n\r\n        vec2 a = projectedPoint.xy / projectedPoint.w;\r\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\r\n\r\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\r\n    }\r\n\r\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\r\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\r\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\r\n\r\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\r\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 64.0 * fontScale), 0.0, 1.0);\r\n    float gamma_scale = gl_Position.w;\r\n\r\n    vec2 tex = a_tex / u_texsize;\r\n    // incidence_stretch is the ratio of how much y space a label takes up on a tile while drawn perpendicular to the viewport vs\r\n    //  how much space it would take up if it were drawn flat on the tile\r\n    // Using law of sines, camera_to_anchor/sin(ground_angle) = camera_to_center/sin(incidence_angle)\r\n    // sin(incidence_angle) = 1/incidence_stretch\r\n    // Incidence angle 90 -> head on, sin(incidence_angle) = 1, no incidence stretch\r\n    // Incidence angle 1 -> very oblique, sin(incidence_angle) =~ 0, lots of incidence stretch\r\n    // ground_angle = u_pitch + PI/2 -> sin(ground_angle) = cos(u_pitch)\r\n    // This 2D calculation is only exactly correct when gl_Position.x is in the center of the viewport,\r\n    //  but it's a close enough approximation for our purposes\r\n    highp float incidence_stretch  = camera_to_anchor_distance / (u_camera_to_center_distance * cos(u_pitch));\r\n    // incidence_stretch only applies to the y-axis, but without re-calculating the collision tile, we can't\r\n    // adjust the size of only one axis. So, we do a crude approximation at placement time to get the aspect ratio\r\n    // about right, and then do the rest of the adjustment here: there will be some extra padding on the x-axis,\r\n    // but hopefully not too much.\r\n    // Never make the adjustment less than 1.0: instead of allowing collisions on the x-axis, be conservative on\r\n    // the y-axis.\r\n    highp float collision_adjustment = max(1.0, incidence_stretch / u_collision_y_stretch);\r\n\r\n    // Floor to 1/10th zoom to dodge precision issues that can cause partially hidden labels\r\n    highp float collision_perspective_ratio = 1.0 + 0.5*((camera_to_anchor_distance / u_camera_to_center_distance) - 1.0);\r\n    highp float perspective_zoom_adjust = floor(log2(collision_perspective_ratio * collision_adjustment) * 10.0);\r\n    vec2 fade_tex = vec2((a_labelminzoom + perspective_zoom_adjust) / 255.0, 0.0);\r\n\r\n    v_data0 = vec4(tex.x, tex.y, fade_tex.x, fade_tex.y);\r\n    v_data1 = vec2(gamma_scale, size);\r\n}\r\n"},
normal:{fragmentSource:"uniform float u_fade_t;\r\nuniform float u_opacity;\r\nuniform sampler2D u_image0;\r\nuniform sampler2D u_image1;\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nuniform float u_brightness_low;\r\nuniform float u_brightness_high;\r\n\r\nuniform float u_saturation_factor;\r\nuniform float u_contrast_factor;\r\nuniform vec3 u_spin_weights;\r\n\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\n\r\nvoid main() {\r\n\r\n    // read and cross-fade colors from the main and parent tiles\r\n    vec4 color0 = texture2D(u_image0, v_pos0);\r\n    vec4 color1 = texture2D(u_image1, v_pos1);\r\n    vec3 normalC = mix(color0, color1, u_fade_t).xyz;\r\n    vec3 normal = (normalC * 2.) - 1.;\r\n    \r\n    vec4 v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\r\n    float directional = clamp(dot(normal, u_lightpos), 0.0, 1.0);\r\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\r\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\r\n\r\n    vec4 color = vec4(v_lighting.rgb, u_opacity);\r\n    vec3 rgb = v_lighting.rgb;\r\n\r\n    // spin\r\n    rgb = vec3(\r\n        dot(rgb, u_spin_weights.xyz),\r\n        dot(rgb, u_spin_weights.zxy),\r\n        dot(rgb, u_spin_weights.yzx));\r\n\r\n    // saturation\r\n    float average = (color.r + color.g + color.b) / 3.0;\r\n    rgb += (average - rgb) * u_saturation_factor;\r\n\r\n    // contrast\r\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\r\n\r\n    // brightness\r\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\r\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\r\n\r\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\r\n\r\n#ifdef OVERDRAW_INSPECTOR\r\n    gl_FragColor = vec4(1.0);\r\n#endif\r\n}\r\n",
vertexSource:"uniform mat4 u_matrix;\r\nuniform vec2 u_tl_parent;\r\nuniform float u_scale_parent;\r\nuniform float u_buffer_scale;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec2 a_texture_pos;\r\n\r\nvarying vec2 v_pos0;\r\nvarying vec2 v_pos1;\r\n\r\nvoid main() {\r\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\r\n    v_pos0 = (((a_texture_pos / 32767.0) - 0.5) / u_buffer_scale ) + 0.5;\r\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\r\n}\r\n"}};var e=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g;
a=function(a){a=p.exports[a];var d={};a.fragmentSource=a.fragmentSource.replace(e,function(a,e,m,h,b){d[b]=!0;if("define"===e)return"\n#ifndef HAS_UNIFORM_u_"+b+"\nvarying "+m+" "+h+" "+b+";\n#else\nuniform "+m+" "+h+" u_"+b+";\n#endif\n";if("initialize"===e)return"\n#ifdef HAS_UNIFORM_u_"+b+"\n    "+m+" "+h+" "+b+" = u_"+b+";\n#endif\n"});a.vertexSource=a.vertexSource.replace(e,function(a,e,m,h,b){a="float"===h?"vec2":"vec4";if(d[b]){if("define"===e)return"\n#ifndef HAS_UNIFORM_u_"+b+"\nuniform lowp float a_"+
b+"_t;\nattribute "+m+" "+a+" a_"+b+";\nvarying "+m+" "+h+" "+b+";\n#else\nuniform "+m+" "+h+" u_"+b+";\n#endif\n";if("initialize"===e)return"\n#ifndef HAS_UNIFORM_u_"+b+"\n    "+b+" = unpack_mix_"+a+"(a_"+b+", a_"+b+"_t);\n#else\n    "+m+" "+h+" "+b+" = u_"+b+";\n#endif\n"}else{if("define"===e)return"\n#ifndef HAS_UNIFORM_u_"+b+"\nuniform lowp float a_"+b+"_t;\nattribute "+m+" "+a+" a_"+b+";\n#else\nuniform "+m+" "+h+" u_"+b+";\n#endif\n";if("initialize"===e)return"\n#ifndef HAS_UNIFORM_u_"+b+"\n    "+
m+" "+h+" "+b+" = unpack_mix_"+a+"(a_"+b+", a_"+b+"_t);\n#else\n    "+m+" "+h+" "+b+" = u_"+b+";\n#endif\n"}})};for(var d in p.exports)a(d)},{}],113:[function(a,p,k){k=a("./image_source");var e=a("../util/window");a=function(a){function d(d,c,e,m){a.call(this,d,c,e,m);this.options=c;this.animate=void 0!==c.animate?c.animate:!0}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.load=function(){this.canvas=this.canvas||e.document.getElementById(this.options.canvas);
this.width=this.canvas.width;this.height=this.canvas.height;if(this._hasInvalidDimensions())return this.fire("error",Error("Canvas dimensions cannot be less than or equal to zero."));var a;this.play=function(){a=this.map.style.animationLoop.set(Infinity);this.map._rerender()};this.pause=function(){this.map.style.animationLoop.cancel(a)};this._finishLoading()};d.prototype.getCanvas=function(){return this.canvas};d.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.canvas&&this.animate&&
this.play())};d.prototype.prepare=function(){var a=!1;this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0);this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0);this._hasInvalidDimensions()||0!==Object.keys(this.tiles).length&&this._prepareImage(this.map.painter.gl,this.canvas,a)};d.prototype.serialize=function(){return{type:"canvas",canvas:this.canvas,coordinates:this.coordinates}};d.prototype._hasInvalidDimensions=function(){for(var a=0,c=[this.canvas.width,this.canvas.height];a<
c.length;a+=1){var d=c[a];if(isNaN(d)||0>=d)return!0}return!1};return d}(k);p.exports=a},{"../util/window":222,"./image_source":117}],114:[function(a,p,k){function e(a){var c=n.document.createElement("a");c.href=a;return c.href}k=a("../util/evented");var d=a("../util/util"),n=a("../util/window"),q=a("../data/extent");a=function(a){function c(c,e,b,f){a.call(this);this.id=c;this.type="geojson";this.minzoom=0;this.maxzoom=18;this.tileSize=512;this.reparseOverscaled=this.isTileClipped=!0;this.dispatcher=
b;this.setEventedParent(f);this._data=e.data;this._options=d.extend({},e);void 0!==e.maxzoom&&(this.maxzoom=e.maxzoom);e.type&&(this.type=e.type);c=q/this.tileSize;this.workerOptions=d.extend({source:this.id,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(void 0!==e.buffer?e.buffer:128)*c,tolerance:(void 0!==e.tolerance?e.tolerance:.375)*c,extent:q,maxZoom:this.maxzoom},superclusterOptions:{maxZoom:void 0!==e.clusterMaxZoom?Math.min(e.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:q,radius:(e.clusterRadius||
50)*c,log:!1}},e.workerOptions)}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;c.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"});this._updateWorkerData(function(c){c?a.fire("error",{error:c}):a.fire("data",{dataType:"source",sourceDataType:"metadata"})})};c.prototype.onAdd=function(a){this.load();this.map=a};c.prototype.setData=function(a){var c=this;this._data=a;this.fire("dataloading",{dataType:"source"});this._updateWorkerData(function(b){if(b)return c.fire("error",
{error:b});c.fire("data",{dataType:"source",sourceDataType:"content"})});return this};c.prototype._updateWorkerData=function(a){var c=this,b=d.extend({},this.workerOptions),f=this._data;"string"===typeof f?b.url=e(f):b.data=JSON.stringify(f);this.workerID=this.dispatcher.send(this.type+".loadData",b,function(b){c._loaded=!0;a(b)},this.workerID)};c.prototype.loadTile=function(a,c){var b=this,d=a.workerID&&"expired"!==a.state?"reloadTile":"loadTile",e={type:this.type,uid:a.uid,coord:a.coord,zoom:a.coord.z,
maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,overscaling:a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(a),showCollisionBoxes:this.map.showCollisionBoxes};a.workerID=this.dispatcher.send(d,e,function(d,e){a.unloadVectorData();if(!a.aborted){if(d)return c(d);a.loadVectorData(e,b.map.painter);
a.redoWhenDone&&(a.redoWhenDone=!1,a.redoPlacement(b));return c(null)}},this.workerID)};c.prototype.abortTile=function(a){a.aborted=!0};c.prototype.unloadTile=function(a){a.unloadVectorData();this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},function(){},a.workerID)};c.prototype.onRemove=function(){this.dispatcher.broadcast("removeSource",{type:this.type,source:this.id},function(){})};c.prototype.serialize=function(){return d.extend({},this._options,{type:this.type,data:this._data})};
return c}(k);p.exports=a},{"../data/extent":84,"../util/evented":228,"../util/util":241,"../util/window":222}],115:[function(a,p,k){function e(a,b){var d=a.source,e=a.coord;if(!this._geoJSONIndexes[d])return b(null,null);d=this._geoJSONIndexes[d].getTile(Math.min(e.z,a.maxZoom),e.x,e.y);if(!d)return b(null,null);d=new q(d.features);e=c(d);if(0!==e.byteOffset||e.byteLength!==e.buffer.byteLength)e=new Uint8Array(e);b(null,{vectorTile:d,rawData:e.buffer})}var d=a("../util/ajax"),n=a("geojson-rewind"),
q=a("./geojson_wrapper"),c=a("vt-pbf"),l=a("supercluster"),m=a("geojson-vt");a=function(a){function b(b,c,d){a.call(this,b,c,e);d&&(this.loadGeoJSON=d);this._geoJSONIndexes={}}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.loadData=function(a,b){var c=this;this.loadGeoJSON(a,function(d,e){if(d||!e)return b(d);if("object"!==typeof e)return b(Error("Input data is not a valid GeoJSON object."));n(e,!0);try{c._geoJSONIndexes[a.source]=a.cluster?l(a.superclusterOptions).load(e.features):
m(e,a.geojsonVtOptions)}catch(t){return b(t)}c.loaded[a.source]={};b(null)})};b.prototype.reloadTile=function(b,c){var d=this.loaded[b.source],e=b.uid;return d&&d[e]?a.prototype.reloadTile.call(this,b,c):this.loadTile(b,c)};b.prototype.loadGeoJSON=function(a,b){if(a.url)d.getJSON(a.url,b);else if("string"===typeof a.data)try{return b(null,JSON.parse(a.data))}catch(u){return b(Error("Input data is not a valid GeoJSON object."))}else return b(Error("Input data is not a valid GeoJSON object."))};b.prototype.removeSource=
function(a){this._geoJSONIndexes[a.source]&&delete this._geoJSONIndexes[a.source]};return b}(a("./vector_tile_worker_source"));p.exports=a},{"../util/ajax":219,"./geojson_wrapper":116,"./vector_tile_worker_source":131,"geojson-rewind":14,"geojson-vt":18,supercluster:59,"vt-pbf":68}],116:[function(a,p,k){var e=a("point-geometry"),d=a("vector-tile").VectorTileFeature.prototype.toGeoJSON,n=a("../data/extent"),q=function(a){this.type=a.type;if(1===a.type){this.rawGeometry=[];for(var c=0;c<a.geometry.length;c++)this.rawGeometry.push([a.geometry[c]])}else this.rawGeometry=
a.geometry;this.properties=a.tags;"id"in a&&!isNaN(a.id)&&(this.id=parseInt(a.id,10));this.extent=n};q.prototype.loadGeometry=function(){var a=this.rawGeometry;this.geometry=[];for(var d=0;d<a.length;d++){for(var m=a[d],h=[],b=0;b<m.length;b++)h.push(new e(m[b][0],m[b][1]));this.geometry.push(h)}return this.geometry};q.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var a=this.geometry,d=Infinity,e=-Infinity,h=Infinity,b=-Infinity,f=0;f<a.length;f++)for(var g=a[f],n=0;n<g.length;n++)var q=
g[n],d=Math.min(d,q.x),e=Math.max(e,q.x),h=Math.min(h,q.y),b=Math.max(b,q.y);return[d,h,e,b]};q.prototype.toGeoJSON=function(){return d.apply(this,arguments)};a=function(a){this.layers={_geojsonTileLayer:this};this.name="_geojsonTileLayer";this.extent=n;this.length=a.length;this._features=a};a.prototype.feature=function(a){return new q(this._features[a])};p.exports=a},{"../data/extent":84,"point-geometry":56,"vector-tile":64}],117:[function(a,p,k){var e=a("../util/util"),d=a("../util/window"),n=a("./tile_coord"),
q=a("../geo/lng_lat"),c=a("point-geometry");k=a("../util/evented");var l=a("../util/ajax"),m=a("../data/extent"),h=a("../data/raster_bounds_array"),b=a("../data/buffer"),f=a("../render/vertex_array_object");a=function(a){function g(b,c,d,e){a.call(this);this.id=b;this.dispatcher=d;this.coordinates=c.coordinates;this.type="image";this.minzoom=0;this.maxzoom=22;this.tileSize=512;this.tiles={};this.setEventedParent(e);this.options=c;this.textureLoaded=!1}a&&(g.__proto__=a);g.prototype=Object.create(a&&
a.prototype);g.prototype.constructor=g;g.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"});this.url=this.options.url;l.getImage(this.options.url,function(b,c){b?a.fire("error",{error:b}):c&&(a.image=c,a._finishLoading())})};g.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire("data",{dataType:"source",sourceDataType:"metadata"}))};g.prototype.onAdd=function(a){this.load();this.map=a;this.image&&this.setCoordinates(this.coordinates)};
g.prototype.setCoordinates=function(a){this.coordinates=a;var b=this.map;a=a.map(function(a){return b.transform.locationCoordinate(q.convert(a)).zoomTo(0)});var d=this.centerCoord=e.getCoordinatesCenter(a);d.column=Math.floor(d.column);d.row=Math.floor(d.row);this.coord=new n(d.zoom,d.column,d.row);this.minzoom=this.maxzoom=d.zoom;this._tileCoords=a.map(function(a){a=a.zoomTo(d.zoom);return new c(Math.round((a.column-d.column)*m),Math.round((a.row-d.row)*m))});this.fire("data",{dataType:"source",
sourceDataType:"content"});return this};g.prototype._setTile=function(a){this.tiles[String(a.coord.w)]=a;var c=new h;c.emplaceBack(this._tileCoords[0].x,this._tileCoords[0].y,0,0);c.emplaceBack(this._tileCoords[1].x,this._tileCoords[1].y,32767,0);c.emplaceBack(this._tileCoords[3].x,this._tileCoords[3].y,0,32767);c.emplaceBack(this._tileCoords[2].x,this._tileCoords[2].y,32767,32767);a.buckets={};a.boundsBuffer=b.fromStructArray(c,b.BufferType.VERTEX);a.boundsVAO=new f};g.prototype.prepare=function(){0===
Object.keys(this.tiles).length!==0&&this.image&&this._prepareImage(this.map.painter.gl,this.image)};g.prototype._prepareImage=function(a,b,c){if(!this.textureLoaded)this.textureLoaded=!0,this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),
a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b);else if(c)a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b);else if(b instanceof d.HTMLVideoElement||b instanceof d.ImageData||b instanceof d.HTMLCanvasElement)a.bindTexture(a.TEXTURE_2D,this.texture),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,b);for(var e in this.tiles)a=this.tiles[e],"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)};g.prototype.loadTile=function(a,b){this.coord&&this.coord.toString()===
a.coord.toString()?this._setTile(a):a.state="errored";b(null)};g.prototype.serialize=function(){return{type:"image",urls:this.url,coordinates:this.coordinates}};return g}(k);p.exports=a},{"../data/buffer":81,"../data/extent":84,"../data/raster_bounds_array":89,"../geo/lng_lat":92,"../render/vertex_array_object":110,"../util/ajax":219,"../util/evented":228,"../util/util":241,"../util/window":222,"./tile_coord":127,"point-geometry":56}],118:[function(a,p,k){var e=a("../util/util"),d=a("../util/ajax"),
n=a("../util/browser"),q=a("../util/mapbox").normalizeSourceURL;p.exports=function(a,l){var c=function(a,b){if(a)return l(a);var c=e.pick(b,"tiles minzoom maxzoom attribution mapbox_logo bounds".split(" "));b.vector_layers&&(c.vectorLayers=b.vector_layers,c.vectorLayerIds=c.vectorLayers.map(function(a){return a.id}));l(null,c)};a.url?d.getJSON(q(a.url),c):n.frame(c.bind(null,null,a))}},{"../util/ajax":219,"../util/browser":220,"../util/mapbox":235,"../util/util":241}],119:[function(a,p,k){var e=a("../data/extent");
p.exports=function(a,n,q){return e/(a.tileSize*Math.pow(2,q-a.coord.z))*n}},{"../data/extent":84}],120:[function(a,p,k){function e(a,d){var c=a.coord,e=d.coord;return c.z-e.z||c.y-e.y||c.w-e.w||c.x-e.x}var d=a("./tile_coord");k.rendered=function(a,d,c,l,m,h){c=a.tilesIn(c);c.sort(e);a=[];for(m=0;m<c.length;m++){var b=c[m];b.tile.featureIndex&&a.push({wrappedTileID:b.coord.wrapped().id,queryResults:b.tile.featureIndex.query({queryGeometry:b.queryGeometry,scale:b.scale,tileSize:b.tile.tileSize,bearing:h,
params:l},d)})}d={};l={};for(h=0;h<a.length;h+=1){m=a[h];c=m.queryResults;m=m.wrappedTileID;m=l[m]=l[m]||{};for(var f in c)for(var g=c[f],b=m[f]=m[f]||{},n=d[f]=d[f]||[],q=0;q<g.length;q+=1){var k=g[q];b[k.featureIndex]||(b[k.featureIndex]=!0,n.push(k.feature))}}return d};k.source=function(a,e){for(var c=a.getRenderableIds().map(function(b){return a.getTileByID(b)}),l=[],m={},h=0;h<c.length;h++){var b=c[h],f=(new d(Math.min(b.sourceMaxZoom,b.coord.z),b.coord.x,b.coord.y,0)).id;m[f]||(m[f]=!0,b.querySourceFeatures(l,
e))}return l}},{"./tile_coord":127}],121:[function(a,p,k){var e=a("../util/util"),d=a("../util/ajax");k=a("../util/evented");var n=a("./load_tilejson"),q=a("../util/mapbox").normalizeTileURL,c=a("./tile_bounds");a=function(a){function l(c,b,d,g){a.call(this);this.id=c;this.dispatcher=d;this.setEventedParent(g);this.type="raster";this.minzoom=0;this.maxzoom=22;this.roundZoom=!0;this.scheme="xyz";this.tileSize=512;this._loaded=!1;this._options=e.extend({},b);e.extend(this,e.pick(b,["url","scheme","tileSize"]))}
a&&(l.__proto__=a);l.prototype=Object.create(a&&a.prototype);l.prototype.constructor=l;l.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"});n(this._options,function(b,c){b?a.fire("error",b):c&&(e.extend(a,c),a.setBounds(c.bounds),a.fire("data",{dataType:"source",sourceDataType:"metadata"}),a.fire("data",{dataType:"source",sourceDataType:"content"}))})};l.prototype.onAdd=function(a){this.load();this.map=a};l.prototype.setBounds=function(a){if(this.bounds=a)this.tileBounds=
new c(a,this.minzoom,this.maxzoom)};l.prototype.serialize=function(){return e.extend({},this._options)};l.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a,this.maxzoom)};l.prototype.loadTile=function(a,b){var c=this,e=q(a.coord.url(this.tiles,null,this.scheme),this.url,this.tileSize);a.request=d.getImage(e,function(d,e){delete a.request;if(a.aborted)c.state="unloaded",b(null);else if(d)c.state="errored",b(d);else if(e){c.map._refreshExpiredTiles&&a.setExpiryData(e);
delete e.cacheControl;delete e.expires;var f=c.map.painter.gl;a.texture=c.map.painter.getTileTexture(e.width);a.texture?(f.bindTexture(f.TEXTURE_2D,a.texture),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,e)):(a.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,a.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR_MIPMAP_NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),c.map.painter.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,c.map.painter.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.map.painter.extTextureFilterAnisotropicMax),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,e),a.texture.size=e.width);f.generateMipmap(f.TEXTURE_2D);a.state="loaded";b(null)}})};l.prototype.abortTile=function(a){a.request&&(a.request.abort(),delete a.request)};l.prototype.unloadTile=
function(a){a.texture&&this.map.painter.saveTileTexture(a.texture)};return l}(k);p.exports=a},{"../util/ajax":219,"../util/evented":228,"../util/mapbox":235,"../util/util":241,"./load_tilejson":118,"./tile_bounds":126}],122:[function(a,p,k){var e=a("../util/ajax");k=a("../util/evented");var d=a("../util/window"),n=!1,q=null;p.exports.evented=new k;p.exports.registerForPluginAvailability=function(a){if(q)a({pluginBlobURL:q,errorCallback:p.exports.errorCallback});else p.exports.evented.once("pluginAvailable",
a);return a};p.exports.createBlobURL=function(a){return d.URL.createObjectURL(new d.Blob([a.data]),{type:"text/javascript"})};p.exports.clearRTLTextPlugin=function(){n=!1;q=null};p.exports.setRTLTextPlugin=function(a,d){if(n)throw Error("setRTLTextPlugin cannot be called multiple times.");n=!0;p.exports.errorCallback=d;e.getArrayBuffer(a,function(a,c){a?d(a):c&&(q=p.exports.createBlobURL(c),p.exports.evented.fire("pluginAvailable",{pluginBlobURL:q,errorCallback:d}))})};p.exports.applyArabicShaping=
null;p.exports.processBidirectionalText=null},{"../util/ajax":219,"../util/evented":228,"../util/window":222}],123:[function(a,p,k){var e=a("../util/util"),d={vector:a("../source/vector_tile_source"),vectoroffline:a("../source/vector_tile_offline_source"),raster:a("../source/raster_tile_source"),geojson:a("../source/geojson_source"),video:a("../source/video_source"),image:a("../source/image_source"),canvas:a("../source/canvas_source")};k.create=function(a,q,c,l){q=new d[q.type](a,q,c,l);if(q.id!==
a)throw Error("Expected Source id to be "+a+" instead of "+q.id);e.bindAll(["load","abort","unload","serialize","prepare"],q);return q};k.getType=function(a){return d[a]};k.setType=function(a,e){d[a]=e}},{"../source/canvas_source":113,"../source/geojson_source":114,"../source/image_source":117,"../source/raster_tile_source":121,"../source/vector_tile_offline_source":128,"../source/vector_tile_source":130,"../source/video_source":132,"../util/util":241}],124:[function(a,p,k){function e(a,b,c){b=c.zoomTo(Math.min(a.z,
b));return{x:(b.column-(a.x+a.w*Math.pow(2,a.z)))*f,y:(b.row-a.y)*f}}function d(a,b){return a%32-b%32}function n(a){return"raster"===a||"image"===a||"video"===a||"normal"===a}var q=a("./source"),c=a("./tile");k=a("../util/evented");var l=a("./tile_coord"),m=a("../util/lru_cache"),h=a("../geo/coordinate"),b=a("../util/util"),f=a("../data/extent");a=function(a){function g(b,c,d){a.call(this);this.id=b;this.dispatcher=d;this.on("data",function(a){"source"===a.dataType&&"metadata"===a.sourceDataType&&
(this._sourceLoaded=!0);this._sourceLoaded&&!this._paused&&"source"===a.dataType&&"content"===a.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))});this.on("error",function(){this._sourceErrored=!0});this._source=q.create(b,c,d,this);this._tiles={};this._cache=new m(0,this._unloadTile.bind(this));this._timers={};this._cacheTimers={};this._maxTileCacheSize=null;this._isIdRenderable=this._isIdRenderable.bind(this)}a&&(g.__proto__=a);g.prototype=Object.create(a&&a.prototype);
g.prototype.constructor=g;g.prototype.onAdd=function(a){this._maxTileCacheSize=(this.map=a)?a._maxTileCacheSize:null;if(this._source&&this._source.onAdd)this._source.onAdd(a)};g.prototype.onRemove=function(a){if(this._source&&this._source.onRemove)this._source.onRemove(a)};g.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var a in this._tiles){var b=this._tiles[a];if("loaded"!==b.state&&"errored"!==b.state)return!1}return!0};g.prototype.getSource=function(){return this._source};
g.prototype.pause=function(){this._paused=!0};g.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._shouldReloadOnResume=this._paused=!1;a&&this.reload();this.transform&&this.update(this.transform)}};g.prototype._loadTile=function(a,b){return this._source.loadTile(a,b)};g.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a)};g.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a)};g.prototype.serialize=
function(){return this._source.serialize()};g.prototype.prepare=function(){if(this._sourceLoaded&&this._source.prepare)return this._source.prepare()};g.prototype.getIds=function(){return Object.keys(this._tiles).map(Number).sort(d)};g.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)};g.prototype._isIdRenderable=function(a){return this._tiles[a].hasData()&&!this._coveredTiles[a]};g.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();
for(var a in this._tiles)this._reloadTile(a,"reloading")}};g.prototype._reloadTile=function(a,b){var c=this._tiles[a];c&&("loading"!==c.state&&(c.state=b),this._loadTile(c,this._tileLoaded.bind(this,c,a,b)))};g.prototype._tileLoaded=function(a,b,c,d){d?(a.state="errored",404!==d.status&&this._source.fire("error",{tile:a,error:d})):(a.sourceCache=this,a.timeAdded=(new Date).getTime(),"expired"===c&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(b,a),this._source.fire("data",{dataType:"source",
tile:a,coord:a.coord}),this.map&&(this.map.painter.tileExtentVAO.vao=null))};g.prototype.getTile=function(a){return this.getTileByID(a.id)};g.prototype.getTileByID=function(a){return this._tiles[a]};g.prototype.getZoom=function(a){return a.zoom+a.scaleZoom(a.tileSize/this._source.tileSize)};g.prototype._findLoadedChildren=function(a,b,c){var d=!1,e;for(e in this._tiles){var f=this._tiles[e];if(!(c[e]||!f.hasData()||f.coord.z<=a.z||f.coord.z>b)){var g=Math.pow(2,Math.min(f.coord.z,this._source.maxzoom)-
Math.min(a.z,this._source.maxzoom));if(Math.floor(f.coord.x/g)===a.x&&Math.floor(f.coord.y/g)===a.y)for(d=c[e]=!0;f&&f.coord.z-1>a.z;)g=f.coord.parent(this._source.maxzoom).id,(f=this._tiles[g])&&f.hasData()&&(delete c[e],c[g]=!0)}}return d};g.prototype.findLoadedParent=function(a,b,c){for(var d=a.z-1;d>=b;d--){a=a.parent(this._source.maxzoom);var e=this._tiles[a.id];if(e&&e.hasData())return c[a.id]=!0,e;if(this._cache.has(a.id))return c[a.id]=!0,this._cache.getWithoutRemoving(a.id)}};g.prototype.updateCacheSize=
function(a){a=Math.floor((Math.ceil(a.width/a.tileSize)+1)*(Math.ceil(a.height/a.tileSize)+1)*5);this._cache.setMaxSize("number"===typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,a):a)};g.prototype.update=function(a){var c=this;this.transform=a;if(this._sourceLoaded&&!this._paused){var d,e;this.updateCacheSize(a);var f=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(a)),h=Math.max(f-g.maxOverzooming,this._source.minzoom),f=Math.max(f+g.maxUnderzooming,this._source.minzoom),
m={};this._coveredTiles={};var q;this.used?this._source.coord?q=a.getVisibleWrappedCoordinates(this._source.coord):(q=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(q=q.filter(function(a){return c._source.hasTile(a)}))):q=[];for(d=0;d<q.length;d++)a=q[d],e=c._addTile(a),m[a.id]=!0,e.hasData()||c._findLoadedChildren(a,f,m)||(a=c.findLoadedParent(a,
h,m))&&c._addTile(a.coord);d={};if(n(this._source.type)){q=Object.keys(m);for(var u=0;u<q.length;u++){var k=q[u];a=l.fromID(k);(e=c._tiles[k])&&("undefined"===typeof e.fadeEndTime||e.fadeEndTime>=Date.now())&&(c._findLoadedChildren(a,f,m)&&(m[k]=!0),(a=c.findLoadedParent(a,h,d))&&c._addTile(a.coord))}}for(var p in d)m[p]||(c._coveredTiles[p]=!0);for(p in d)m[p]=!0;h=b.keysDifference(this._tiles,m);for(d=0;d<h.length;d++)c._removeTile(+h[d])}};g.prototype._addTile=function(a){var b=this._tiles[a.id];
if(b)return b;if(b=this._cache.get(a.id))b.redoPlacement(this._source),this._cacheTimers[a.id]&&(clearTimeout(this._cacheTimers[a.id]),this._cacheTimers[a.id]=void 0,this._setTileReloadTimer(a.id,b));var d=!!b;d||(b=a.z,b=new c(a,this._source.tileSize*(b>this._source.maxzoom?Math.pow(2,b-this._source.maxzoom):1),this._source.maxzoom),this._loadTile(b,this._tileLoaded.bind(this,b,a.id,b.state)));b.uses++;this._tiles[a.id]=b;d||this._source.fire("dataloading",{tile:b,coord:b.coord,dataType:"source"});
return b};g.prototype._setTileReloadTimer=function(a,b){var c=this,d=b.getExpiryTimeout();d&&(this._timers[a]=setTimeout(function(){c._reloadTile(a,"expired");c._timers[a]=void 0},d))};g.prototype._setCacheInvalidationTimer=function(a,b){var c=this,d=b.getExpiryTimeout();d&&(this._cacheTimers[a]=setTimeout(function(){c._cache.remove(a);c._cacheTimers[a]=void 0},d))};g.prototype._removeTile=function(a){var b=this._tiles[a];b&&(b.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),
this._timers[a]=void 0),0<b.uses||(b.stopPlacementThrottler(),b.hasData()?(a=b.coord.wrapped().id,this._cache.add(a,b),this._setCacheInvalidationTimer(a,b)):(b.aborted=!0,this._abortTile(b),this._unloadTile(b))))};g.prototype.clearTiles=function(){this._paused=this._shouldReloadOnResume=!1;for(var a in this._tiles)this._removeTile(a);this._cache.reset()};g.prototype.tilesIn=function(a){for(var b=[],c=this.getIds(),d=Infinity,g=Infinity,m=-Infinity,n=-Infinity,q=a[0].zoom,u=0;u<a.length;u++)var k=
a[u],d=Math.min(d,k.column),g=Math.min(g,k.row),m=Math.max(m,k.column),n=Math.max(n,k.row);for(u=0;u<c.length;u++){var k=this._tiles[c[u]],p=l.fromID(c[u]),D=[e(p,k.sourceMaxZoom,new h(d,g,q)),e(p,k.sourceMaxZoom,new h(m,n,q))];if(D[0].x<f&&D[0].y<f&&0<=D[1].x&&0<=D[1].y){for(var D=[],J=0;J<a.length;J++)D.push(e(p,k.sourceMaxZoom,a[J]));b.push({tile:k,coord:p,queryGeometry:[D],scale:Math.pow(2,this.transform.zoom-k.coord.z)})}}return b};g.prototype.redoPlacement=function(){for(var a=this.getIds(),
b=0;b<a.length;b++)this.getTileByID(a[b]).redoPlacement(this._source)};g.prototype.getVisibleCoordinates=function(){for(var a=this.getRenderableIds().map(l.fromID),b=0;b<a.length;b+=1){var c=a[b];c.posMatrix=this.transform.calculatePosMatrix(c,this._source.maxzoom)}return a};return g}(k);a.maxOverzooming=10;a.maxUnderzooming=3;p.exports=a},{"../data/extent":84,"../geo/coordinate":91,"../util/evented":228,"../util/lru_cache":234,"../util/util":241,"./source":123,"./tile":125,"./tile_coord":127}],125:[function(a,
p,k){var e=a("../util/util"),d=a("../data/bucket"),n=a("../data/feature_index"),q=a("vector-tile"),c=a("pbf"),l=a("../util/vectortile_to_geojson"),m=a("../style-spec/feature_filter"),h=a("../symbol/collision_tile"),b=a("../symbol/collision_box"),f=a("../util/throttler");a=function(a,b,c){this.coord=a;this.uid=e.uniqueId();this.uses=0;this.tileSize=b;this.sourceMaxZoom=c;this.buckets={};this.expirationTime=null;this.expiredRequestCount=0;this.state="loading";this.placementThrottler=new f(300,this._immediateRedoPlacement.bind(this))};
a.prototype.registerFadeDuration=function(a,b){var c=b+this.timeAdded;c<Date.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c,a.set(this.fadeEndTime-Date.now()))};a.prototype.loadVectorData=function(a,c){this.hasData()&&this.unloadVectorData();this.state="loaded";a&&(a.rawTileData&&(this.rawTileData=a.rawTileData),this.collisionBoxArray=new b(a.collisionBoxArray),this.collisionTile=h.deserialize(a.collisionTile,this.collisionBoxArray),this.featureIndex=n.deserialize(a.featureIndex,
this.rawTileData,this.collisionTile),this.buckets=d.deserialize(a.buckets,c.style))};a.prototype.reloadSymbolData=function(a,b){if("unloaded"!==this.state){this.collisionTile=h.deserialize(a.collisionTile,this.collisionBoxArray);this.featureIndex&&this.featureIndex.setCollisionTile(this.collisionTile);for(var c in this.buckets){var f=this.buckets[c];"symbol"===f.layers[0].type&&(f.destroy(),delete this.buckets[c])}e.extend(this.buckets,d.deserialize(a.buckets,b))}};a.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();
this.buckets={};this.featureIndex=this.collisionTile=this.collisionBoxArray=null;this.state="unloaded"};a.prototype.redoPlacement=function(a){if("vector"===a.type||"geojson"===a.type)if("loaded"!==this.state)this.redoWhenDone=!0;else if(this.collisionTile){var b=a.map.transform.cameraToTileDistance(this);if(this.angle===a.map.transform.angle&&this.pitch===a.map.transform.pitch&&this.cameraToCenterDistance===a.map.transform.cameraToCenterDistance&&this.showCollisionBoxes===a.map.showCollisionBoxes){if(this.cameraToTileDistance===
b)return;if(25>this.pitch){this.cameraToTileDistance=b;return}}this.angle=a.map.transform.angle;this.pitch=a.map.transform.pitch;this.cameraToCenterDistance=a.map.transform.cameraToCenterDistance;this.cameraToTileDistance=b;this.showCollisionBoxes=a.map.showCollisionBoxes;this.placementSource=a;this.state="reloading";this.placementThrottler.invoke()}};a.prototype._immediateRedoPlacement=function(){var a=this;this.placementSource.dispatcher.send("redoPlacement",{type:this.placementSource.type,uid:this.uid,
source:this.placementSource.id,angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,showCollisionBoxes:this.showCollisionBoxes},function(b,c){a.reloadSymbolData(c,a.placementSource.map.style);a.placementSource.map.showCollisionBoxes&&a.placementSource.fire("data",{tile:a,coord:a.coord,dataType:"source"});a.placementSource.map&&(a.placementSource.map.painter.tileExtentVAO.vao=null);a.state="loaded";a.redoWhenDone&&(a.redoWhenDone=
!1,a._immediateRedoPlacement())},this.workerID)};a.prototype.getBucket=function(a){return this.buckets[a.id]};a.prototype.querySourceFeatures=function(a,b){if(this.rawTileData){this.vtLayers||(this.vtLayers=(new q.VectorTile(new c(this.rawTileData))).layers);var d=b?b.sourceLayer:"";if(d=this.vtLayers._geojsonTileLayer||this.vtLayers[d])for(var e=m(b&&b.filter),f={z:this.coord.z,x:this.coord.x,y:this.coord.y},g=0;g<d.length;g++){var h=d.feature(g);e(h)&&(h=new l(h,this.coord.z,this.coord.x,this.coord.y),
h.tile=f,a.push(h))}}};a.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state};a.prototype.setExpiryData=function(a){var b=this.expirationTime;a.cacheControl?(a=e.parseCacheControl(a.cacheControl),a["max-age"]&&(this.expirationTime=Date.now()+1E3*a["max-age"])):a.expires&&(this.expirationTime=(new Date(a.expires)).getTime());if(this.expirationTime){a=Date.now();var c=!1;this.expirationTime>a?c=!1:b?this.expirationTime<b?c=!0:(b=this.expirationTime-
b)?this.expirationTime=a+Math.max(b,3E4):c=!0:c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}};a.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1E3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)};a.prototype.stopPlacementThrottler=function(){this.placementThrottler.stop();"reloading"===this.state&&(this.state="loaded")};p.exports=a},{"../data/bucket":75,
"../data/feature_index":85,"../style-spec/feature_filter":138,"../symbol/collision_box":186,"../symbol/collision_tile":188,"../util/throttler":239,"../util/util":241,"../util/vectortile_to_geojson":242,pbf:55,"vector-tile":64}],126:[function(a,p,k){var e=a("../geo/lng_lat_bounds"),d=a("../util/util").clamp;a=function(a,d,c){this.bounds=e.convert(this.validateBounds(a));this.minzoom=d||0;this.maxzoom=c||24};a.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,
a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]};a.prototype.contains=function(a,d){var c=d?Math.min(a.z,d):a.z,e=Math.floor(this.lngX(this.bounds.getWest(),c)),m=Math.floor(this.latY(this.bounds.getNorth(),c)),h=Math.ceil(this.lngX(this.bounds.getEast(),c)),c=Math.ceil(this.latY(this.bounds.getSouth(),c));return a.x>=e&&a.x<h&&a.y>=m&&a.y<c};a.prototype.lngX=function(a,d){return Math.pow(2,d)/360*(a+180)};a.prototype.latY=function(a,e){var c=d(Math.sin(Math.PI/180*
a),-.9999,.9999);return Math.pow(2,e-1)+.5*Math.log((1+c)/(1-c))*-(Math.pow(2,e)/(2*Math.PI))};p.exports=a},{"../geo/lng_lat_bounds":93,"../util/util":241}],127:[function(a,p,k){function e(a,b){if(a.row>b.row){var c=a;a=b;b=c}return{x0:a.column,y0:a.row,x1:b.column,y1:b.row,dx:b.column-a.column,dy:b.row-a.row}}function d(a,b,c,d,e){c=Math.max(c,Math.floor(b.y0));d=Math.min(d,Math.ceil(b.y1));if(a.x0===b.x0&&a.y0===b.y0?a.x0+b.dy/a.dy*a.dx<b.x1:a.x1-b.dy/a.dy*a.dx<b.x0){var f=a;a=b;b=f}for(var f=a.dx/
a.dy,g=b.dx/b.dy,h=0<a.dx,l=0>b.dx;c<d;c++)e(Math.floor(g*Math.max(0,Math.min(b.dy,c+l-b.y0))+b.x0),Math.ceil(f*Math.max(0,Math.min(a.dy,c+h-a.y0))+a.x0),c)}function n(a,b,c,g,l,m){var f=e(a,b);b=e(b,c);a=e(c,a);f.dy>b.dy&&(c=f,f=b,b=c);f.dy>a.dy&&(c=f,f=a,a=c);b.dy>a.dy&&(c=b,b=a,a=c);f.dy&&d(a,f,g,l,m);b.dy&&d(a,b,g,l,m)}var q=a("assert"),c=a("@mapbox/whoots-js"),l=a("../geo/coordinate"),m=function(a,b,c,d){q(!isNaN(a)&&0<=a&&0===a%1);q(!isNaN(b)&&0<=b&&0===b%1);q(!isNaN(c)&&0<=c&&0===c%1);if(void 0===
d||isNaN(d))d=0;this.z=+a;this.x=+b;this.y=+c;this.w=+d;d*=2;0>d&&(d=-1*d-1);a=1<<this.z;this.id=32*(a*a*d+a*this.y+this.x)+this.z;this.posMatrix=null};m.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};m.prototype.toCoordinate=function(a){a=Math.min(this.z,void 0===a?this.z:a);return new l(this.x+Math.pow(2,a)*this.w,this.y,a)};m.prototype.url=function(a,b,d){var e=c.getTileBBox(this.x,this.y,this.z),f;f="";for(var h,l=this.z;0<l;l--)h=1<<l-1,f+=(this.x&h?1:0)+(this.y&h?2:0);return a[(this.x+
this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(Math.min(this.z,b||this.z))).replace("{x}",String(this.x)).replace("{y}",String("tms"===d?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",e)};m.prototype.parent=function(a){return 0===this.z?null:this.z>a?new m(this.z-1,this.x,this.y,this.w):new m(this.z-1,Math.floor(this.x/2),Math.floor(this.y/2),this.w)};m.prototype.wrapped=function(){return new m(this.z,
this.x,this.y,0)};m.prototype.children=function(a){if(this.z>=a)return[new m(this.z+1,this.x,this.y,this.w)];a=this.z+1;var b=2*this.x,c=2*this.y;return[new m(a,b,c,this.w),new m(a,b+1,c,this.w),new m(a,b,c+1,this.w),new m(a,b+1,c+1,this.w)]};m.cover=function(a,b,c,d){function e(a,b,e){var h,l;if(0<=e&&e<=f)for(;a<b;a++)if(h=Math.floor(a/f),l=(a%f+f)%f,0===h||!0===d)h=new m(c,l,e,h),g[h.id]=h}void 0===d&&(d=!0);var f=1<<a,g={};n(b[0],b[1],b[2],0,f,e);n(b[2],b[3],b[0],0,f,e);return Object.keys(g).map(function(a){return g[a]})};
m.fromID=function(a){var b=a%32,c=1<<b;a=(a-b)/32;var d=a%c,e=Math.floor(a/(c*c));0!==e%2&&(e=-1*e-1);return new m(b,d,(a-d)/c%c,e/2)};p.exports=m},{"../geo/coordinate":91,"@mapbox/whoots-js":5,assert:9}],128:[function(a,p,k){a("../util/mapbox");a=function(a){function d(d,e,c,l){a.call(this,d,e,c,l);this.type="vectoroffline";if(window.sqlitePlugin)this.db=window.sqlitePlugin.openDatabase(JSON.parse(e.tiles[0]),function(){},function(){throw Error("vector tile Offline sources not opened");});else throw Error("vector tile Offline sources need cordova-sqlite-ext extended -----\x3e https://github.com/jessisena/cordova-sqlite-ext");
}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.readTile=function(a,d,c,e){return new Promise(function(l,h){e.executeSql("SELECT tile_data as myTile FROM tiles WHERE zoom_level = ? AND tile_column = ? AND tile_row = ?",[a,d,c],function(a){0<a.rows.length?l(a.rows.item(0).myTile):l(void 0)},function(a){h(a)})})};d.prototype.loadTile=function(a,d){var c=a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,e=a.coord.z<this.maxzoom?a.coord.z:
Math.floor(this.maxzoom),m=Math.pow(2,e)-1-a.coord.y,h={blob:void 0,uid:a.uid,coord:a.coord,zoom:a.coord.z,tileSize:this.tileSize*c,type:this.type,source:this.id,overscaling:c,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(a),showCollisionBoxes:this.map.showCollisionBoxes};this.readTile(e,a.coord.x,m,this.db).then(function(b){function c(b,c){if(!a.aborted){if(b)return d(b);
this.map._refreshExpiredTiles&&a.setExpiryData(c);a.loadVectorData(c,this.map.painter);a.redoWhenDone&&(a.redoWhenDone=!1,a.redoPlacement(this));d(null);a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)}}h.blob=b;a.workerID&&"expired"!==a.state?"loading"===a.state?a.reloadCallback=d:this.dispatcher.send("reloadTile",h,c.bind(this),a.workerID):a.workerID=this.dispatcher.send("loadTile",h,c.bind(this))}.bind(this),function(a){return d(a)}.bind(this))};return d}(a("./vector_tile_source"));
p.exports=a},{"../util/mapbox":235,"./vector_tile_source":130}],129:[function(a,p,k){var e=a("../util/util"),d=a("vector-tile"),n=a("pbf");k=a("./vector_tile_worker_source");var q=a("./worker_tile"),c=a("pako"),l=a("abab");a=function(a){function h(a,c,d){this.actor=a;this.layerIndex=c;d&&(this.loadVectorData=d);this.loading={};this.loaded={}}a&&(h.__proto__=a);h.prototype=Object.create(a&&a.prototype);h.prototype.constructor=h;h.prototype.loadTile=function(a,c){var b=a.source,d=a.uid;this.loading[b]||
(this.loading[b]={});var f=this.loading[b][d]=new q(a);f.abort=this.loadVectorData(a,function(a,g){delete this.loading[b][d];if(a)return c(a);if(!g)return c(null,null);f.vectorTile=g;f.parse(g,this.layerIndex,this.actor,function(a,b,d){if(a)return c(a);a={};g.expires&&(a.expires=g.expires);g.cacheControl&&(a.cacheControl=g.cacheControl);c(null,e.extend({rawTileData:g.rawData},b,a),d)});this.loaded[b]=this.loaded[b]||{};this.loaded[b][d]=f}.bind(this))};h.prototype.reloadTile=function(a,c){function b(a,
b){if(this.reloadCallback){var d=this.reloadCallback;delete this.reloadCallback;this.parse(this.vectorTile,f.layerIndex,f.actor,d)}c(a,b)}var d=this.loaded[a.source],e=a.uid,f=this;d&&d[e]&&(d=d[e],"parsing"===d.status?d.reloadCallback=c:"done"===d.status&&d.parse(d.vectorTile,this.layerIndex,this.actor,b.bind(d)))};h.prototype.abortTile=function(a){var b=this.loading[a.source];a=a.uid;b&&b[a]&&b[a].abort&&(b[a].abort(),delete b[a])};h.prototype.removeTile=function(a){var b=this.loaded[a.source];
a=a.uid;b&&b[a]&&delete b[a]};h.prototype.loadVectorData=function(a,c){this.getArrayBufferFromBlob(a.blob,function(a,b){if(a)return c(a);var e=new d.VectorTile(new n(b.data));e.rawData=b.data;e.cacheControl=b.cacheControl;e.expires=b.expires;c(a,e)}.bind(this));return function(){xhr.abort()}};h.prototype.getArrayBufferFromBlob=function(a,d){if("undefined"===typeof a)d(void 0,{data:void 0,cacheControl:null,expires:null});else{for(var b=l.atob(a),e=b.length,f=new Uint8Array(e),h=0;e>h;++h)f[h]=b.charCodeAt(h);
b=c.inflate(f);d(void 0,{data:b,cacheControl:null,expires:null})}};h.prototype.redoPlacement=function(a,c){var b=this.loaded[a.source],d=this.loading[a.source],e=a.uid;b&&b[e]?(b=b[e].redoPlacement(a.angle,a.pitch,a.cameraToCenterDistance,a.cameraToTileDistance,a.showCollisionBoxes),b.result&&c(null,b.result,b.transferables)):d&&d[e]&&(d[e].angle=a.angle)};return h}(k);p.exports=a},{"../util/util":241,"./vector_tile_worker_source":131,"./worker_tile":134,abab:6,pako:38,pbf:55,"vector-tile":64}],130:[function(a,
p,k){k=a("../util/evented");var e=a("../util/util"),d=a("./load_tilejson"),n=a("../util/mapbox").normalizeTileURL,q=a("./tile_bounds");a=function(a){function c(c,d,b,f){a.call(this);this.id=c;this.dispatcher=b;this.type="vector";this.minzoom=0;this.maxzoom=22;this.scheme="xyz";this.tileSize=512;this.isTileClipped=this.reparseOverscaled=!0;e.extend(this,e.pick(d,["url","scheme","tileSize"]));this._options=e.extend({type:"vector"},d);if(512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");
this.setEventedParent(f)}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);c.prototype.constructor=c;c.prototype.load=function(){var a=this;this.fire("dataloading",{dataType:"source"});d(this._options,function(c,b){c?a.fire("error",c):b&&(e.extend(a,b),a.setBounds(b.bounds),a.fire("data",{dataType:"source",sourceDataType:"metadata"}),a.fire("data",{dataType:"source",sourceDataType:"content"}))})};c.prototype.setBounds=function(a){if(this.bounds=a)this.tileBounds=new q(a,this.minzoom,this.maxzoom)};
c.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a,this.maxzoom)};c.prototype.onAdd=function(a){this.load();this.map=a};c.prototype.serialize=function(){return e.extend({},this._options)};c.prototype.loadTile=function(a,c){function b(b,d){if(!a.aborted){if(b)return c(b);this.map._refreshExpiredTiles&&a.setExpiryData(d);a.loadVectorData(d,this.map.painter);a.redoWhenDone&&(a.redoWhenDone=!1,a.redoPlacement(this));c(null);a.reloadCallback&&(this.loadTile(a,a.reloadCallback),
a.reloadCallback=null)}}var d=a.coord.z>this.maxzoom?Math.pow(2,a.coord.z-this.maxzoom):1,d={url:n(a.coord.url(this.tiles,this.maxzoom,this.scheme),this.url),uid:a.uid,coord:a.coord,zoom:a.coord.z,tileSize:this.tileSize*d,type:this.type,source:this.id,overscaling:d,angle:this.map.transform.angle,pitch:this.map.transform.pitch,cameraToCenterDistance:this.map.transform.cameraToCenterDistance,cameraToTileDistance:this.map.transform.cameraToTileDistance(a),showCollisionBoxes:this.map.showCollisionBoxes};
a.workerID&&"expired"!==a.state?"loading"===a.state?a.reloadCallback=c:this.dispatcher.send("reloadTile",d,b.bind(this),a.workerID):a.workerID=this.dispatcher.send("loadTile",d,b.bind(this))};c.prototype.abortTile=function(a){this.dispatcher.send("abortTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)};c.prototype.unloadTile=function(a){a.unloadVectorData();this.dispatcher.send("removeTile",{uid:a.uid,type:this.type,source:this.id},null,a.workerID)};return c}(k);p.exports=a},{"../util/evented":228,
"../util/mapbox":235,"../util/util":241,"./load_tilejson":118,"./tile_bounds":126}],131:[function(a,p,k){function e(a,c){var b=d.getArrayBuffer(a.url,function(a,b){a?c(a):b&&c(null,{vectorTile:new n.VectorTile(new q(b.data)),rawData:b.data,cacheControl:b.cacheControl,expires:b.expires})});return function(){b.abort()}}var d=a("../util/ajax"),n=a("vector-tile"),q=a("pbf"),c=a("./worker_tile"),l=a("../util/util");a=function(a,c,b){this.actor=a;this.layerIndex=c;this.loadVectorData=b||e;this.loading=
{};this.loaded={}};a.prototype.loadTile=function(a,d){var b=this,e=a.source,g=a.uid;this.loading[e]||(this.loading[e]={});var h=this.loading[e][g]=new c(a);h.abort=this.loadVectorData(a,function(a,c){delete b.loading[e][g];if(a||!c)return d(a);var f=c.rawData,m={};c.expires&&(m.expires=c.expires);c.cacheControl&&(m.cacheControl=c.cacheControl);h.vectorTile=c.vectorTile;h.parse(c.vectorTile,b.layerIndex,b.actor,function(a,b,c){if(a||!b)return d(a);d(null,l.extend({rawTileData:f},b,m),c)});b.loaded[e]=
b.loaded[e]||{};b.loaded[e][g]=h})};a.prototype.reloadTile=function(a,c){function b(a,b){if(this.reloadCallback){var d=this.reloadCallback;delete this.reloadCallback;this.parse(this.vectorTile,h.layerIndex,h.actor,d)}c(a,b)}var d=this.loaded[a.source],e=a.uid,h=this;d&&d[e]&&(d=d[e],"parsing"===d.status?d.reloadCallback=c:"done"===d.status&&d.parse(d.vectorTile,this.layerIndex,this.actor,b.bind(d)))};a.prototype.abortTile=function(a){var c=this.loading[a.source];a=a.uid;c&&c[a]&&c[a].abort&&(c[a].abort(),
delete c[a])};a.prototype.removeTile=function(a){var c=this.loaded[a.source];a=a.uid;c&&c[a]&&delete c[a]};a.prototype.redoPlacement=function(a,c){var b=this.loaded[a.source],d=this.loading[a.source],e=a.uid;b&&b[e]?(b=b[e].redoPlacement(a.angle,a.pitch,a.cameraToCenterDistance,a.cameraToTileDistance,a.showCollisionBoxes),b.result&&c(null,b.result,b.transferables)):d&&d[e]&&(d[e].angle=a.angle)};p.exports=a},{"../util/ajax":219,"../util/util":241,"./worker_tile":134,pbf:55,"vector-tile":64}],132:[function(a,
p,k){var e=a("../util/ajax");a=function(a){function d(d,c,e,m){a.call(this,d,c,e,m);this.roundZoom=!0;this.type="video";this.options=c}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.load=function(){var a=this,c=this.options;this.urls=c.urls;e.getVideo(c.urls,function(c,d){if(c)a.fire("error",{error:c});else if(d){a.video=d;a.video.loop=!0;var e;a.video.addEventListener("playing",function(){e=a.map.style.animationLoop.set(Infinity);a.map._rerender()});
a.video.addEventListener("pause",function(){a.map.style.animationLoop.cancel(e)});a.map&&a.video.play();a._finishLoading()}})};d.prototype.getVideo=function(){return this.video};d.prototype.onAdd=function(a){this.map||(this.load(),this.map=a,this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))};d.prototype.prepare=function(){0===Object.keys(this.tiles).length||2>this.video.readyState||this._prepareImage(this.map.painter.gl,this.video)};d.prototype.serialize=function(){return{type:"video",
urls:this.urls,coordinates:this.coordinates}};return d}(a("./image_source"));p.exports=a},{"../util/ajax":219,"./image_source":117}],133:[function(a,p,k){var e=a("../util/actor"),d=a("../style/style_layer_index"),n=a("./vector_tile_worker_source"),q=a("./geojson_worker_source"),c=a("./vector_tile_offline_worker_source"),l=a("assert"),m=a("./rtl_text_plugin"),h=function(a){var b=this;this.self=a;this.actor=new e(a,this);this.layerIndexes={};this.workerSourceTypes={vector:n,geojson:q,vectoroffline:c};
this.workerSources={};this.self.registerWorkerSource=function(a,c){if(b.workerSourceTypes[a])throw Error('Worker source with name "'+a+'" already registered.');b.workerSourceTypes[a]=c};this.self.registerRTLTextPlugin=function(a){if(m.applyArabicShaping||m.processBidirectionalText)throw Error("RTL text plugin already registered.");m.applyArabicShaping=a.applyArabicShaping;m.processBidirectionalText=a.processBidirectionalText}};h.prototype.setLayers=function(a,c){this.getLayerIndex(a).replace(c)};
h.prototype.updateLayers=function(a,c){this.getLayerIndex(a).update(c.layers,c.removedIds,c.symbolOrder)};h.prototype.loadTile=function(a,c,d){l(c.type);this.getWorkerSource(a,c.type).loadTile(c,d)};h.prototype.reloadTile=function(a,c,d){l(c.type);this.getWorkerSource(a,c.type).reloadTile(c,d)};h.prototype.abortTile=function(a,c){l(c.type);this.getWorkerSource(a,c.type).abortTile(c)};h.prototype.removeTile=function(a,c){l(c.type);this.getWorkerSource(a,c.type).removeTile(c)};h.prototype.removeSource=
function(a,c){l(c.type);var b=this.getWorkerSource(a,c.type);void 0!==b.removeSource&&b.removeSource(c)};h.prototype.redoPlacement=function(a,c,d){l(c.type);this.getWorkerSource(a,c.type).redoPlacement(c,d)};h.prototype.loadWorkerSource=function(a,c,d){try{this.self.importScripts(c.url),d()}catch(u){d(u)}};h.prototype.loadRTLTextPlugin=function(a,c,d){try{m.applyArabicShaping||m.processBidirectionalText||this.self.importScripts(c)}catch(u){d(u)}};h.prototype.getLayerIndex=function(a){var b=this.layerIndexes[a];
b||(b=this.layerIndexes[a]=new d);return b};h.prototype.getWorkerSource=function(a,c){var b=this;this.workerSources[a]||(this.workerSources[a]={});this.workerSources[a][c]||(this.workerSources[a][c]=new this.workerSourceTypes[c]({send:function(c,d,e,f){b.actor.send(c,d,e,f,a)}},this.getLayerIndex(a)));return this.workerSources[a][c]};p.exports=function(a){return new h(a)}},{"../style/style_layer_index":180,"../util/actor":218,"./geojson_worker_source":115,"./rtl_text_plugin":122,"./vector_tile_offline_worker_source":129,
"./vector_tile_worker_source":131,assert:9}],134:[function(a,p,k){function e(a,c){for(var b=0,d=a.layers;b<d.length;b+=1)d[b].recalculate(c)}function d(a,c){return a.filter(function(a){return!a.isEmpty()}).map(function(a){return a.serialize(c)})}var n=a("../data/feature_index"),q=a("../symbol/collision_tile"),c=a("../symbol/collision_box"),l=a("../util/dictionary_coder"),m=a("../util/util"),h=a("assert");a=function(a){this.coord=a.coord;this.uid=a.uid;this.zoom=a.zoom;this.tileSize=a.tileSize;this.source=
a.source;this.overscaling=a.overscaling;this.angle=a.angle;this.pitch=a.pitch;this.cameraToCenterDistance=a.cameraToCenterDistance;this.cameraToTileDistance=a.cameraToTileDistance;this.showCollisionBoxes=a.showCollisionBoxes};a.prototype.parse=function(a,f,g,k){var b=this;this.status="parsing";this.data=a;this.collisionBoxArray=new c;var u=new l(Object.keys(a.layers).sort()),p=new n(this.coord,this.overscaling);p.bucketLayerIDs=[];var r={},v={featureIndex:p,iconDependencies:{},glyphDependencies:{}},
C=f.familiesBySource[this.source],w;for(w in C){var A=a.layers[w];if(A){1===A.version&&m.warnOnce('Vector tile source "'+b.source+'" layer "'+w+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var y=u.encode(w),x=[],F=0;F<A.length;F++){var G=A.feature(F);x.push({feature:G,index:F,sourceLayerIndex:y})}A=0;for(y=C[w];A<y.length;A+=1)if(F=y[A],G=F[0],h(G.source===b.source),!(G.minzoom&&b.zoom<G.minzoom||G.maxzoom&&b.zoom>=G.maxzoom||G.layout&&"none"===G.layout.visibility)){for(var J=
0,B=F;J<B.length;J+=1)B[J].recalculate(b.zoom);(r[G.id]=G.createBucket({index:p.bucketLayerIDs.length,layers:F,zoom:b.zoom,overscaling:b.overscaling,collisionBoxArray:b.collisionBoxArray})).populate(x,v);p.bucketLayerIDs.push(F.map(function(a){return a.id}))}}}var K=function(a){b.status="done";p.paintPropertyStatistics={};for(var c in r)m.extend(p.paintPropertyStatistics,r[c].getPaintPropertyStatistics());c=[];k(null,{buckets:d(m.values(r),c),featureIndex:p.serialize(c),collisionTile:a.serialize(c),
collisionBoxArray:b.collisionBoxArray.serialize()},c)};this.symbolBuckets=[];for(a=f.symbolOrder.length-1;0<=a;a--)(u=r[f.symbolOrder[a]])&&b.symbolBuckets.push(u);if(0===this.symbolBuckets.length)return K(new q(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray));var I=0,E=Object.keys(v.iconDependencies),H=m.mapObject(v.glyphDependencies,function(a){return Object.keys(a).map(Number)}),L=function(a){if(a)return k(a);I++;if(2===I){a=new q(b.angle,b.pitch,
b.cameraToCenterDistance,b.cameraToTileDistance,b.collisionBoxArray);for(var c=0,d=b.symbolBuckets;c<d.length;c+=1){var f=d[c];e(f,b.zoom);f.prepare(H,E);f.place(a,b.showCollisionBoxes)}K(a)}};Object.keys(H).length?g.send("getGlyphs",{uid:this.uid,stacks:H},function(a,b){H=b;L(a)}):L();E.length?g.send("getIcons",{icons:E},function(a,b){E=b;L(a)}):L()};a.prototype.redoPlacement=function(a,c,g,h,l){this.angle=a;this.pitch=c;this.cameraToCenterDistance=g;this.cameraToTileDistance=h;if("done"!==this.status)return{};
a=new q(this.angle,this.pitch,this.cameraToCenterDistance,this.cameraToTileDistance,this.collisionBoxArray);c=0;for(g=this.symbolBuckets;c<g.length;c+=1)h=g[c],e(h,this.zoom),h.place(a,l);l=[];return{result:{buckets:d(this.symbolBuckets,l),collisionTile:a.serialize(l)},transferables:l}};p.exports=a},{"../data/feature_index":85,"../symbol/collision_box":186,"../symbol/collision_tile":188,"../util/dictionary_coder":225,"../util/util":241,assert:9}],135:[function(a,p,k){function e(a,e){var c={},l;for(l in a)"ref"!==
l&&(c[l]=a[l]);d.forEach(function(a){a in e&&(c[a]=e[a])});return c}var d=a("./util/ref_properties");p.exports=function(a){a=a.slice();for(var d=Object.create(null),c=0;c<a.length;c++)d[a[c].id]=a[c];for(c=0;c<a.length;c++)"ref"in a[c]&&(a[c]=e(a[c],d[a[c].ref]));return a}},{"./util/ref_properties":148}],136:[function(a,p,k){function e(a,b,c,d){a=a||{};b=b||{};for(var e in a)a.hasOwnProperty(e)&&!b.hasOwnProperty(e)&&(c.push({command:m.removeSource,args:[e]}),d[e]=!0);for(e in b)b.hasOwnProperty(e)&&
(a.hasOwnProperty(e)?l(a[e],b[e])||(c.push({command:m.removeSource,args:[e]}),c.push({command:m.addSource,args:[e,b[e]]}),d[e]=!0):c.push({command:m.addSource,args:[e,b[e]]}))}function d(a,b,c,d,e,m){a=a||{};b=b||{};for(var f in a)a.hasOwnProperty(f)&&(l(a[f],b[f])||c.push({command:m,args:[d,f,b[f],e]}));for(f in b)b.hasOwnProperty(f)&&!a.hasOwnProperty(f)&&(l(a[f],b[f])||c.push({command:m,args:[d,f,b[f],e]}))}function n(a){return a.id}function q(a,b){a[b.id]=b;return a}function c(a,b,c){a=a||[];
b=b||[];var e=a.map(n),f=b.map(n);a=a.reduce(q,{});b=b.reduce(q,{});var h=e.slice(),k=Object.create(null),p,r,v,C,w;for(r=p=0;p<e.length;p++)v=e[p],b.hasOwnProperty(v)?r++:(c.push({command:m.removeLayer,args:[v]}),h.splice(h.indexOf(v,r),1));for(r=p=0;p<f.length;p++)v=f[f.length-1-p],h[h.length-1-p]!==v&&(a.hasOwnProperty(v)?(c.push({command:m.removeLayer,args:[v]}),h.splice(h.lastIndexOf(v,h.length-r),1)):r++,C=h[h.length-p],c.push({command:m.addLayer,args:[b[v],C]}),h.splice(h.length-p,0,v),k[v]=
!0);for(p=0;p<f.length;p++)if(v=f[p],r=a[v],e=b[v],!k[v]&&!l(r,e))if(l(r.source,e.source)&&l(r["source-layer"],e["source-layer"])&&l(r.type,e.type)){d(r.layout,e.layout,c,v,null,m.setLayoutProperty);d(r.paint,e.paint,c,v,null,m.setPaintProperty);l(r.filter,e.filter)||c.push({command:m.setFilter,args:[v,e.filter]});l(r.minzoom,e.minzoom)&&l(r.maxzoom,e.maxzoom)||c.push({command:m.setLayerZoomRange,args:[v,e.minzoom,e.maxzoom]});for(w in r)r.hasOwnProperty(w)&&"layout"!==w&&"paint"!==w&&"filter"!==
w&&"metadata"!==w&&"minzoom"!==w&&"maxzoom"!==w&&(0===w.indexOf("paint.")?d(r[w],e[w],c,v,w.slice(6),m.setPaintProperty):l(r[w],e[w])||c.push({command:m.setLayerProperty,args:[v,w,e[w]]}));for(w in e)e.hasOwnProperty(w)&&!r.hasOwnProperty(w)&&"layout"!==w&&"paint"!==w&&"filter"!==w&&"metadata"!==w&&"minzoom"!==w&&"maxzoom"!==w&&(0===w.indexOf("paint.")?d(r[w],e[w],c,v,w.slice(6),m.setPaintProperty):l(r[w],e[w])||c.push({command:m.setLayerProperty,args:[v,w,e[w]]}))}else c.push({command:m.removeLayer,
args:[v]}),C=h[h.lastIndexOf(v)+1],c.push({command:m.addLayer,args:[e,C]})}var l=a("lodash.isequal"),m={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",
setTransition:"setTransition",setLight:"setLight"};p.exports=function(a,b){if(!a)return[{command:m.setStyle,args:[b]}];var d=[];try{if(!l(a.version,b.version))return[{command:m.setStyle,args:[b]}];l(a.center,b.center)||d.push({command:m.setCenter,args:[b.center]});l(a.zoom,b.zoom)||d.push({command:m.setZoom,args:[b.zoom]});l(a.bearing,b.bearing)||d.push({command:m.setBearing,args:[b.bearing]});l(a.pitch,b.pitch)||d.push({command:m.setPitch,args:[b.pitch]});l(a.sprite,b.sprite)||d.push({command:m.setSprite,
args:[b.sprite]});l(a.glyphs,b.glyphs)||d.push({command:m.setGlyphs,args:[b.glyphs]});l(a.transition,b.transition)||d.push({command:m.setTransition,args:[b.transition]});l(a.light,b.light)||d.push({command:m.setLight,args:[b.light]});var g={},h=[];e(a.sources,b.sources,h,g);var n=[];a.layers&&a.layers.forEach(function(a){g[a.source]?d.push({command:m.removeLayer,args:[a.id]}):n.push(a)});d=d.concat(h);c(n,b.layers,d)}catch(z){console.warn("Unable to compute style diff:",z),d=[{command:m.setStyle,
args:[b]}]}return d};p.exports.operations=m},{"lodash.isequal":34}],137:[function(a,p,k){var e=a("util").format;p.exports=function(a,n){for(var d=[],c=arguments.length-2;0<c--;)d[c]=arguments[c+2];this.message=(a?a+": ":"")+e.apply(e,d);null!==n&&void 0!==n&&n.__line__&&(this.line=n.__line__)}},{util:63}],138:[function(a,p,k){function e(a){if(!a)return"true";var b=a[0];return 1>=a.length?"any"===b?"false":"true":"("+("=="===b?n(a[1],a[2],"===",!1):"!="===b?n(a[1],a[2],"!==",!1):"<"===b||">"===b||
"<="===b||">="===b?n(a[1],a[2],b,!0):"any"===b?q(a.slice(1),"||"):"all"===b?q(a.slice(1),"&&"):"none"===b?"!("+q(a.slice(1),"||")+")":"in"===b?c(a[1],a.slice(2)):"!in"===b?"!("+c(a[1],a.slice(2))+")":"has"===b?l(a[1]):"!has"===b?"!("+l(a[1])+")":"true")+")"}function d(a){return"$type"===a?"f.type":"$id"===a?"f.id":"p["+JSON.stringify(a)+"]"}function n(a,c,e,l){var b=d(a);a="$type"===a?h.indexOf(c):JSON.stringify(c);return(l?"typeof "+b+"=== typeof "+a+"&&":"")+b+e+a}function q(a,c){return a.map(e).join(c)}
function c(a,c){"$type"===a&&(c=c.map(function(a){return h.indexOf(a)}));var b=JSON.stringify(c.sort(m)),e=d(a);return 200>=c.length?b+".indexOf("+e+") !== -1":"function(v, a, i, j) {while (i <= j) { var m = (i + j) >> 1;    if (a[m] === v) return true; if (a[m] > v) j = m - 1; else i = m + 1;}return false; }("+e+", "+b+",0,"+(c.length-1)+")"}function l(a){return"$id"===a?'"id" in f':JSON.stringify(a)+" in p"}function m(a,c){return a<c?-1:a>c?1:0}p.exports=function(a){return new Function("f","var p = (f && f.properties || {}); return "+
e(a))};var h=["Unknown","Point","LineString","Polygon"]},{}],139:[function(a,p,k){function e(a){return a>f?Math.pow(a,1/3):a/b+m}function d(a){return a>h?a*a*a:b*(a-m)}function n(a){return 255*(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function q(a){a/=255;return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)}function c(a){var b=q(a[0]),c=q(a[1]),d=q(a[2]),f=e((.4124564*b+.3575761*c+.1804375*d)/.95047),g=e((.2126729*b+.7151522*c+.072175*d)/1),b=e((.0193339*b+.119192*c+.9503041*d)/1.08883);
return[116*g-16,500*(f-g),200*(g-b),a[3]]}function l(a){var b=(a[0]+16)/116,c=isNaN(a[1])?b:b+a[1]/500,e=isNaN(a[2])?b:b-a[2]/200,b=1*d(b),c=.95047*d(c),e=1.08883*d(e);return[n(3.2404542*c-1.5371385*b-.4985314*e),n(-.969266*c+1.8760108*b+.041556*e),n(.0556434*c-.2040259*b+1.0572252*e),a[3]]}var m=4/29,h=6/29,b=3*h*h,f=h*h*h,g=Math.PI/180,u=180/Math.PI;p.exports={lab:{forward:c,reverse:l},hcl:{forward:function(a){var b=c(a),d=b[1],e=b[2],f=Math.atan2(e,d)*u;return[0>f?f+360:f,Math.sqrt(d*d+e*e),b[0],
a[3]]},reverse:function(a){var b=a[0]*g,c=a[1];return l([a[2],Math.cos(b)*c,Math.sin(b)*c,a[3]])}}}},{}],140:[function(a,p,k){function e(a){return a}function d(a,f){var h="color"===f.type,k;if(b(a)){var p=(k=a.stops&&"object"===typeof a.stops[0][0])||void 0!==a.property,p=k||!p,t=a.type||("interpolated"===f["function"]?"exponential":"interval");h&&(a=D({},a),a.stops&&(a.stops=a.stops.map(function(a){return[a[0],u(a[1])]})),a["default"]=a["default"]?u(a["default"]):u(f["default"]));var x,r,z;if("exponential"===
t)x=l;else if("interval"===t)x=c;else if("categorical"===t){x=q;r=Object.create(null);h=0;for(t=a.stops;h<t.length;h+=1){var v=t[h];r[v[0]]=v[1]}z=typeof a.stops[0][0]}else if("identity"===t)x=m;else throw Error('Unknown function type "'+t+'"');var B;if(a.colorSpace&&"rgb"!==a.colorSpace)if(g[a.colorSpace]){h=g[a.colorSpace];a=JSON.parse(JSON.stringify(a));for(t=0;t<a.stops.length;t++)a.stops[t]=[a.stops[t][0],h.forward(a.stops[t][1])];B=h.reverse}else throw Error("Unknown color space: "+a.colorSpace);
else B=e;if(k){k={};p=[];for(h=0;h<a.stops.length;h++)t=a.stops[h],v=t[0].zoom,void 0===k[v]&&(k[v]={zoom:v,type:a.type,property:a.property,"default":a["default"],stops:[]},p.push(v)),k[v].stops.push([t[0].value,t[1]]);for(var K=[],h=0;h<p.length;h+=1)t=p[h],K.push([k[t].zoom,d(k[t],f)]);k=function(b,c){return B(l({stops:K,base:a.base},f,b)(b,c))};k.isFeatureConstant=!1;k.isZoomConstant=!1}else p?(k=function(b){return B(x(a,f,b,r,z))},k.isFeatureConstant=!0,k.isZoomConstant=!1):(k=function(b,c){var d=
c[a.property];return void 0===d?n(a["default"],f["default"]):B(x(a,f,d,r,z))},k.isFeatureConstant=!1,k.isZoomConstant=!0)}else h&&a&&(a=u(a)),k=function(){return a},k.isFeatureConstant=!0,k.isZoomConstant=!0;return k}function n(a,b,c){if(void 0!==a)return a;if(void 0!==b)return b;if(void 0!==c)return c}function q(a,b,c,d,e){return n(typeof c===e?d[c]:void 0,a["default"],b["default"])}function c(a,b,c){if("number"!==z(c))return n(a["default"],b["default"]);b=a.stops.length;if(1===b||c<=a.stops[0][0])return a.stops[0][1];
if(c>=a.stops[b-1][0])return a.stops[b-1][1];c=h(a.stops,c);return a.stops[c][1]}function l(a,b,c){var d=void 0!==a.base?a.base:1;if("number"!==z(c))return n(a["default"],b["default"]);var g=a.stops.length;if(1===g||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[g-1][0])return a.stops[g-1][1];var g=h(a.stops,c),l=f(c,d,a.stops[g][0],a.stops[g+1][0]),m=a.stops[g][1],q=a.stops[g+1][1],k=t[b.type]||e;return"function"===typeof m?function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];b=
m.apply(void 0,a);a=q.apply(void 0,a);if(void 0!==b&&void 0!==a)return k(b,a,l)}:k(m,q,l)}function m(a,b,c){"color"===b.type?c=u(c):z(c)!==b.type&&(c=void 0);return n(c,a["default"],b["default"])}function h(a,b){for(var c=0,d=a.length-1,e=0,f,g;c<=d;){e=Math.floor((c+d)/2);f=a[e][0];g=a[e+1][0];if(b===f||b>f&&b<g)return e;f<b?c=e+1:f>b&&(d=e-1)}return Math.max(e-1,0)}function b(a){return"object"===typeof a&&(a.stops||"identity"===a.type)}function f(a,b,c,d){d-=c;a-=c;return 1===b?a/d:(Math.pow(b,
a)-1)/(Math.pow(b,d)-1)}var g=a("./color_spaces"),u=a("../util/parse_color"),D=a("../util/extend"),z=a("../util/get_type"),t=a("../util/interpolate");p.exports=d;p.exports.isFunctionDefinition=b;p.exports.interpolationFactor=f;p.exports.findStopLessThanOrEqualTo=h},{"../util/extend":144,"../util/get_type":145,"../util/interpolate":146,"../util/parse_color":147,"./color_spaces":139}],141:[function(a,p,k){function e(a){return n(d.map(function(c){return a[c]}))}var d=a("./util/ref_properties"),n=a("fast-stable-stringify");
p.exports=function(a){for(var c={},d=0;d<a.length;d++){var m=e(a[d]),h=c[m];h||(h=c[m]=[]);h.push(a[d])}a=[];for(var b in c)a.push(c[b]);return a}},{"./util/ref_properties":148,"fast-stable-stringify":12}],142:[function(a,p,k){p.exports=a("./v8.json")},{"./v8.json":143}],143:[function(a,p,k){p.exports={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number","default":0,
period:360,units:"degrees"},pitch:{type:"number","default":0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_tile","source_geojson","source_video","source_image","source_canvas"],source_tile:{type:{required:!0,type:"enum",values:{vector:{},vectoroffline:{},raster:{}}},url:{type:"string"},tiles:{type:"array",
value:"string"},minzoom:{type:"number","default":0},maxzoom:{type:"number","default":22},tileSize:{type:"number","default":512,units:"pixels"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number","default":18},buffer:{type:"number","default":128,maximum:512,minimum:0},tolerance:{type:"number","default":.375},cluster:{type:"boolean","default":!1},clusterRadius:{type:"number","default":50,minimum:0},clusterMaxZoom:{type:"number"}},
source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_canvas:{type:{required:!0,type:"enum",values:{canvas:{}}},coordinates:{required:!0,type:"array",length:4,
value:{type:"array",length:2,value:"number"}},animate:{type:"boolean","default":"true"},canvas:{type:"string",required:!0}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},"fill-extrusion":{},raster:{},normal:{},background:{}}},metadata:{type:"*"},ref:{type:"string"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},
paint:{type:"paint"},"paint.*":{type:"paint"}},layout:"layout_fill layout_line layout_circle layout_fill-extrusion layout_symbol layout_raster layout_background".split(" "),layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},
none:{}},"default":"visible"}},layout_line:{"line-cap":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},"default":"butt"},"line-join":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{bevel:{},round:{},miter:{}},"default":"miter"},"line-miter-limit":{type:"number","default":2,"function":"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number","default":1.05,"function":"interpolated",
"zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible"}},layout_symbol:{"symbol-placement":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},"default":"point"},"symbol-spacing":{type:"number","default":250,minimum:1,"function":"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean","function":"piecewise-constant","zoom-function":!0,
"default":!1},"icon-allow-overlap":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,requires:["icon-image"]},"icon-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},
viewport:{},auto:{}},"default":"auto",requires:["icon-image"]},"icon-size":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-text-fit":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},"default":"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,"default":[0,0,0,0],units:"pixels","function":"interpolated",
"zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number","default":2,minimum:0,"function":"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},
"icon-keep-upright":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"text-pitch-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["text-field"]},
"text-rotation-alignment":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},"default":"auto",requires:["text-field"]},"text-field":{type:"string","function":"piecewise-constant","zoom-function":!0,"property-function":!0,"default":"",tokens:!0},"text-font":{type:"array",value:"string","function":"piecewise-constant","zoom-function":!0,"default":["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number","default":16,
minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number","default":10,minimum:0,units:"ems","function":"interpolated","zoom-function":!0,requires:["text-field"]},"text-line-height":{type:"number","default":1.2,units:"ems","function":"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number","default":0,units:"ems","function":"interpolated","zoom-function":!0,"property-function":!0,
requires:["text-field"]},"text-justify":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},"default":"center",requires:["text-field"]},"text-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center",requires:["text-field"]},"text-max-angle":{type:"number",
"default":45,units:"degrees","function":"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number","default":0,period:360,units:"degrees","function":"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number","default":2,minimum:0,units:"pixels","function":"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean","function":"piecewise-constant","zoom-function":!0,
"default":!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum","function":"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},"default":"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems","function":"interpolated","zoom-function":!0,"property-function":!0,length:2,"default":[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean","function":"piecewise-constant",
"zoom-function":!0,"default":!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,requires:["text-field"]},"text-optional":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},"default":"visible"}},filter:{type:"array",
value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},"function":{stops:{type:"array",value:"function_stop"},base:{type:"number","default":1,minimum:0},property:{type:"string","default":"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},"default":"exponential"},colorSpace:{type:"enum",values:{rgb:{},
lab:{},hcl:{}},"default":"rgb"},"default":{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},light:{anchor:{type:"enum","default":"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,"function":"piecewise-constant"},position:{type:"array","default":[1.15,210,30],length:3,value:"number",transition:!0,"function":"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color","default":"#ffffff",
"function":"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number","default":.5,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:"paint_fill paint_line paint_circle paint_fill-extrusion paint_symbol paint_raster paint_background".split(" "),paint_fill:{"fill-antialias":{type:"boolean","function":"piecewise-constant","zoom-function":!0,"default":!0},"fill-opacity":{type:"number","function":"interpolated",
"zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated",
"zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},"default":"map",requires:["fill-translate"]},"fill-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,transition:!0}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!1,"default":1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",
"default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},"default":"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",
"function":"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":0,minimum:0,maximum:65535,units:"meters",transition:!0},"fill-extrusion-base":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":0,minimum:0,maximum:65535,units:"meters",transition:!0,requires:["fill-extrusion-height"]},"fill-extrusion-duration":{type:"number","default":3E3,minimum:0,
"function":"interpolated","zoom-function":!0,transition:!0,units:"milliseconds"},"fill-extrusion-animate":{type:"boolean","default":!1},"fill-extrusion-animation-reversed":{type:"boolean","default":!1}},paint_line:{"line-opacity":{type:"number","function":"interpolated","zoom-function":!0,"property-function":!0,"default":1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},
"line-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},"default":"map",requires:["line-translate"]},"line-width":{type:"number","default":1,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number","default":0,minimum:0,"function":"interpolated",
"zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number","default":0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number","function":"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},
"line-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,transition:!0}},paint_circle:{"circle-radius":{type:"number","default":5,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number","default":0,"function":"interpolated","zoom-function":!0,"property-function":!0,
transition:!0},"circle-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},"default":"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",
"function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},"default":"map"},"circle-stroke-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,
"property-function":!0,transition:!0}},paint_symbol:{"icon-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,
transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,
transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},"default":"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,"property-function":!0,
transition:!0,requires:["text-field"]},"text-halo-color":{type:"color","default":"rgba(0, 0, 0, 0)","function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number","default":0,minimum:0,"function":"interpolated","zoom-function":!0,"property-function":!0,
transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,"default":[0,0],"function":"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum","function":"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},"default":"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated",
"zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number","function":"interpolated","zoom-function":!0,"default":0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number","function":"interpolated","zoom-function":!0,"default":1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number","default":0,minimum:-1,maximum:1,"function":"interpolated",
"zoom-function":!0,transition:!0},"raster-contrast":{type:"number","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,units:"milliseconds"}},paint_normal:{"normal-opacity":{type:"number","default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0},"normal-hue-rotate":{type:"number","default":0,period:360,"function":"interpolated",
"zoom-function":!0,transition:!0,units:"degrees"},"normal-brightness-min":{type:"number","function":"interpolated","zoom-function":!0,"default":0,minimum:0,maximum:1,transition:!0},"normal-brightness-max":{type:"number","function":"interpolated","zoom-function":!0,"default":1,minimum:0,maximum:1,transition:!0},"normal-saturation":{type:"number","default":0,minimum:-1,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0},"normal-contrast":{type:"number","default":0,minimum:-1,maximum:1,
"function":"interpolated","zoom-function":!0,transition:!0},"normal-fade-duration":{type:"number","default":300,minimum:0,"function":"interpolated","zoom-function":!0,transition:!0,units:"milliseconds"}},paint_background:{"background-color":{type:"color","default":"#000000","function":"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string","function":"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",
"default":1,minimum:0,maximum:1,"function":"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number","default":300,minimum:0,units:"milliseconds"},delay:{type:"number","default":0,minimum:0,units:"milliseconds"}}}},{}],144:[function(a,p,k){p.exports=function(a){for(var d=[],e=arguments.length-1;0<e--;)d[e]=arguments[e+1];for(e=0;e<d.length;e+=1){var q=d[e],c;for(c in q)a[c]=q[c]}return a}},{}],145:[function(a,p,k){p.exports=function(a){return a instanceof Number?"number":
a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}},{}],146:[function(a,p,k){function e(a,e,q){return a*(1-q)+e*q}p.exports=e;e.number=e;e.vec2=function(a,n,q){return[e(a[0],n[0],q),e(a[1],n[1],q)]};e.color=function(a,n,q){return[e(a[0],n[0],q),e(a[1],n[1],q),e(a[2],n[2],q),e(a[3],n[3],q)]};e.array=function(a,n,q){return a.map(function(a,d){return e(a,n[d],q)})}},{}],147:[function(a,p,k){var e=a("csscolorparser").parseCSSColor;p.exports=
function(a){if("string"===typeof a)return(a=e(a))?[a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]]:void 0;if(Array.isArray(a))return a}},{csscolorparser:10}],148:[function(a,p,k){p.exports="type source source-layer minzoom maxzoom filter layout".split(" ")},{}],149:[function(a,p,k){p.exports=function(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}},{}],150:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/get_type"),n=a("../util/extend");p.exports=
function(q){var c=a("./validate_function"),l=a("./validate_object"),m={"*":function(){return[]},array:a("./validate_array"),"boolean":a("./validate_boolean"),number:a("./validate_number"),color:a("./validate_color"),constants:a("./validate_constants"),"enum":a("./validate_enum"),filter:a("./validate_filter"),"function":a("./validate_function"),layer:a("./validate_layer"),object:a("./validate_object"),source:a("./validate_source"),light:a("./validate_light"),string:a("./validate_string")},h=q.value,
b=q.valueSpec,f=q.key,g=q.styleSpec,k=q.style;if("string"===d(h)&&"@"===h[0]){if(7<g.$version)return[new e(f,h,"constants have been deprecated as of v8")];if(!(h in k.constants))return[new e(f,h,'constant "%s" not found',h)];q=n({},q,{value:k.constants[h]})}return b["function"]&&"object"===d(h)?c(q):b.type&&m[b.type]?m[b.type](q):l(n({},q,{valueSpec:b.type?g[b.type]:b}))}},{"../error/validation_error":137,"../util/extend":144,"../util/get_type":145,"./validate_array":151,"./validate_boolean":152,
"./validate_color":153,"./validate_constants":154,"./validate_enum":155,"./validate_filter":156,"./validate_function":157,"./validate_layer":159,"./validate_light":161,"./validate_number":162,"./validate_object":163,"./validate_source":166,"./validate_string":167}],151:[function(a,p,k){var e=a("../util/get_type"),d=a("./validate"),n=a("../error/validation_error");p.exports=function(a){var c=a.value,l=a.valueSpec,m=a.style,h=a.styleSpec,b=a.key;a=a.arrayElementValidator||d;if("array"!==e(c))return[new n(b,
c,"array expected, %s found",e(c))];if(l.length&&c.length!==l.length)return[new n(b,c,"array length %d expected, length %d found",l.length,c.length)];if(l["min-length"]&&c.length<l["min-length"])return[new n(b,c,"array length at least %d expected, length %d found",l["min-length"],c.length)];var f={type:l.value};7>h.$version&&(f["function"]=l["function"]);"object"===e(l.value)&&(f=l.value);for(var l=[],g=0;g<c.length;g++)l=l.concat(a({array:c,arrayIndex:g,value:c[g],valueSpec:f,style:m,styleSpec:h,
key:b+"["+g+"]"}));return l}},{"../error/validation_error":137,"../util/get_type":145,"./validate":150}],152:[function(a,p,k){var e=a("../util/get_type"),d=a("../error/validation_error");p.exports=function(a){var n=a.value;a=a.key;var c=e(n);return"boolean"!==c?[new d(a,n,"boolean expected, %s found",c)]:[]}},{"../error/validation_error":137,"../util/get_type":145}],153:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/get_type"),n=a("csscolorparser").parseCSSColor;p.exports=function(a){var c=
a.key;a=a.value;var l=d(a);return"string"!==l?[new e(c,a,"color expected, %s found",l)]:null===n(a)?[new e(c,a,'color expected, "%s" found',a)]:[]}},{"../error/validation_error":137,"../util/get_type":145,csscolorparser:10}],154:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/get_type");p.exports=function(a){var n=a.key,c=a.value;if(7<a.styleSpec.$version)return c?[new e(n,c,"constants have been deprecated as of v8")]:[];a=d(c);if("object"!==a)return[new e(n,c,"object expected, %s found",
a)];a=[];for(var l in c)"@"!==l[0]&&a.push(new e(n+"."+l,c[l],'constants must start with "@"'));return a}},{"../error/validation_error":137,"../util/get_type":145}],155:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/unbundle_jsonlint");p.exports=function(a){var n=a.key,c=a.value;a=a.valueSpec;var l=[];Array.isArray(a.values)?-1===a.values.indexOf(d(c))&&l.push(new e(n,c,"expected one of [%s], %s found",a.values.join(", "),c)):-1===Object.keys(a.values).indexOf(d(c))&&l.push(new e(n,
c,"expected one of [%s], %s found",Object.keys(a.values).join(", "),c));return l}},{"../error/validation_error":137,"../util/unbundle_jsonlint":149}],156:[function(a,p,k){var e=a("../error/validation_error"),d=a("./validate_enum"),n=a("../util/get_type"),q=a("../util/unbundle_jsonlint");p.exports=function l(a){var h=a.value,b=a.key,f=a.styleSpec,g,m=[];if("array"!==n(h))return[new e(b,h,"array expected, %s found",n(h))];if(1>h.length)return[new e(b,h,"filter array must have at least 1 element")];
m=m.concat(d({key:b+"[0]",value:h[0],valueSpec:f.filter_operator,style:a.style,styleSpec:a.styleSpec}));switch(q(h[0])){case "<":case "<=":case ">":case ">=":2<=h.length&&"$type"===q(h[1])&&m.push(new e(b,h,'"$type" cannot be use with operator "%s"',h[0]));case "==":case "!=":3!==h.length&&m.push(new e(b,h,'filter array for operator "%s" must have 3 elements',h[0]));case "in":case "!in":2<=h.length&&(g=n(h[1]),"string"!==g&&m.push(new e(b+"[1]",h[1],"string expected, %s found",g)));for(var k=2;k<
h.length;k++)g=n(h[k]),"$type"===q(h[1])?m=m.concat(d({key:b+"["+k+"]",value:h[k],valueSpec:f.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==g&&"number"!==g&&"boolean"!==g&&m.push(new e(b+"["+k+"]",h[k],"string, number, or boolean expected, %s found",g));break;case "any":case "all":case "none":for(f=1;f<h.length;f++)m=m.concat(l({key:b+"["+f+"]",value:h[f],style:a.style,styleSpec:a.styleSpec}));break;case "has":case "!has":g=n(h[1]),2!==h.length?m.push(new e(b,h,'filter array for "%s" operator must have 2 elements',
h[0])):"string"!==g&&m.push(new e(b+"[1]",h[1],"string expected, %s found",g))}return m}},{"../error/validation_error":137,"../util/get_type":145,"../util/unbundle_jsonlint":149,"./validate_enum":155}],157:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/get_type"),n=a("./validate"),q=a("./validate_object"),c=a("./validate_array"),l=a("./validate_number"),m=a("../util/unbundle_jsonlint");p.exports=function(a){function b(a){var b=[],c=a.value,h=a.key;if("array"!==d(c))return[new e(h,
c,"array expected, %s found",d(c))];if(2!==c.length)return[new e(h,c,"array length %d expected, length %d found",2,c.length)];if(w){if("object"!==d(c[0]))return[new e(h,c,"object expected, %s found",d(c[0]))];if(void 0===c[0].zoom)return[new e(h,c,"object stop key must have zoom")];if(void 0===c[0].value)return[new e(h,c,"object stop key must have value")];if(r&&r>m(c[0].zoom))return[new e(h,c[0].zoom,"stop zoom values must appear in ascending order")];m(c[0].zoom)!==r&&(r=m(c[0].zoom),t=void 0,p=
{});b=b.concat(q({key:h+"[0]",value:c[0],valueSpec:{zoom:{}},style:a.style,styleSpec:a.styleSpec,objectElementValidators:{zoom:l,value:f}}))}else b=b.concat(f({key:h+"[0]",value:c[0],valueSpec:{},style:a.style,styleSpec:a.styleSpec}));return b.concat(n({key:h+"[1]",value:c[1],valueSpec:g,style:a.style,styleSpec:a.styleSpec}))}function f(a){var b=d(a.value),c=m(a.value);if(!k)k=b;else if(b!==k)return[new e(a.key,a.value,"%s stop domain type must match previous stop domain type %s",b,k)];if("number"!==
b&&"string"!==b&&"boolean"!==b)return[new e(a.key,a.value,"stop domain value must be a number, string, or boolean")];if("number"!==b&&"categorical"!==h)return c="number expected, %s found",g["property-function"]&&void 0===h&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new e(a.key,a.value,c,b)];if("categorical"===h&&"number"===b&&(!isFinite(c)||Math.floor(c)!==c))return[new e(a.key,a.value,"integer expected, found %s",c)];if("number"===b&&void 0!==t&&c<
t)return[new e(a.key,a.value,"stop domain values must appear in ascending order")];t=c;if("categorical"===h&&c in p)return[new e(a.key,a.value,"stop domain values must be unique")];p[c]=!0;return[]}var g=a.valueSpec,h=m(a.value.type),k,p={},t,r,v="categorical"!==h&&void 0===a.value.property,C=!v,w="array"===d(a.value.stops)&&"array"===d(a.value.stops[0])&&"object"===d(a.value.stops[0][0]),A=q({key:a.key,value:a.value,valueSpec:a.styleSpec["function"],style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(a){if("identity"===
h)return[new e(a.key,a.value,'identity function may not have a "stops" property')];var f=[],g=a.value,f=f.concat(c({key:a.key,value:g,valueSpec:a.valueSpec,style:a.style,styleSpec:a.styleSpec,arrayElementValidator:b}));"array"===d(g)&&0===g.length&&f.push(new e(a.key,g,"array must have at least one stop"));return f},"default":function(a){return n({key:a.key,value:a.value,valueSpec:g,style:a.style,styleSpec:a.styleSpec})}}});"identity"===h&&v&&A.push(new e(a.key,a.value,'missing required property "property"'));
"identity"===h||a.value.stops||A.push(new e(a.key,a.value,'missing required property "stops"'));"exponential"===h&&"piecewise-constant"===a.valueSpec["function"]&&A.push(new e(a.key,a.value,"exponential functions not supported"));8<=a.styleSpec.$version&&(C&&!a.valueSpec["property-function"]?A.push(new e(a.key,a.value,"property functions not supported")):v&&!a.valueSpec["zoom-function"]&&A.push(new e(a.key,a.value,"zoom functions not supported")));"categorical"!==h&&!w||void 0!==a.value.property||
A.push(new e(a.key,a.value,'"property" property is required'));return A}},{"../error/validation_error":137,"../util/get_type":145,"../util/unbundle_jsonlint":149,"./validate":150,"./validate_array":151,"./validate_number":162,"./validate_object":163}],158:[function(a,p,k){var e=a("../error/validation_error"),d=a("./validate_string");p.exports=function(a){var n=a.value,c=a.key;a=d(a);if(a.length)return a;-1===n.indexOf("{fontstack}")&&a.push(new e(c,n,'"glyphs" url must include a "{fontstack}" token'));
-1===n.indexOf("{range}")&&a.push(new e(c,n,'"glyphs" url must include a "{range}" token'));return a}},{"../error/validation_error":137,"./validate_string":167}],159:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/unbundle_jsonlint"),n=a("./validate_object"),q=a("./validate_filter"),c=a("./validate_paint_property"),l=a("./validate_layout_property"),m=a("../util/extend");p.exports=function(a){var b=[],f=a.value,g=a.key,h=a.style,k=a.styleSpec;f.type||f.ref||b.push(new e(g,f,'either "type" or "ref" is required'));
var p=d(f.type),t=d(f.ref);if(f.id)for(var r=d(f.id),v=0;v<a.arrayIndex;v++){var C=h.layers[v];d(C.id)===r&&b.push(new e(g,f.id,'duplicate layer id "%s", previously used at line %d',f.id,C.id.__line__))}if("ref"in f){["type","source","source-layer","filter","layout"].forEach(function(a){a in f&&b.push(new e(g,f[a],'"%s" is prohibited for ref layers',a))});var w;h.layers.forEach(function(a){d(a.id)===t&&(w=a)});w?w.ref?b.push(new e(g,f.ref,"ref cannot reference another ref layer")):p=d(w.type):b.push(new e(g,
f.ref,'ref layer "%s" not found',t))}else"background"!==p&&(f.source?(r=(h=h.sources&&h.sources[f.source])&&d(h.type),h?"vector"===r&&"raster"===p?b.push(new e(g,f.source,'layer "%s" requires a raster source',f.id)):"raster"===r&&"raster"!==p&&"normal"!==p?b.push(new e(g,f.source,'layer "%s" requires a vector source',f.id)):"vector"!==r||f["source-layer"]||b.push(new e(g,f,'layer "%s" must specify a "source-layer"',f.id)):b.push(new e(g,f.source,'source "%s" not found',f.source))):b.push(new e(g,
f,'missing required property "source"')));return b=b.concat(n({key:g,value:f,valueSpec:k.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(){return[]},filter:q,layout:function(a){return n({layer:f,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return l(m({layerType:p},a))}}})},paint:function(a){return n({layer:f,key:a.key,value:a.value,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":function(a){return c(m({layerType:p},
a))}}})}}}))}},{"../error/validation_error":137,"../util/extend":144,"../util/unbundle_jsonlint":149,"./validate_filter":156,"./validate_layout_property":160,"./validate_object":163,"./validate_paint_property":164}],160:[function(a,p,k){var e=a("./validate_property");p.exports=function(a){return e(a,"layout")}},{"./validate_property":165}],161:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/get_type"),n=a("./validate");p.exports=function(a){var c=a.value,l=a.styleSpec,m=l.light;
a=a.style;var h=[],b=d(c);if(void 0===c)return h;if("object"!==b)return h=h.concat([new e("light",c,"object expected, %s found",b)]);for(var f in c)h=(b=f.match(/^(.*)-transition$/))&&m[b[1]]&&m[b[1]].transition?h.concat(n({key:f,value:c[f],valueSpec:l.transition,style:a,styleSpec:l})):m[f]?h.concat(n({key:f,value:c[f],valueSpec:m[f],style:a,styleSpec:l})):h.concat([new e(f,c[f],'unknown property "%s"',f)]);return h}},{"../error/validation_error":137,"../util/get_type":145,"./validate":150}],162:[function(a,
p,k){var e=a("../util/get_type"),d=a("../error/validation_error");p.exports=function(a){var n=a.key,c=a.value;a=a.valueSpec;var l=e(c);return"number"!==l?[new d(n,c,"number expected, %s found",l)]:"minimum"in a&&c<a.minimum?[new d(n,c,"%s is less than the minimum value %s",c,a.minimum)]:"maximum"in a&&c>a.maximum?[new d(n,c,"%s is greater than the maximum value %s",c,a.maximum)]:[]}},{"../error/validation_error":137,"../util/get_type":145}],163:[function(a,p,k){var e=a("../error/validation_error"),
d=a("../util/get_type"),n=a("./validate");p.exports=function(a){var c=a.key,l=a.value,m=a.valueSpec||{},h=a.objectElementValidators||{},b=a.style;a=a.styleSpec;var f=[],g=d(l);if("object"!==g)return[new e(c,l,"object expected, %s found",g)];for(var q in l){var k=q.split(".")[0],g=m[k]||m["*"];if(h[k])k=h[k];else if(m[k])k=n;else if(h["*"])k=h["*"];else if(m["*"])k=n;else{f.push(new e(c,l[q],'unknown property "%s"',q));continue}f=f.concat(k({key:(c?c+".":c)+q,value:l[q],valueSpec:g,style:b,styleSpec:a,
object:l,objectKey:q}))}for(var p in m)m[p].required&&void 0===m[p]["default"]&&void 0===l[p]&&f.push(new e(c,l,'missing required property "%s"',p));return f}},{"../error/validation_error":137,"../util/get_type":145,"./validate":150}],164:[function(a,p,k){var e=a("./validate_property");p.exports=function(a){return e(a,"paint")}},{"./validate_property":165}],165:[function(a,p,k){var e=a("./validate"),d=a("../error/validation_error"),n=a("../util/get_type");p.exports=function(a,c){var l=a.key,m=a.style,
h=a.styleSpec,b=a.value,f=a.objectKey,g=h[c+"_"+a.layerType];if(!g)return[];var q=f.match(/^(.*)-transition$/);if("paint"===c&&q&&g[q[1]]&&g[q[1]].transition)return e({key:l,value:b,valueSpec:h.transition,style:m,styleSpec:h});g=a.valueSpec||g[f];if(!g)return[new d(l,b,'unknown property "%s"',f)];var k;if("string"===n(b)&&g["property-function"]&&!g.tokens&&(k=/^{([^}]+)}$/.exec(b)))return[new d(l,b,'"%s" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": %s` }`.',
f,JSON.stringify(k[1]))];k=[];"symbol"===a.layerType&&"text-field"===f&&m&&!m.glyphs&&k.push(new d(l,b,'use of "text-field" requires a style "glyphs" property'));return k.concat(e({key:a.key,value:b,valueSpec:g,style:m,styleSpec:h}))}},{"../error/validation_error":137,"../util/get_type":145,"./validate":150}],166:[function(a,p,k){var e=a("../error/validation_error"),d=a("../util/unbundle_jsonlint"),n=a("./validate_object"),q=a("./validate_enum");p.exports=function(a){var c=a.value,m=a.key,h=a.styleSpec,
b=a.style;if(!c.type)return[new e(m,c,'"type" is required')];var f=[];switch(d(c.type)){case "vector":case "vectoroffline":case "raster":f=f.concat(n({key:m,value:c,valueSpec:h.source_tile,style:a.style,styleSpec:h}));if("url"in c)for(var g in c)0>["type","url","tileSize"].indexOf(g)&&f.push(new e(m+"."+g,c[g],'a source with a "url" property may not include a "%s" property',g));return f;case "geojson":return n({key:m,value:c,valueSpec:h.source_geojson,style:b,styleSpec:h});case "video":return n({key:m,
value:c,valueSpec:h.source_video,style:b,styleSpec:h});case "image":return n({key:m,value:c,valueSpec:h.source_image,style:b,styleSpec:h});case "canvas":return n({key:m,value:c,valueSpec:h.source_canvas,style:b,styleSpec:h});default:return q({key:m+".type",value:c.type,valueSpec:{values:"vector raster geojson video image canvas".split(" ")},style:b,styleSpec:h})}}},{"../error/validation_error":137,"../util/unbundle_jsonlint":149,"./validate_enum":155,"./validate_object":163}],167:[function(a,p,k){var e=
a("../util/get_type"),d=a("../error/validation_error");p.exports=function(a){var n=a.value;a=a.key;var c=e(n);return"string"!==c?[new d(a,n,"string expected, %s found",c)]:[]}},{"../error/validation_error":137,"../util/get_type":145}],168:[function(a,p,k){function e(a,b){b=b||l;var e=[],e=e.concat(c({key:"",value:a,valueSpec:b.$root,styleSpec:b,style:a,objectElementValidators:{glyphs:m,"*":function(){return[]}}}));7<b.$version&&a.constants&&(e=e.concat(q({key:"constants",value:a.constants,style:a,
styleSpec:b})));return d(e)}function d(a){return[].concat(a).sort(function(a,c){return a.line-c.line})}function n(a){return function(){return d(a.apply(this,arguments))}}var q=a("./validate/validate_constants"),c=a("./validate/validate"),l=a("./reference/latest"),m=a("./validate/validate_glyphs_url");e.source=n(a("./validate/validate_source"));e.light=n(a("./validate/validate_light"));e.layer=n(a("./validate/validate_layer"));e.filter=n(a("./validate/validate_filter"));e.paintProperty=n(a("./validate/validate_paint_property"));
e.layoutProperty=n(a("./validate/validate_layout_property"));p.exports=e},{"./reference/latest":142,"./validate/validate":150,"./validate/validate_constants":154,"./validate/validate_filter":156,"./validate/validate_glyphs_url":158,"./validate/validate_layer":159,"./validate/validate_layout_property":160,"./validate/validate_light":161,"./validate/validate_paint_property":164,"./validate/validate_source":166}],169:[function(a,p,k){a=function(){this.n=0;this.times=[]};a.prototype.stopped=function(){this.times=
this.times.filter(function(a){return a.time>=(new Date).getTime()});return!this.times.length};a.prototype.set=function(a){this.times.push({id:this.n,time:a+(new Date).getTime()});return this.n++};a.prototype.cancel=function(a){this.times=this.times.filter(function(d){return d.id!==a})};p.exports=a},{}],170:[function(a,p,k){k=a("../util/evented");var e=a("../util/ajax"),d=a("../util/browser"),n=a("../util/mapbox").normalizeSpriteURL,q=function(){this.height=this.width=this.y=this.x=0;this.pixelRatio=
1;this.sdf=!1};a=function(a){function c(c,h){var b=this;a.call(this);this.base=c;this.retina=1<d.devicePixelRatio;this.setEventedParent(h);var f=this.retina?"@2x":"";e.getJSON(n(c,f,".json"),function(a,c){a?b.fire("error",{error:a}):c&&(b.data=c,b.imgData&&b.fire("data",{dataType:"style"}))});e.getImage(n(c,f,".png"),function(a,c){a?b.fire("error",{error:a}):c&&(b.imgData=d.getImageData(c),b.width=c.width,b.data&&b.fire("data",{dataType:"style"}))})}a&&(c.__proto__=a);c.prototype=Object.create(a&&
a.prototype);c.prototype.constructor=c;c.prototype.toJSON=function(){return this.base};c.prototype.loaded=function(){return!(!this.data||!this.imgData)};c.prototype.resize=function(){var a=this;if(1<d.devicePixelRatio!==this.retina){var e=new c(this.base);e.on("data",function(){a.data=e.data;a.imgData=e.imgData;a.width=e.width;a.retina=e.retina})}};c.prototype.getSpritePosition=function(a){return this.loaded()?(a=this.data&&this.data[a])&&this.imgData?a:new q:new q};return c}(k);p.exports=a},{"../util/ajax":219,
"../util/browser":220,"../util/evented":228,"../util/mapbox":235}],171:[function(a,p,k){var e=a("../style-spec/reference/latest"),d=a("../util/util");k=a("../util/evented");var n=a("./validate_style"),q=a("./style_declaration"),c=a("./style_transition");a=function(a){function l(c){a.call(this);this.properties=["anchor","color","position","intensity"];this._specifications=e.light;this.set(c)}a&&(l.__proto__=a);l.prototype=Object.create(a&&a.prototype);l.prototype.constructor=l;l.prototype.set=function(a){if(!this._validate(n.light,
a)){this._declarations={};this._transitions={};this._transitionOptions={};this.calculated={};a=d.extend({anchor:this._specifications.anchor["default"],color:this._specifications.color["default"],position:this._specifications.position["default"],intensity:this._specifications.intensity["default"]},a);for(var b=0,c=this.properties;b<c.length;b+=1){var e=c[b];this._declarations[e]=new q(this._specifications[e],a[e])}return this}};l.prototype.getLight=function(){return{anchor:this.getLightProperty("anchor"),
color:this.getLightProperty("color"),position:this.getLightProperty("position"),intensity:this.getLightProperty("intensity")}};l.prototype.getLightProperty=function(a){return d.endsWith(a,"-transition")?this._transitionOptions[a]:this._declarations[a]&&this._declarations[a].value};l.prototype.getLightValue=function(a,b){if("position"===a){var c=this._transitions[a].calculate(b),c=d.sphericalToCartesian(c);return{x:c[0],y:c[1],z:c[2]}}return this._transitions[a].calculate(b)};l.prototype.setLight=
function(a){if(!this._validate(n.light,a))for(var b in a){var c=a[b];d.endsWith(b,"-transition")?this._transitionOptions[b]=c:null===c||void 0===c?delete this._declarations[b]:this._declarations[b]=new q(this._specifications[b],c)}};l.prototype.recalculate=function(a){for(var b in this._declarations)this.calculated[b]=this.getLightValue(b,{zoom:a})};l.prototype._applyLightDeclaration=function(a,b,e,g,l){e=e.transition?this._transitions[a]:void 0;var f=this._specifications[a];if(null===b||void 0===
b)b=new q(f,f["default"]);e&&e.declaration.json===b.json||(g=d.extend({duration:300,delay:0},g,this.getLightProperty(a+"-transition")),a=this._transitions[a]=new c(f,b,e,g),a.instant()||(a.loopID=l.set(a.endTime-Date.now())),e&&l.cancel(e.loopID))};l.prototype.updateLightTransitions=function(a,b,c){for(var d in this._declarations)this._applyLightDeclaration(d,this._declarations[d],a,b,c)};l.prototype._validate=function(a,b){return n.emitErrors(this,a.call(n,d.extend({value:b,style:{glyphs:!0,sprite:!0},
styleSpec:e})))};return l}(k);p.exports=a},{"../style-spec/reference/latest":142,"../util/evented":228,"../util/util":241,"./style_declaration":173,"./style_transition":181,"./validate_style":182}],172:[function(a,p,k){var e=a("assert");k=a("../util/evented");var d=a("./style_layer"),n=a("./image_sprite"),q=a("./light"),c=a("../symbol/glyph_source"),l=a("../symbol/sprite_atlas"),m=a("../render/line_atlas"),h=a("../util/util"),b=a("../util/ajax"),f=a("../util/mapbox"),g=a("../util/browser"),u=a("../util/dispatcher"),
D=a("./animation_loop"),z=a("./validate_style"),t=a("../source/source"),r=a("../source/query_features"),v=a("../source/source_cache"),C=a("../style-spec/reference/latest"),w=a("../style-spec/function"),A=a("../util/global_worker_pool"),y=a("../style-spec/deref"),x=a("../style-spec/diff"),F=a("../source/rtl_text_plugin"),G=h.pick(x.operations,"addLayer removeLayer setPaintProperty setLayoutProperty setFilter addSource removeSource setLayerZoomRange setLight setTransition".split(" ")),J=h.pick(x.operations,
["setCenter","setZoom","setBearing","setPitch"]);a=function(a){function k(d,e,q){var k=this;a.call(this);this.animationLoop=(this.map=e)&&e.animationLoop||new D;this.dispatcher=new u(A(),this);this.spriteAtlas=new l(1024,1024);this.spriteAtlas.setEventedParent(this);this.lineAtlas=new m(256,512);this._layers={};this._order=[];this.sourceCaches={};this.zoomHistory={};this._loaded=!1;h.bindAll(["_redoPlacement"],this);this._resetUpdates();q=h.extend({validate:"string"===typeof d?!f.isMapboxURL(d):!0},
q);this.setEventedParent(e);this.fire("dataloading",{dataType:"style"});var p=this;this._rtlTextPluginCallback=F.registerForPluginAvailability(function(a){p.dispatcher.broadcast("loadRTLTextPlugin",a.pluginBlobURL,a.errorCallback);for(var b in p.sourceCaches)p.sourceCaches[b].reload()});e=function(a,b){if(a)k.fire("error",{error:a});else if(!q.validate||!z.emitErrors(k,z(b))){k._loaded=!0;k.stylesheet=b;k.updateClasses();for(var d in b.sources)k.addSource(d,b.sources[d],q);b.sprite&&(k.sprite=new n(b.sprite,
k));k.glyphSource=new c(b.glyphs);k._resolve();k.fire("data",{dataType:"style"});k.fire("style.load")}};"string"===typeof d?b.getJSON(f.normalizeStyleURL(d),e):g.frame(e.bind(this,null,d));this.on("data",function(a){if("source"===a.dataType&&"metadata"===a.sourceDataType&&(a=!!k.sourceCaches[a.sourceId]&&k.sourceCaches[a.sourceId].getSource())&&a.vectorLayerIds)for(var b in k._layers){var c=k._layers[b];c.source===a.id&&k._validateLayer(c)}})}a&&(k.__proto__=a);k.prototype=Object.create(a&&a.prototype);
k.prototype.constructor=k;k.prototype._validateLayer=function(a){var b=this.sourceCaches[a.source];a.sourceLayer&&b&&(b=b.getSource(),("geojson"===b.type||b.vectorLayerIds&&-1===b.vectorLayerIds.indexOf(a.sourceLayer))&&this.fire("error",{error:Error('Source layer "'+a.sourceLayer+'" does not exist on source "'+b.id+'" as specified by style layer "'+a.id+'"')}))};k.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;
return this.sprite&&!this.sprite.loaded()?!1:!0};k.prototype._resolve=function(){var a=y(this.stylesheet.layers);this._order=a.map(function(a){return a.id});this._layers={};for(var b=0;b<a.length;b+=1){var c=a[b],c=d.create(c);c.setEventedParent(this,{layer:{id:c.id}});this._layers[c.id]=c}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order));this.light=new q(this.stylesheet.light)};k.prototype._serializeLayers=function(a){var b=this;return a.map(function(a){return b._layers[a].serialize()})};
k.prototype._applyClasses=function(a,b){if(this._loaded){a=a||[];b=b||{transition:!0};var c=this.stylesheet.transition||{},d=this._updatedAllPaintProps?this._layers:this._updatedPaintProps,e;for(e in d){var d=this._layers[e],f=this._updatedPaintProps[e];if(this._updatedAllPaintProps||f.all)d.updatePaintTransitions(a,b,c,this.animationLoop,this.zoomHistory);else for(var g in f)this._layers[e].updatePaintTransition(g,a,b,c,this.animationLoop,this.zoomHistory)}this.light.updateLightTransitions(b,c,this.animationLoop)}};
k.prototype._recalculate=function(a){if(this._loaded){for(var b in this.sourceCaches)this.sourceCaches[b].used=!1;this._updateZoomHistory(a);b=0;for(var c=this._order;b<c.length;b+=1){var d=this._layers[c[b]];d.recalculate(a);!d.isHidden(a)&&d.source&&(this.sourceCaches[d.source].used=!0)}this.light.recalculate(a);Math.floor(this.z)!==Math.floor(a)&&this.animationLoop.set(300);this.z=a}};k.prototype._updateZoomHistory=function(a){var b=this.zoomHistory;void 0===b.lastIntegerZoom&&(b.lastIntegerZoom=
Math.floor(a),b.lastIntegerZoomTime=0,b.lastZoom=a);Math.floor(b.lastZoom)<Math.floor(a)?(b.lastIntegerZoom=Math.floor(a),b.lastIntegerZoomTime=Date.now()):Math.floor(b.lastZoom)>Math.floor(a)&&(b.lastIntegerZoom=Math.floor(a+1),b.lastIntegerZoomTime=Date.now());b.lastZoom=a};k.prototype._checkLoaded=function(){if(!this._loaded)throw Error("Style is not done loading");};k.prototype.update=function(a,b){if(this._changed){var c=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(c.length||
d.length||this._updatedSymbolOrder)&&this._updateWorkerLayers(c,d);for(var f in this._updatedSources)c=this._updatedSources[f],e("reload"===c||"clear"===c),"reload"===c?this._reloadSource(f):"clear"===c&&this._clearSource(f);this._applyClasses(a,b);this._resetUpdates();this.fire("data",{dataType:"style"})}};k.prototype._updateWorkerLayers=function(a,b){var c=this,d=this._updatedSymbolOrder?this._order.filter(function(a){return"symbol"===c._layers[a].type}):null;this.dispatcher.broadcast("updateLayers",
{layers:this._serializeLayers(a),removedIds:b,symbolOrder:d})};k.prototype._resetUpdates=function(){this._changed=!1;this._updatedLayers={};this._removedLayers={};this._updatedSymbolOrder=!1;this._updatedSources={};this._updatedPaintProps={};this._updatedAllPaintProps=!1};k.prototype.setState=function(a){var b=this;this._checkLoaded();if(z.emitErrors(this,z(a)))return!1;a=h.extend({},a);a.layers=y(a.layers);var c=x(this.serialize(),a).filter(function(a){return!(a.command in J)});if(0===c.length)return!1;
var d=c.filter(function(a){return!(a.command in G)});if(0<d.length)throw Error("Unimplemented: "+d.map(function(a){return a.command}).join(", ")+".");c.forEach(function(a){"setTransition"!==a.command&&b[a.command].apply(b,a.args)});this.stylesheet=a;return!0};k.prototype.addSource=function(a,b,c){var d=this;this._checkLoaded();if(void 0!==this.sourceCaches[a])throw Error("There is already a source with this ID");if(!b.type)throw Error("The type property must be defined, but the only the following properties were given: "+
Object.keys(b)+".");if(!(0<="vector vectoroffline raster geojson video image canvas".split(" ").indexOf(b.type)&&this._validate(z.source,"sources."+a,b,null,c))){var e=this.sourceCaches[a]=new v(a,b,this.dispatcher);e.style=this;e.setEventedParent(this,function(){return{isSourceLoaded:d.loaded(),source:e.serialize(),sourceId:a}});e.onAdd(this.map);this._changed=!0}};k.prototype.removeSource=function(a){this._checkLoaded();if(void 0===this.sourceCaches[a])throw Error("There is no source with this ID");
var b=this.sourceCaches[a];delete this.sourceCaches[a];delete this._updatedSources[a];b.fire("data",{sourceDataType:"metadata",dataType:"source",sourceId:a});b.setEventedParent(null);b.clearTiles();if(b.onRemove)b.onRemove(this.map);this._changed=!0};k.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()};k.prototype.addLayer=function(a,b,c){this._checkLoaded();var e=a.id;"object"===typeof a.source&&(this.addSource(e,a.source),a=h.extend(a,{source:e}));this._validate(z.layer,
"layers."+e,a,{arrayIndex:-1},c)||(a=d.create(a),this._validateLayer(a),a.setEventedParent(this,{layer:{id:e}}),b=b?this._order.indexOf(b):this._order.length,this._order.splice(b,0,e),this._layers[e]=a,this._removedLayers[e]&&a.source&&(b=this._removedLayers[e],delete this._removedLayers[e],this._updatedSources[a.source]=b.type!==a.type?"clear":"reload"),this._updateLayer(a),"symbol"===a.type&&(this._updatedSymbolOrder=!0),this.updateClasses(e))};k.prototype.moveLayer=function(a,b){this._checkLoaded();
this._changed=!0;var c=this._layers[a];if(c){var d=this._order.indexOf(a);this._order.splice(d,1);d=b?this._order.indexOf(b):this._order.length;this._order.splice(d,0,a);"symbol"===c.type&&(this._updatedSymbolOrder=!0,c.source&&!this._updatedSources[c.source]&&(this._updatedSources[c.source]="reload"))}else this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be moved.")})};k.prototype.removeLayer=function(a){this._checkLoaded();var b=this._layers[a];if(b){b.setEventedParent(null);
var c=this._order.indexOf(a);this._order.splice(c,1);"symbol"===b.type&&(this._updatedSymbolOrder=!0);this._changed=!0;this._removedLayers[a]=b;delete this._layers[a];delete this._updatedLayers[a];delete this._updatedPaintProps[a]}else this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be removed.")})};k.prototype.getLayer=function(a){return this._layers[a]};k.prototype.setLayerZoomRange=function(a,b,c){this._checkLoaded();var d=this.getLayer(a);if(!d)this.fire("error",
{error:Error("The layer '"+a+"' does not exist in the map's style and cannot have zoom extent.")});else if(d.minzoom!==b||d.maxzoom!==c)null!=b&&(d.minzoom=b),null!=c&&(d.maxzoom=c),this._updateLayer(d)};k.prototype.setFilter=function(a,b){this._checkLoaded();var c=this.getLayer(a);c?null!==b&&void 0!==b&&this._validate(z.filter,"layers."+c.id+".filter",b)||h.deepEqual(c.filter,b)||(c.filter=h.clone(b),this._updateLayer(c)):this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be filtered.")})};
k.prototype.getFilter=function(a){return h.clone(this.getLayer(a).filter)};k.prototype.setLayoutProperty=function(a,b,c){this._checkLoaded();var d=this.getLayer(a);d?h.deepEqual(d.getLayoutProperty(b),c)||(d.setLayoutProperty(b,c),this._updateLayer(d)):this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")})};k.prototype.getLayoutProperty=function(a,b){return this.getLayer(a).getLayoutProperty(b)};k.prototype.setPaintProperty=function(a,b,c,d){this._checkLoaded();
var e=this.getLayer(a);if(!e)this.fire("error",{error:Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")});else if(!h.deepEqual(e.getPaintProperty(b,d),c)){var f=e.isPaintValueFeatureConstant(b);e.setPaintProperty(b,c,d);(c&&w.isFunctionDefinition(c)&&"$zoom"!==c.property&&void 0!==c.property||!f)&&this._updateLayer(e);this.updateClasses(a,b)}};k.prototype.getPaintProperty=function(a,b,c){return this.getLayer(a).getPaintProperty(b,c)};k.prototype.getTransition=function(){return h.extend({duration:300,
delay:0},this.stylesheet&&this.stylesheet.transition)};k.prototype.updateClasses=function(a,b){this._changed=!0;if(a){var c=this._updatedPaintProps;c[a]||(c[a]={});c[a][b||"all"]=!0}else this._updatedAllPaintProps=!0};k.prototype.serialize=function(){var a=this;return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,
sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._order.map(function(b){return a._layers[b].serialize()})},function(a){return void 0!==a})};k.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0;a.source&&!this._updatedSources[a.source]&&(this._updatedSources[a.source]="reload");this._changed=!0};k.prototype._flattenRenderedFeatures=function(a){for(var b=
[],c=this._order.length-1;0<=c;c--)for(var d=this._order[c],e=0,f=a;e<f.length;e+=1){var g=f[e][d];if(g)for(var h=0;h<g.length;h+=1)b.push(g[h])}return b};k.prototype.queryRenderedFeatures=function(a,b,c,d){b&&b.filter&&this._validate(z.filter,"queryRenderedFeatures.filter",b.filter);var e={};if(b&&b.layers){if(!Array.isArray(b.layers)){this.fire("error",{error:"parameters.layers must be an Array."});return}for(var f=0,g=b.layers;f<g.length;f+=1){var h=g[f],l=this._layers[h];if(!l){this.fire("error",
{error:"The layer '"+h+"' does not exist in the map's style and cannot be queried for features."});return}e[l.source]=!0}}var f=[],m;for(m in this.sourceCaches)if(!b.layers||e[m])g=r.rendered(this.sourceCaches[m],this._layers,a,b,c,d),f.push(g);return this._flattenRenderedFeatures(f)};k.prototype.querySourceFeatures=function(a,b){b&&b.filter&&this._validate(z.filter,"querySourceFeatures.filter",b.filter);var c=this.sourceCaches[a];return c?r.source(c,b):[]};k.prototype.addSourceType=function(a,b,
c){if(t.getType(a))return c(Error('A source type called "'+a+'" already exists.'));t.setType(a,b);if(!b.workerSourceURL)return c(null,null);this.dispatcher.broadcast("loadWorkerSource",{name:a,url:b.workerSourceURL},c)};k.prototype.getLight=function(){return this.light.getLight()};k.prototype.setLight=function(a,b){this._checkLoaded();var c=this.light.getLight(),d=!1,e;for(e in a)if(!h.deepEqual(a[e],c[e])){d=!0;break}d&&(c=this.stylesheet.transition||{},this.light.setLight(a),this.light.updateLightTransitions(b||
{transition:!0},c,this.animationLoop))};k.prototype._validate=function(a,b,c,d,e){return e&&!1===e.validate?!1:z.emitErrors(this,a.call(z,h.extend({key:b,style:this.serialize(),value:c,styleSpec:C},d)))};k.prototype._remove=function(){F.evented.off("pluginAvailable",this._rtlTextPluginCallback);for(var a in this.sourceCaches)this.sourceCaches[a].clearTiles();this.dispatcher.remove()};k.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()};k.prototype._reloadSource=function(a){this.sourceCaches[a].reload()};
k.prototype._updateSources=function(a){for(var b in this.sourceCaches)this.sourceCaches[b].update(a)};k.prototype._redoPlacement=function(){for(var a in this.sourceCaches)this.sourceCaches[a].redoPlacement()};k.prototype.getIcons=function(a,b,c){var d=this;a=function(){d.spriteAtlas.setSprite(d.sprite);d.spriteAtlas.addIcons(b.icons,c)};if(!this.sprite||this.sprite.loaded())a();else this.sprite.on("data",a)};k.prototype.getGlyphs=function(a,b,c){function d(a,b,d){a&&console.error(a);f[d]=b;e--;0===
e&&c(null,f)}a=b.stacks;var e=Object.keys(a).length,f={},g;for(g in a)this.glyphSource.getSimpleGlyphs(g,a[g],b.uid,d)};return k}(k);p.exports=a},{"../render/line_atlas":107,"../source/query_features":120,"../source/rtl_text_plugin":122,"../source/source":123,"../source/source_cache":124,"../style-spec/deref":135,"../style-spec/diff":136,"../style-spec/function":140,"../style-spec/reference/latest":142,"../symbol/glyph_source":191,"../symbol/sprite_atlas":196,"../util/ajax":219,"../util/browser":220,
"../util/dispatcher":226,"../util/evented":228,"../util/global_worker_pool":230,"../util/mapbox":235,"../util/util":241,"./animation_loop":169,"./image_sprite":170,"./light":171,"./style_layer":174,"./validate_style":182,assert:9}],173:[function(a,p,k){var e=a("../style-spec/function"),d=a("../util/util");a=function(a,q){this.value=d.clone(q);this.isFunction=e.isFunctionDefinition(q);this.json=JSON.stringify(this.value);this.minimum=a.minimum;this["function"]=e(this.value,a);this.isFeatureConstant=
this["function"].isFeatureConstant;this.isZoomConstant=this["function"].isZoomConstant;if(!this.isFeatureConstant&&!this.isZoomConstant){this.stopZoomLevels=[];for(var c=[],l=0,m=this.value.stops;l<m.length;l+=1){var h=m[l][0].zoom;0>this.stopZoomLevels.indexOf(h)&&(this.stopZoomLevels.push(h),c.push([h,c.length]))}this._functionInterpolationT=e({type:"exponential",stops:c,base:q.base},{type:"number"})}else if(!this.isZoomConstant)for(this.stopZoomLevels=[],c=0,l=this.value.stops;c<l.length;c+=1)m=
l[c],0>this.stopZoomLevels.indexOf(m[0])&&this.stopZoomLevels.push(m[0])};a.prototype.calculate=function(a,d){var c=this["function"](a&&a.zoom,d||{});return void 0!==this.minimum&&c<this.minimum?this.minimum:c};a.prototype.calculateInterpolationT=function(a){return this.isFeatureConstant||this.isZoomConstant?0:this._functionInterpolationT(a&&a.zoom,{})};p.exports=a},{"../style-spec/function":140,"../util/util":241}],174:[function(a,p,k){function e(a){return a.value}var d=a("../util/util"),n=a("./style_transition"),
q=a("./style_declaration"),c=a("../style-spec/reference/latest"),l=a("./validate_style"),m=a("./../style-spec/util/parse_color");k=function(a){function b(b){a.call(this);this.id=b.id;this.metadata=b.metadata;this.type=b.type;this.minzoom=b.minzoom;this.maxzoom=b.maxzoom;"background"!==b.type&&(this.source=b.source,this.sourceLayer=b["source-layer"],this.filter=b.filter);this.paint={};this.layout={};this._paintSpecifications=c["paint_"+this.type];this._layoutSpecifications=c["layout_"+this.type];this._paintTransitions=
{};this._paintTransitionOptions={};this._paintDeclarations={};this._layoutDeclarations={};this._layoutFunctions={};var d,e,f={validate:!1},g;for(g in b){var h=g.match(/^paint(?:\.(.*))?$/);if(h)for(d in h=h[1]||"",b[g])this.setPaintProperty(d,b[g][d],h,f)}for(e in b.layout)this.setLayoutProperty(e,b.layout[e],f);for(d in this._paintSpecifications)this.paint[d]=this.getPaintValue(d);for(e in this._layoutSpecifications)this._updateLayoutValue(e)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);
b.prototype.constructor=b;b.prototype.setLayoutProperty=function(a,b,c){if(null==b)delete this._layoutDeclarations[a];else{if(this._validate(l.layoutProperty,"layers."+this.id+".layout."+a,a,b,c))return;this._layoutDeclarations[a]=new q(this._layoutSpecifications[a],b)}this._updateLayoutValue(a)};b.prototype.getLayoutProperty=function(a){return this._layoutDeclarations[a]&&this._layoutDeclarations[a].value};b.prototype.getLayoutValue=function(a,b,c){var d=this._layoutSpecifications[a];return(a=this._layoutDeclarations[a])?
a.calculate(b,c):d["default"]};b.prototype.setPaintProperty=function(a,b,c,e){var f="layers."+this.id+(c?'["paint.'+c+'"].':".paint.")+a;d.endsWith(a,"-transition")?(this._paintTransitionOptions[c||""]||(this._paintTransitionOptions[c||""]={}),null===b||void 0===b?delete this._paintTransitionOptions[c||""][a]:this._validate(l.paintProperty,f,a,b,e)||(this._paintTransitionOptions[c||""][a]=b)):(this._paintDeclarations[c||""]||(this._paintDeclarations[c||""]={}),null===b||void 0===b?delete this._paintDeclarations[c||
""][a]:this._validate(l.paintProperty,f,a,b,e)||(this._paintDeclarations[c||""][a]=new q(this._paintSpecifications[a],b)))};b.prototype.getPaintProperty=function(a,b){b=b||"";return d.endsWith(a,"-transition")?this._paintTransitionOptions[b]&&this._paintTransitionOptions[b][a]:this._paintDeclarations[b]&&this._paintDeclarations[b][a]&&this._paintDeclarations[b][a].value};b.prototype.getPaintValue=function(a,b,c){var d=this._paintSpecifications[a];return(a=this._paintTransitions[a])?a.calculate(b,
c):"color"===d.type&&d["default"]?m(d["default"]):d["default"]};b.prototype.getPaintValueStopZoomLevels=function(a){return(a=this._paintTransitions[a])?a.declaration.stopZoomLevels:[]};b.prototype.getLayoutValueStopZoomLevels=function(a){return(a=this._layoutDeclarations[a])?a.stopZoomLevels:[]};b.prototype.getPaintInterpolationT=function(a,b){return this._paintTransitions[a].declaration.calculateInterpolationT(b)};b.prototype.getLayoutInterpolationT=function(a,b){return this._layoutDeclarations[a].calculateInterpolationT(b)};
b.prototype.isPaintValueFeatureConstant=function(a){return(a=this._paintTransitions[a])?a.declaration.isFeatureConstant:!0};b.prototype.isLayoutValueFeatureConstant=function(a){return(a=this._layoutDeclarations[a])?a.isFeatureConstant:!0};b.prototype.isPaintValueZoomConstant=function(a){return(a=this._paintTransitions[a])?a.declaration.isZoomConstant:!0};b.prototype.isLayoutValueZoomConstant=function(a){return(a=this._layoutDeclarations[a])?a.isZoomConstant:!0};b.prototype.isHidden=function(a){return this.minzoom&&
a<this.minzoom||this.maxzoom&&a>=this.maxzoom||"none"===this.layout.visibility?!0:!1};b.prototype.updatePaintTransitions=function(a,b,c,e,f){for(var g=d.extend({},this._paintDeclarations[""]),h=0;h<a.length;h++)d.extend(g,this._paintDeclarations[a[h]]);for(var l in g)this._applyPaintDeclaration(l,g[l],b,c,e,f);for(l in this._paintTransitions)l in g||this._applyPaintDeclaration(l,null,b,c,e,f)};b.prototype.updatePaintTransition=function(a,b,c,d,e,f){for(var g=this._paintDeclarations[""][a],h=0;h<b.length;h++){var l=
this._paintDeclarations[b[h]];l&&l[a]&&(g=l[a])}this._applyPaintDeclaration(a,g,c,d,e,f)};b.prototype.recalculate=function(a){for(var b in this._paintTransitions)this.paint[b]=this.getPaintValue(b,{zoom:a});for(var c in this._layoutFunctions)this.layout[c]=this.getLayoutValue(c,{zoom:a})};b.prototype.serialize=function(){var a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:d.mapObject(this._layoutDeclarations,
e)},b;for(b in this._paintDeclarations)a[""===b?"paint":"paint."+b]=d.mapObject(this._paintDeclarations[b],e);return d.filterObject(a,function(a,b){return void 0!==a&&!("layout"===b&&!Object.keys(a).length)})};b.prototype._applyPaintDeclaration=function(a,b,c,e,f,h){c=c.transition?this._paintTransitions[a]:void 0;var g=this._paintSpecifications[a];if(null===b||void 0===b)b=new q(g,g["default"]);c&&c.declaration.json===b.json||(e=d.extend({duration:300,delay:0},e,this.getPaintProperty(a+"-transition")),
a=this._paintTransitions[a]=new n(g,b,c,e,h),a.instant()||(a.loopID=f.set(a.endTime-Date.now())),c&&f.cancel(c.loopID))};b.prototype._updateLayoutValue=function(a){var b=this._layoutDeclarations[a];b&&b.isFunction?this._layoutFunctions[a]=!0:(delete this._layoutFunctions[a],this.layout[a]=this.getLayoutValue(a))};b.prototype._validate=function(a,b,d,e,f){return f&&!1===f.validate?!1:l.emitErrors(this,a.call(l,{key:b,layerType:this.type,objectKey:d,value:e,styleSpec:c,style:{glyphs:!0,sprite:!0}}))};
return b}(a("../util/evented"));p.exports=k;var h={circle:a("./style_layer/circle_style_layer"),fill:a("./style_layer/fill_style_layer"),"fill-extrusion":a("./style_layer/fill_extrusion_style_layer"),line:a("./style_layer/line_style_layer"),symbol:a("./style_layer/symbol_style_layer"),background:k,raster:k,normal:k};k.create=function(a){return new h[a.type](a)}},{"../style-spec/reference/latest":142,"../util/evented":228,"../util/util":241,"./../style-spec/util/parse_color":147,"./style_declaration":173,
"./style_layer/circle_style_layer":175,"./style_layer/fill_extrusion_style_layer":176,"./style_layer/fill_style_layer":177,"./style_layer/line_style_layer":178,"./style_layer/symbol_style_layer":179,"./style_transition":181,"./validate_style":182}],175:[function(a,p,k){k=a("../style_layer");var e=a("../../data/bucket/circle_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.createBucket=function(a){return new e(a)};
return d}(k);p.exports=a},{"../../data/bucket/circle_bucket":76,"../style_layer":174}],176:[function(a,p,k){k=a("../style_layer");var e=a("../../data/bucket/fill_extrusion_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.getPaintValue=function(d,c,e){c=a.prototype.getPaintValue.call(this,d,c,e);"fill-extrusion-color"===d&&c&&(c[3]=1);return c};d.prototype.createBucket=function(a){return new e(a)};
return d}(k);p.exports=a},{"../../data/bucket/fill_extrusion_bucket":78,"../style_layer":174}],177:[function(a,p,k){k=a("../style_layer");var e=a("../../data/bucket/fill_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.getPaintValue=function(d,c,e){if("fill-outline-color"===d){if(void 0===this.getPaintProperty("fill-outline-color"))return a.prototype.getPaintValue.call(this,"fill-color",c,
e);for(var l=this._paintTransitions["fill-outline-color"];l;){if(!(l&&l.declaration&&l.declaration.value))return a.prototype.getPaintValue.call(this,"fill-color",c,e);l=l.oldTransition}}return a.prototype.getPaintValue.call(this,d,c,e)};d.prototype.getPaintValueStopZoomLevels=function(d){return"fill-outline-color"===d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.getPaintValueStopZoomLevels.call(this,"fill-color"):a.prototype.getPaintValueStopZoomLevels.call(this,d)};d.prototype.getPaintInterpolationT=
function(d,c){return"fill-outline-color"===d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.getPaintInterpolationT.call(this,"fill-color",c):a.prototype.getPaintInterpolationT.call(this,d,c)};d.prototype.isPaintValueFeatureConstant=function(d){return"fill-outline-color"===d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.isPaintValueFeatureConstant.call(this,"fill-color"):a.prototype.isPaintValueFeatureConstant.call(this,d)};d.prototype.isPaintValueZoomConstant=
function(d){return"fill-outline-color"===d&&void 0===this.getPaintProperty("fill-outline-color")?a.prototype.isPaintValueZoomConstant.call(this,"fill-color"):a.prototype.isPaintValueZoomConstant.call(this,d)};d.prototype.createBucket=function(a){return new e(a)};return d}(k);p.exports=a},{"../../data/bucket/fill_bucket":77,"../style_layer":174}],178:[function(a,p,k){k=a("../style_layer");var e=a("../../data/bucket/line_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);
d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.createBucket=function(a){return new e(a)};return d}(k);p.exports=a},{"../../data/bucket/line_bucket":79,"../style_layer":174}],179:[function(a,p,k){k=a("../style_layer");var e=a("../../data/bucket/symbol_bucket");a=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.getLayoutValue=function(d,c,e){var l=a.prototype.getLayoutValue.call(this,
d,c,e);if("auto"!==l)return l;switch(d){case "text-rotation-alignment":case "icon-rotation-alignment":return"line"===this.getLayoutValue("symbol-placement",c,e)?"map":"viewport";case "text-pitch-alignment":return this.getLayoutValue("text-rotation-alignment",c,e);case "icon-pitch-alignment":return this.getLayoutValue("icon-rotation-alignment",c,e);default:return l}};d.prototype.createBucket=function(a){return new e(a)};return d}(k);p.exports=a},{"../../data/bucket/symbol_bucket":80,"../style_layer":174}],
180:[function(a,p,k){var e=a("./style_layer"),d=a("../util/util"),n=a("../style-spec/feature_filter"),q=a("../style-spec/group_by_layout");a=function(a){a&&this.replace(a)};a.prototype.replace=function(a){this.symbolOrder=[];for(var c=0;c<a.length;c+=1){var d=a[c];"symbol"===d.type&&this.symbolOrder.push(d.id)}this._layerConfigs={};this._layers={};this.update(a,[])};a.prototype.update=function(a,l,m){for(var c=this,b=0;b<a.length;b+=1){var f=a[b];c._layerConfigs[f.id]=f;f=c._layers[f.id]=e.create(f);
f.updatePaintTransitions({},{transition:!1});f.filter=n(f.filter)}for(a=0;a<l.length;a+=1)b=l[a],delete c._layerConfigs[b],delete c._layers[b];m&&(this.symbolOrder=m);this.familiesBySource={};l=0;for(m=q(d.values(this._layerConfigs));l<m.length;l+=1)if(a=m[l].map(function(a){return c._layers[a.id]}),f=a[0],!f.layout||"none"!==f.layout.visibility){var g=f.source||"";(b=c.familiesBySource[g])||(b=c.familiesBySource[g]={});f=f.sourceLayer||"_geojsonTileLayer";(g=b[f])||(g=b[f]=[]);g.push(a)}};p.exports=
a},{"../style-spec/feature_filter":138,"../style-spec/group_by_layout":141,"../util/util":241,"./style_layer":174}],181:[function(a,p,k){function e(a,d,e){if(void 0!==a&&void 0!==d)return{from:a.to,fromScale:a.toScale,to:d.to,toScale:d.toScale,t:e}}var d=a("../util/util"),n=a("../style-spec/util/interpolate"),q={lastIntegerZoom:0,lastIntegerZoomTime:0,lastZoom:0};a=function(a,d,m,h,b){this.declaration=d;this.startTime=this.endTime=(new Date).getTime();this.oldTransition=m;this.duration=h.duration||
0;this.delay=h.delay||0;this.interp=(this.zoomTransitioned="piecewise-constant"===a["function"]&&a.transition)?e:n[a.type];this.zoomHistory=b||q;this.instant()||(this.endTime=this.startTime+this.duration+this.delay);m&&m.endTime<=this.startTime&&delete m.oldTransition};a.prototype.instant=function(){return!this.oldTransition||!this.interp||0===this.duration&&0===this.delay};a.prototype.calculate=function(a,e,m){var c=this._calculateTargetValue(a,e);if(this.instant())return c;m=m||Date.now();if(m>=
this.endTime)return c;a=this.oldTransition.calculate(a,e,this.startTime);m=d.easeCubicInOut((m-this.startTime-this.delay)/this.duration);return this.interp(a,c,m)};a.prototype._calculateTargetValue=function(a,d){if(!this.zoomTransitioned)return this.declaration.calculate(a,d);var c=a.zoom,e=this.zoomHistory.lastIntegerZoom,b=c>e?2:.5,f=this.declaration.calculate({zoom:c>e?c-1:c+1},d),g=this.declaration.calculate({zoom:c},d),l=Math.min((Date.now()-this.zoomHistory.lastIntegerZoomTime)/this.duration,
1),c=n(l,1,Math.abs(c-e));if(void 0!==f&&void 0!==g)return{from:f,fromScale:b,to:g,toScale:1,t:c}};p.exports=a},{"../style-spec/util/interpolate":146,"../util/util":241}],182:[function(a,p,k){p.exports=a("../style-spec/validate_style.min");p.exports.emitErrors=function(a,d){if(d&&d.length){for(var e=0;e<d.length;e++)a.fire("error",{error:Error(d[e].message)});return!0}return!1}},{"../style-spec/validate_style.min":168}],183:[function(a,p,k){a=function(a){function d(d,e,c,l){a.call(this,d,e);this.angle=
c;void 0!==l&&(this.segment=l)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)};return d}(a("point-geometry"));p.exports=a},{"point-geometry":56}],184:[function(a,p,k){p.exports=function(a,d,n,q,c){if(void 0===d.segment)return!0;var e=d;d=d.segment+1;for(var m=0;m>-n/2;){d--;if(0>d)return!1;m-=a[d].dist(e);e=a[d]}m+=a[d].dist(a[d+1]);d++;for(var e=[],h=0;m<n/2;){var b=a[d],f=a[d+
1];if(!f)return!1;var g=a[d-1].angleTo(b)-b.angleTo(f),g=Math.abs((g+3*Math.PI)%(2*Math.PI)-Math.PI);e.push({distance:m,angleDelta:g});for(h+=g;m-e[0].distance>q;)h-=e.shift().angleDelta;if(h>c)return!1;d++;m+=b.dist(f)}return!0}},{}],185:[function(a,p,k){var e=a("point-geometry");p.exports=function(a,n,q,c,l){for(var d=[],h=0;h<a.length;h++)for(var b=a[h],f=void 0,g=0;g<b.length-1;g++){var k=b[g],p=b[g+1];k.x<n&&p.x<n||(k.x<n?k=(new e(n,k.y+(n-k.x)/(p.x-k.x)*(p.y-k.y)))._round():p.x<n&&(p=(new e(n,
k.y+(n-k.x)/(p.x-k.x)*(p.y-k.y)))._round()),k.y<q&&p.y<q||(k.y<q?k=(new e(k.x+(q-k.y)/(p.y-k.y)*(p.x-k.x),q))._round():p.y<q&&(p=(new e(k.x+(q-k.y)/(p.y-k.y)*(p.x-k.x),q))._round()),k.x>=c&&p.x>=c||(k.x>=c?k=(new e(c,k.y+(c-k.x)/(p.x-k.x)*(p.y-k.y)))._round():p.x>=c&&(p=(new e(c,k.y+(c-k.x)/(p.x-k.x)*(p.y-k.y)))._round()),k.y>=l&&p.y>=l||(k.y>=l?k=(new e(k.x+(l-k.y)/(p.y-k.y)*(p.x-k.x),l))._round():p.y>=l&&(p=(new e(k.x+(l-k.y)/(p.y-k.y)*(p.x-k.x),l))._round()),f&&k.equals(f[f.length-1])||(f=[k],
d.push(f)),f.push(p)))))}return d}},{"point-geometry":56}],186:[function(a,p,k){k=a("../util/struct_array");var e=a("point-geometry");a=k({members:[{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"offsetX"},{type:"Int16",name:"offsetY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Float32",name:"unadjustedMaxScale"},{type:"Float32",name:"maxScale"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",
name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"bbox0"},{type:"Int16",name:"bbox1"},{type:"Int16",name:"bbox2"},{type:"Int16",name:"bbox3"},{type:"Float32",name:"placementScale"}]});Object.defineProperty(a.prototype.StructType.prototype,"anchorPoint",{get:function(){return new e(this.anchorPointX,this.anchorPointY)}});p.exports=a},{"../util/struct_array":238,"point-geometry":56}],187:[function(a,p,k){a=function(a,d,n,q,c,l,m,h,b,f,g){var e=m.top*h-b,k=m.bottom*h+b,
p=m.left*h-b;m=m.right*h+b;this.boxStartIndex=a.length;f?(f=k-e,p=m-p,0<f&&(f=Math.max(10*h,f),g?(d=d[n.segment+1].sub(d[n.segment])._unit()._mult(p),d=[n.sub(d),n.add(d)],this._addLineCollisionBoxes(a,d,n,0,p,f,q,c,l)):this._addLineCollisionBoxes(a,d,n,n.segment,p,f,q,c,l))):a.emplaceBack(n.x,n.y,0,0,p,e,m,k,Infinity,Infinity,q,c,l,0,0,0,0,0);this.boxEndIndex=a.length};a.prototype._addLineCollisionBoxes=function(a,d,n,q,c,l,m,h,b){var e=l/2,g=Math.floor(c/e),k=Math.floor(g/2),p=-l/2,z=n;q+=1;var t=
p,r=-c/2,v=r-c/8;do if(q--,0>q){if(t>r)return;q=0;break}else t-=d[q].dist(z),z=d[q];while(t>v);z=d[q].dist(d[q+1]);for(v=-k;v<g+k;v++){var C=v*e,w=r+C;0>C&&(w+=C);C>c&&(w+=C-c);if(!(w<t)){for(;t+z<w;){t+=z;q++;if(q+1>=d.length)return;z=d[q].dist(d[q+1])}var C=w-t,A=d[q],C=d[q+1].sub(A)._unit()._mult(C)._add(A)._round(),w=c/2/Math.max(Math.abs(w-p)-e/2,0);if(0>v||v>=g)w=Math.min(w,.99);a.emplaceBack(C.x,C.y,C.x-n.x,C.y-n.y,-l/2,-l/2,l/2,l/2,w,w,m,h,b,0,0,0,0,0)}}};p.exports=a},{}],188:[function(a,
p,k){var e=a("point-geometry"),d=a("../data/extent"),n=a("grid-index"),q=a("../util/intersection_tests"),c=function(a,c,e,b,f,g,q){void 0===g&&(g=new n(d,12,6));void 0===q&&(q=new n(d,12,0));this.angle=a;this.pitch=c;this.cameraToCenterDistance=e;this.cameraToTileDistance=b;this.grid=g;this.ignoredGrid=q;this.perspectiveRatio=1+.5*(b/e-1);this.minScale=.5/this.perspectiveRatio;this.maxScale=2/this.perspectiveRatio;a=Math.sin(this.angle);g=Math.cos(this.angle);this.rotationMatrix=[g,-a,a,g];this.reverseRotationMatrix=
[g,a,-a,g];this.yStretch=Math.max(1,b/(e*Math.cos(c/180*Math.PI)));this.collisionBoxArray=f;0===f.length&&(f.emplaceBack(),f.emplaceBack(0,0,0,0,0,-32767,0,32767,Infinity,Infinity,0,0,0,0,0,0,0,0,0),f.emplaceBack(d,0,0,0,0,-32767,0,32767,Infinity,Infinity,0,0,0,0,0,0,0,0,0),f.emplaceBack(0,0,0,0,-32767,0,32767,0,Infinity,Infinity,0,0,0,0,0,0,0,0,0),f.emplaceBack(0,d,0,0,-32767,0,32767,0,Infinity,Infinity,0,0,0,0,0,0,0,0,0));this.tempCollisionBox=f.get(0);this.edges=[f.get(1),f.get(2),f.get(3),f.get(4)]};
c.deserialize=function(a,d){return new c(a.angle,a.pitch,a.cameraToCenterDistance,a.cameraToTileDistance,d,new n(a.grid),new n(a.ignoredGrid))};c.prototype.serialize=function(a){var c=this.grid.toArrayBuffer(),d=this.ignoredGrid.toArrayBuffer();a&&(a.push(c),a.push(d));return{angle:this.angle,pitch:this.pitch,cameraToCenterDistance:this.cameraToCenterDistance,cameraToTileDistance:this.cameraToTileDistance,grid:c,ignoredGrid:d}};c.prototype.placeCollisionFeature=function(a,c,d){for(var b=this.collisionBoxArray,
f=this.minScale,g=this.rotationMatrix,h=this.yStretch,l=a.boxStartIndex;l<a.boxEndIndex;l++){var m=b.get(l),n=m.anchorPoint._matMult(g),q=n.x,k=n.y,p=q+m.x1*this.perspectiveRatio,w=k+m.y1*h*this.perspectiveRatio,q=q+m.x2*this.perspectiveRatio,k=k+m.y2*h*this.perspectiveRatio;m.bbox0=p;m.bbox1=w;m.bbox2=q;m.bbox3=k;var A=(new e(m.offsetX,m.offsetY))._matMult(g),y=A.x*A.x,A=A.y*A.y;m.maxScale=m.unadjustedMaxScale*(Math.sqrt((y+A*h*h)/(y+A))||1);if(!c)for(p=this.grid.query(p,w,q,k),w=0;w<p.length;w++)if(q=
b.get(p[w]),k=q.anchorPoint._matMult(g),f=this.getPlacementScale(f,n,m,k,q),f>=this.maxScale)return f;if(d)for(this.angle?(n=this.reverseRotationMatrix,p=(new e(m.x1,m.y1)).matMult(n),w=(new e(m.x2,m.y1)).matMult(n),q=(new e(m.x1,m.y2)).matMult(n),k=(new e(m.x2,m.y2)).matMult(n),n=this.tempCollisionBox,n.anchorPointX=m.anchorPoint.x,n.anchorPointY=m.anchorPoint.y,n.x1=Math.min(p.x,w.x,q.x,k.x),n.y1=Math.min(p.y,w.x,q.x,k.x),n.x2=Math.max(p.x,w.x,q.x,k.x),n.y2=Math.max(p.y,w.x,q.x,k.x),n.maxScale=
m.maxScale):n=m,p=0;p<this.edges.length;p++)if(w=this.edges[p],f=this.getPlacementScale(f,m.anchorPoint,n,w.anchorPoint,w),f>=this.maxScale)return f}return f};c.prototype.queryRenderedSymbols=function(a,c){var d={},b=[];if(0===a.length||0===this.grid.keys.length&&0===this.ignoredGrid.keys.length)return b;for(var f=this.collisionBoxArray,g=this.rotationMatrix,l=this.yStretch,m=[],n=Infinity,k=Infinity,p=-Infinity,v=-Infinity,C=0;C<a.length;C++)for(var w=a[C],A=0;A<w.length;A++){var y=w[A].matMult(g),
n=Math.min(n,y.x),k=Math.min(k,y.y),p=Math.max(p,y.x),v=Math.max(v,y.y);m.push(y)}C=this.grid.query(n,k,p,v);n=this.ignoredGrid.query(n,k,p,v);for(k=0;k<n.length;k++)C.push(n[k]);n=c/this.perspectiveRatio;k=Math.pow(2,Math.ceil(Math.log(n)/Math.LN2*10)/10);for(p=0;p<C.length;p++){var x=f.get(C[p]),v=x.sourceLayerIndex,w=x.featureIndex;void 0===d[v]&&(d[v]={});if(!(d[v][w]||k<x.placementScale||k>x.maxScale)){var F=x.anchorPoint.matMult(g),A=F.x+x.x1/n,y=F.y+x.y1/n*l,G=F.x+x.x2/n,x=F.y+x.y2/n*l,A=[new e(A,
y),new e(G,y),new e(G,x),new e(A,x)];q.polygonIntersectsPolygon(m,A)&&(d[v][w]=!0,b.push(C[p]))}}return b};c.prototype.getPlacementScale=function(a,c,d,b,e){var f=c.x-b.x;b=c.y-b.y;c=(e.x1-d.x2)/f;var f=(e.x2-d.x1)/f,h=(e.y1-d.y2)*this.yStretch/b;b=(e.y2-d.y1)*this.yStretch/b;if(isNaN(c)||isNaN(f))c=f=1;if(isNaN(h)||isNaN(b))h=b=1;c=Math.min(Math.max(c,f),Math.max(h,b));f=e.maxScale;d=d.maxScale;c>f&&(c=f);c>d&&(c=d);c>a&&c>=e.placementScale&&(a=c);return a};c.prototype.insertCollisionFeature=function(a,
c,d){d=d?this.ignoredGrid:this.grid;for(var b=this.collisionBoxArray,e=a.boxStartIndex;e<a.boxEndIndex;e++){var g=b.get(e);g.placementScale=c;c<this.maxScale&&(1===this.perspectiveRatio||1<=g.maxScale)&&d.insert(e,g.bbox0,g.bbox1,g.bbox2,g.bbox3)}};p.exports=c},{"../data/extent":84,"../util/intersection_tests":232,"grid-index":23,"point-geometry":56}],189:[function(a,p,k){function e(a,l,m,h,b,f,g,k,p){for(var c=f/2,u=0,r=0;r<a.length-1;r++)u+=a[r].dist(a[r+1]);r=0;l-=m;for(var v=[],D=0;D<a.length-
1;D++){for(var w=a[D],A=a[D+1],y=w.dist(A),x=A.angleTo(w);l+m<r+y;){l+=m;var F=(l-r)/y,G=d(w.x,A.x,F),F=d(w.y,A.y,F);0<=G&&G<p&&0<=F&&F<p&&0<=l-c&&l+c<=u&&(G=(new n(G,F,x,D))._round(),h&&!q(a,G,f,h,b)||v.push(G))}r+=y}k||v.length||g||(v=e(a,r/2,m,h,b,f,g,!0,p));return v}var d=a("../style-spec/util/interpolate"),n=a("../symbol/anchor"),q=a("./check_max_angle");p.exports=function(a,d,m,h,b,f,g,n,q){b=Math.max(h?h.right-h.left:0,b?b.right-b.left:0);var c=0===a[0].x||a[0].x===q||0===a[0].y||a[0].y===
q;d-b*g<d/4&&(d=b*g+d/4);return e(a,c?d/2*n%d:(b/2+2*f)*g*n%d,d,h?.6*f*g:0,m,b*g,c,!1,q)}},{"../style-spec/util/interpolate":146,"../symbol/anchor":183,"./check_max_angle":184}],190:[function(a,p,k){var e=a("@mapbox/shelf-pack"),d=a("../util/util");a=function(){this.height=this.width=128;this.atlas=new e(this.width,this.height);this.index={};this.ids={};this.data=new Uint8Array(this.width*this.height)};a.prototype.getGlyphs=function(){var a={},d,c,e;for(e in this.ids)d=e.split("#"),c=d[0],d=d[1],
a[c]||(a[c]=[]),a[c].push(d);return a};a.prototype.getRects=function(){var a={},d,c,e;for(e in this.ids)d=e.split("#"),c=d[0],d=d[1],a[c]||(a[c]={}),a[c][d]=this.index[e];return a};a.prototype.addGlyph=function(a,e,c,l){if(!c)return null;var m=e+"#"+c.id;if(this.index[m])return 0>this.ids[m].indexOf(a)&&this.ids[m].push(a),this.index[m];if(!c.bitmap)return null;e=c.width+2*l;l=c.height+2*l;var h=e+2,b=l+2,f=this.atlas.packOne(h,b);f||(this.resize(),f=this.atlas.packOne(h,b));if(!f)return d.warnOnce("glyph bitmap overflow"),
null;this.index[m]=f;this.ids[m]=[a];a=this.data;c=c.bitmap;for(m=0;m<l;m++)for(var h=this.width*(f.y+m+1)+f.x+1,b=e*m,g=0;g<e;g++)a[h+g]=c[b+g];this.dirty=!0;return f};a.prototype.resize=function(){var a=this.width,d=this.height;if(!(2048<=a||2048<=d)){this.texture&&(this.gl&&this.gl.deleteTexture(this.texture),this.texture=null);this.width*=4;this.height*=4;this.atlas.resize(this.width,this.height);for(var c=new ArrayBuffer(this.width*this.height),e=0;e<d;e++){var m=new Uint8Array(this.data.buffer,
d*e,a);(new Uint8Array(c,d*e*4,a)).set(m)}this.data=new Uint8Array(c)}};a.prototype.bind=function(a){this.gl=a;this.texture?a.bindTexture(a.TEXTURE_2D,this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,
0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,null))};a.prototype.updateTexture=function(a){this.bind(a);this.dirty&&(a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data),this.dirty=!1)};p.exports=a},{"../util/util":241,"@mapbox/shelf-pack":2}],191:[function(a,p,k){function e(a,b,c,d){d=d||"abc";return c.replace("{s}",d[a.length%d.length]).replace("{fontstack}",a).replace("{range}",b)}var d=a("../util/mapbox").normalizeGlyphsURL,n=a("../util/ajax"),
q=a("../util/glyphs"),c=a("../symbol/glyph_atlas"),l=a("pbf"),m=a("@mapbox/tiny-sdf"),h=a("../util/is_char_in_unicode_block"),b=function(a,b,c){this.advance=a.advance;this.left=a.left-c-1;this.top=a.top+c+1;this.rect=b};a=function(a,b){this.url=a&&d(a);this.atlases={};this.stacks={};this.loading={};this.localIdeographFontFamily=b;this.tinySDFs={}};a.prototype.getSimpleGlyphs=function(a,d,e,l){var f=this;void 0===this.stacks[a]&&(this.stacks[a]={ranges:{},cjkGlyphs:{}});void 0===this.atlases[a]&&(this.atlases[a]=
new c);for(var g={},m=this.stacks[a],n=this.atlases[a],q={},k=0,p=function(c){var d=Math.floor(c/256);if(f.localIdeographFontFamily&&(h["CJK Unified Ideographs"](c)||h["Hangul Syllables"](c))){m.cjkGlyphs[c]||(m.cjkGlyphs[c]=f.loadCJKGlyph(a,c));var d=m.cjkGlyphs[c],l=n.addGlyph(e,a,d,3);d&&(g[c]=new b(d,l,3))}else m.ranges[d]?(d=m.ranges[d].glyphs[c],l=n.addGlyph(e,a,d,3),d&&(g[c]=new b(d,l,3))):(void 0===q[d]&&(q[d]=[],k++),q[d].push(c))},u=0;u<d.length;u++)p(d[u]);k||l(void 0,g,a);d=function(c,
d,h){if(!c)for(c=f.stacks[a].ranges[d]=h.stacks[0],h=0;h<q[d].length;h++){var m=q[d][h],p=c.glyphs[m],u=n.addGlyph(e,a,p,3);p&&(g[m]=new b(p,u,3))}k--;k||l(void 0,g,a)};for(var x in q)f.loadRange(a,x,d)};a.prototype.createTinySDF=function(a,b){return new m(24,3,8,.25,a,b)};a.prototype.loadCJKGlyph=function(a,b){var c=this.tinySDFs[a];c||(c="400",/bold/i.test(a)?c="900":/medium/i.test(a)?c="500":/light/i.test(a)&&(c="200"),c=this.tinySDFs[a]=this.createTinySDF(this.localIdeographFontFamily,c));return{id:b,
bitmap:c.draw(String.fromCharCode(b)),width:24,height:24,left:0,top:-8,advance:24}};a.prototype.loadPBF=function(a,b){if(-1==a.indexOf("file://"))n.getArrayBuffer(a,b);else if(window.resolveLocalFileSystemURL)window.resolveLocalFileSystemURL(a,function(a){a.file(function(a){var c=new FileReader;c.onloadend=function(a){b(null,{data:c.result,cacheControl:null,expires:null})};c.readAsArrayBuffer(a)})},function(a){b(a.code,{data:{},cacheControl:null,expires:null})});else throw Error("vector tile Offline sources need cordova-sqlite-ext extended -----\x3e https://github.com/jessisena/cordova-sqlite-ext");
};a.prototype.loadRange=function(a,b,c){if(65535<256*b)return c("glyphs > 65535 not supported");void 0===this.loading[a]&&(this.loading[a]={});var d=this.loading[a];d[b]?d[b].push(c):(d[b]=[c],a=e(a,256*b+"-"+(256*b+255),this.url),this.loadPBF(a,function(a,c){for(var e=!a&&new q(new l(c.data)),f=0;f<d[b].length;f++)d[b][f](a,b,e);delete d[b]}))};a.prototype.getGlyphAtlas=function(a){return this.atlases[a]};p.exports=a},{"../symbol/glyph_atlas":190,"../util/ajax":219,"../util/glyphs":231,"../util/is_char_in_unicode_block":233,
"../util/mapbox":235,"@mapbox/tiny-sdf":3,pbf:55}],192:[function(a,p,k){p.exports=function(a){function d(a,b,c){var d=l[a];delete l[a];l[b]=d;m[d].geometry[0].pop();m[d].geometry[0]=m[d].geometry[0].concat(c[0]);return d}function e(a,b,d){var e=c[b];delete c[b];c[a]=e;m[e].geometry[0].shift();m[e].geometry[0]=d[0].concat(m[e].geometry[0]);return e}function q(a,b,c){b=c?b[0][b[0].length-1]:b[0][0];return a+":"+b.x+":"+b.y}for(var c={},l={},m=[],h=0,b=0;b<a.length;b++){var f=a[b],g=f.geometry;if(f=
f.text){var k=q(f,g),p=q(f,g,!0);if(k in l&&p in c&&l[k]!==c[p]){var g=e(k,p,g),z=d(k,p,m[g].geometry);delete c[k];delete l[p];l[q(f,m[z].geometry,!0)]=z;m[g].geometry=null}else k in l?d(k,p,g):p in c?e(k,p,g):(m.push(a[b]),h++,c[k]=h-1,l[p]=h-1)}else m.push(a[b]),h++}return m.filter(function(a){return a.geometry})}},{}],193:[function(a,p,k){function e(a,b){var c=[a.x,a.y,0,1];l.transformMat4(c,c,b);return new q(c[0]/c[3],c[1]/c[3])}function d(a,b,c,d,l,m,q,k,p,w,A,y){var f=b/24,g=a.lineOffsetX*b;
b*=a.lineOffsetY;if(1<a.numGlyphs){l=a.glyphStartIndex+a.numGlyphs;var u=k.get(a.glyphStartIndex).offsetX,t=k.get(l-1).offsetX,r=a.lineStartIndex,v=a.lineStartIndex+a.lineLength,u=n(f*u,g,b,c,A,a.segment,r,v,p,m,y);if(!u)return{notEnoughRoom:!0};t=n(f*t,g,b,c,A,a.segment,r,v,p,m,y);if(!t)return{notEnoughRoom:!0};var z=e(u.point,q);q=e(t.point,q);if(d&&!c&&(a.vertical?z.y<q.y:z.x>q.x))return{needsFlipping:!0};d=[u];for(q=a.glyphStartIndex+1;q<l-1;q++)u=k.get(q),d.push(n(f*u.offsetX,g,b,c,A,a.segment,
r,v,p,m,y));d.push(t)}else{if(d&&!c&&(r=e(p.get(a.lineStartIndex+a.segment),l),l=e(p.get(a.lineStartIndex+a.segment+1),l),a.vertical?l.y>r.y:l.x<r.x))return{needsFlipping:!0};k=k.get(a.glyphStartIndex);c=n(f*k.offsetX,g,b,c,A,a.segment,a.lineStartIndex,a.lineStartIndex+a.lineLength,p,m,y);if(!c)return{notEnoughRoom:!0};d=[c]}a=a.placementZoom;c=0;for(m=d;c<m.length;c+=1)p=m[c],h(w,p.point,p.angle,a);return{}}function n(a,b,c,d,h,l,m,n,q,k,p){var f=d?a-b:a+b;a=0<f?1:-1;b=0;d&&(a*=-1,b=Math.PI);0>a&&
(b+=Math.PI);l=0<a?m+l:m+l+1;d=h;for(var g=0,u=0,f=Math.abs(f);g+u<=f;){l+=a;if(l<m||l>=n)return null;h=d;d=p[l];void 0===d&&(d=p[l]=e(q.get(l),k));g+=u;u=h.dist(d)}n=(f-g)/u;m=d.sub(h);n=m.mult(n)._add(h);n._add(m._unit()._perp()._mult(c*a));return{point:n,angle:b+Math.atan2(d.y-h.y,d.x-h.x)}}var q=a("point-geometry"),c=a("@mapbox/gl-matrix").mat4,l=a("@mapbox/gl-matrix").vec4,m=a("./symbol_size"),h=a("../data/bucket/symbol_bucket").addDynamicAttributes;p.exports={updateLineLabels:function(a,c,n,
k,p,t,r,v,C,w){C=k?a.textSizeData:a.iconSizeData;w=m.evaluateSizeForZoom(C,n.transform,w,k);var f=[256/n.width*2+1,256/n.height*2+1],g=k?a.buffers.glyph.dynamicLayoutVertexArray:a.buffers.icon.dynamicLayoutVertexArray;g.clear();for(var u=a.lineVertexArray,z=k?a.placedGlyphArray:a.placedIconArray,D=0;D<z.length;D++){var J=z.get(D),B=[J.anchorX,J.anchorY,0,1];l.transformMat4(B,B,c);var K=B[0]/B[3],I=B[1]/B[3];if(K>=-f[0]&&K<=f[0]&&I>=-f[1]&&I<=f[1]&&n.frameHistory.isVisible(J.placementZoom)){var B=
1+.5*(B[3]/n.transform.cameraToCenterDistance-1),K=m.evaluateSizeForFeature(C,w,J),B=r?K*B:K/B,K=e(new q(J.anchorX,J.anchorY),p),I={},E=d(J,B,!1,v,c,p,t,a.glyphOffsetArray,u,g,K,I);if(E.notEnoughRoom||E.needsFlipping&&d(J,B,!0,v,c,p,t,a.glyphOffsetArray,u,g,K,I).notEnoughRoom)for(J=J.numGlyphs,B=g,K=0;K<J;K++)h(B,b,0,25)}else for(J=J.numGlyphs,B=g,K=0;K<J;K++)h(B,b,0,25)}k?a.buffers.glyph.dynamicLayoutVertexBuffer.updateData(g.serialize()):a.buffers.icon.dynamicLayoutVertexBuffer.updateData(g.serialize())},
getLabelPlaneMatrix:function(a,b,d,e,h){var f=c.identity(new Float32Array(16));b?(c.identity(f),c.scale(f,f,[1/h,1/h,1]),d||c.rotateZ(f,f,e.angle)):(c.scale(f,f,[e.width/2,-e.height/2,1]),c.translate(f,f,[1,-1,0]),c.multiply(f,f,a));return f},getGlCoordMatrix:function(a,b,d,e,h){var f=c.identity(new Float32Array(16));b?(c.multiply(f,f,a),c.scale(f,f,[h,h,1]),d||c.rotateZ(f,f,-e.angle)):(c.scale(f,f,[1,-1,1]),c.translate(f,f,[-1,-1,0]),c.scale(f,f,[2/e.width,2/e.height,1]));return f}};var b=new q(-Infinity,
-Infinity)},{"../data/bucket/symbol_bucket":80,"./symbol_size":197,"@mapbox/gl-matrix":1,"point-geometry":56}],194:[function(a,p,k){function e(a,d,c,e,m,h,b){this.tl=a;this.tr=d;this.bl=c;this.br=e;this.tex=m;this.writingMode=h;this.glyphOffset=b}var d=a("point-geometry");p.exports={getIconQuads:function(a,q,c,l,m,h,b){a=q.image;l=c.layout;var f=q.top-1/a.pixelRatio,g=q.left-1/a.pixelRatio,n=q.bottom+1/a.pixelRatio,k=q.right+1/a.pixelRatio,p;if("none"!==l["icon-text-fit"]&&m){q=k-g;var t=n-f,f=l["text-size"]/
24,n=m.left*f,g=m.top*f,r=m.right*f-n,v=m.bottom*f-g,C=l["icon-text-fit-padding"][0];p=l["icon-text-fit-padding"][1];m=l["icon-text-fit-padding"][2];var f=l["icon-text-fit-padding"][3],k="width"===l["icon-text-fit"]?.5*(v-t):0,w="height"===l["icon-text-fit"]?.5*(r-q):0,r="width"===l["icon-text-fit"]||"both"===l["icon-text-fit"]?r:q,t="height"===l["icon-text-fit"]||"both"===l["icon-text-fit"]?v:t;l=new d(n+w-f,g+k-C);q=new d(n+w+p+r,g+k-C);p=new d(n+w+p+r,g+k+m+t);n=new d(n+w-f,g+k+m+t)}else l=new d(g,
f),q=new d(k,f),p=new d(k,n),n=new d(g,n);if(h=c.getLayoutValue("icon-rotate",h,b)*Math.PI/180)c=Math.sin(h),h=Math.cos(h),c=[h,-c,c,h],l._matMult(c),q._matMult(c),n._matMult(c),p._matMult(c);return[new e(l,q,n,p,{x:a.textureRect.x-1,y:a.textureRect.y-1,w:a.textureRect.w+2,h:a.textureRect.h+2},void 0,[0,0])]},getGlyphQuads:function(a,q,c,l,m,h){a=c.getLayoutValue("text-rotate",m,h)*Math.PI/180;c=c.getLayoutValue("text-offset",m,h).map(function(a){return 24*a});m=q.positionedGlyphs;h=[];for(var b=
0;b<m.length;b++){var f=m[b],g=f.glyph;if(g){var n=g.rect;if(n){var k=g.advance/2,p=l?[f.x+k,f.y]:[0,0],t=l?[0,0]:[f.x+k+c[0],f.y+c[1]],r=g.left-k+t[0],v=-g.top+t[1],C=r+n.w,w=v+n.h,A=new d(r,v),v=new d(C,v),r=new d(r,w),C=new d(C,w),g=new d(t[0]-k,g.advance/2);0!==f.angle&&(A._sub(g)._rotate(f.angle)._add(g),v._sub(g)._rotate(f.angle)._add(g),r._sub(g)._rotate(f.angle)._add(g),C._sub(g)._rotate(f.angle)._add(g));a&&(f=Math.sin(a),g=Math.cos(a),f=[g,-f,f,g],A._matMult(f),v._matMult(f),r._matMult(f),
C._matMult(f));h.push(new e(A,v,r,C,n,q.writingMode,p))}}}return h},SymbolQuad:e}},{"point-geometry":56}],195:[function(a,p,k){function e(a,b,c,d,e){this.codePoint=a;this.x=b;this.y=c;this.glyph=d||null;this.angle=e}function d(a,b,c,d,e,f,g){this.positionedGlyphs=a;this.text=b;this.top=c;this.bottom=d;this.left=e;this.right=f;this.writingMode=g}function n(a,b,c,d){var e=Math.pow(a-b,2);return d?a<b?e/2:2*e:e+Math.abs(c)*c}function q(a,b){var c=0;10===a&&(c-=1E4);if(40===a||65288===a)c+=50;if(41===
b||65289===b)c+=50;return c}function c(a,b,c,d,e,f){for(var g=null,h=n(b,c,e,f),l=0;l<d.length;l+=1){var m=d[l],q=n(b-m.x,c,e,f)+m.badness;q<=h&&(g=m,h=q)}return{index:a,x:b,priorBreak:g,badness:h}}function l(a){return a?l(a.priorBreak).concat(a.index):[]}function m(a,d,e,f){if(!e||!a)return[];var g=[],h=0,m;for(m in a){var n=f[a.charCodeAt(m)];n&&(h+=n.advance+d)}e=h/Math.max(1,Math.ceil(h/e));for(m=h=0;m<a.length;m++){var n=a.charCodeAt(m),k=f[n];k&&!D[n]&&(h+=k.advance+d);m<a.length-1&&(z[n]||
b.charAllowsIdeographicBreaking(n))&&g.push(c(m+1,h,e,g,q(n,a.charCodeAt(m+1)),!1))}return l(c(a.length,h,e,g,0,!0))}function h(a,b,c,d,e){this.image=a;this.top=b;this.bottom=c;this.left=d;this.right=e}var b=a("../util/script_detection"),f=a("../util/verticalize_punctuation"),g=a("../source/rtl_text_plugin"),u={horizontal:1,vertical:2};p.exports={shapeText:function(a,c,h,l,n,q,k,p,z,D,J){var x=a.trim();J===u.vertical&&(x=f(x));a=[];z=new d(a,x,z[1],z[1],z[0],z[0],J);if(g.processBidirectionalText)h=
g.processBidirectionalText(x,m(x,p,h,c));else{var t=x,r=[],v=0,A=0;for(h=m(x,p,h,c);A<h.length;A+=1)x=h[A],r.push(t.substring(v,x)),v=x;v<t.length&&r.push(t.substring(v,t.length));h=r}t=h;x=0;v=-17;h=0;var r=z.positionedGlyphs,w;for(w in t){var y=t[w].trim();if(y.length){for(var A=r.length,F=0;F<y.length;F++){var C=y.charCodeAt(F),G=c[C];G&&(b.charHasUprightVerticalOrientation(C)&&J!==u.horizontal?(r.push(new e(C,x,0,G,-Math.PI/2)),x+=D+p):(r.push(new e(C,x,v,G,0)),x+=G.advance+p))}if(r.length!==
A&&(h=Math.max(x-p,h),x=r,y=r.length-1,k))for(F=(x[y].x+c[x[y].codePoint].advance)*k;A<=y;A++)x[A].x-=F;x=0}v+=l}c=(k-n)*h;k=(-q*t.length+.5)*l;for(p=0;p<r.length;p++)r[p].x+=c,r[p].y+=k;l*=t.length;z.top+=-q*l;z.bottom=z.top+l;z.left+=-n*h;z.right=z.left+h;return a.length?z:!1},shapeIcon:function(a,b){var c=b[0]-a.displaySize[0]/2,d=b[1]-a.displaySize[1]/2;return new h(a,d,d+a.displaySize[1],c,c+a.displaySize[0])},WritingMode:u};var D={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},z={10:!0,32:!0,38:!0,40:!0,
41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0}},{"../source/rtl_text_plugin":122,"../util/script_detection":236,"../util/verticalize_punctuation":243}],196:[function(a,p,k){function e(a){var c={x:a.rect.x+1,y:a.rect.y+1,w:a.rect.w-2,h:a.rect.h-2};return{sdf:a.sdf,pixelRatio:a.pixelRatio,isNativePixelRatio:a.pixelRatio===n.devicePixelRatio,textureRect:c,tl:[c.x,c.y],br:[c.x+c.w,c.y+c.h],displaySize:[c.w/a.pixelRatio,c.h/a.pixelRatio]}}var d=a("@mapbox/shelf-pack"),n=a("../util/browser"),
q=a("../util/util"),c=a("../util/window");a=function(a){function l(c,b){a.call(this);this.images={};this.data=!1;this.filter=this.texture=0;this.width=c*n.devicePixelRatio;this.height=b*n.devicePixelRatio;this.shelfPack=new d(this.width,this.height);this.dirty=!0}a&&(l.__proto__=a);l.prototype=Object.create(a&&a.prototype);l.prototype.constructor=l;l.prototype.getPixelSize=function(){return[this.width,this.height]};l.prototype.allocateImage=function(a,b){var c=this.shelfPack.packOne(a+2,b+2);return c?
c:(q.warnOnce("SpriteAtlas out of space."),null)};l.prototype.addImage=function(a,b,d){var e,f;b instanceof c.HTMLImageElement?(e=b.width,f=b.height,b=n.getImageData(b),d=1):(e=d.width,f=d.height,d=d.pixelRatio||1);ArrayBuffer.isView(b)&&(b=new Uint32Array(b.buffer));if(!(b instanceof Uint32Array))return this.fire("error",{error:Error("Image provided in an invalid format. Supported formats are HTMLImageElement and ArrayBufferView.")});if(this.images[a])return this.fire("error",{error:Error("An image with this name already exists.")});
var h=this.allocateImage(e,f);if(!h)return this.fire("error",{error:Error("There is not enough space to add this image.")});this.images[a]={rect:h,width:e,height:f,pixelRatio:d,sdf:!1};this.copy(b,e,h,{x:0,y:0,width:e,height:f},!1);this.fire("data",{dataType:"style"})};l.prototype.removeImage=function(a){var b=this.images[a];delete this.images[a];if(!b)return this.fire("error",{error:Error("No image with this name exists.")});this.shelfPack.unref(b.rect);this.fire("data",{dataType:"style"})};l.prototype.getIcon=
function(a){return this._getImage(a,!1)};l.prototype.getPattern=function(a){return this._getImage(a,!0)};l.prototype._getImage=function(a,b){if(this.images[a])return e(this.images[a]);if(!this.sprite)return null;var c=this.sprite.getSpritePosition(a);if(!c.width||!c.height)return null;var d=this.allocateImage(c.width,c.height);if(!d)return null;var h={rect:d,width:c.width,height:c.height,sdf:c.sdf,pixelRatio:c.pixelRatio};this.images[a]=h;if(!this.sprite.imgData)return null;var l=new Uint32Array(this.sprite.imgData.buffer);
this.copy(l,this.sprite.width,d,c,b);return e(h)};l.prototype.allocate=function(){if(!this.data){this.data=new Uint32Array(this.width*this.height);for(var a=0;a<this.data.length;a++)this.data[a]=0}};l.prototype.copy=function(a,b,c,d,e){this.allocate();var f=d.x,g=d.y,h=this.data,l=this.getPixelSize()[0],m=d.width;d=d.height;var n=g*b+f;c=(c.y+1)*l+(c.x+1);var q;if(e)for(c-=l,q=-1;q<=d;q++,c+=l)for(n=((q+d)%d+g)*b+f,e=-1;e<=m;e++)h[c+e]=a[n+(e+m)%m];else for(q=0;q<d;q++,n+=b,c+=l)for(e=0;e<m;e++)h[c+
e]=a[n+e];this.dirty=!0};l.prototype.setSprite=function(a){a&&this.canvas&&(this.canvas.width=this.width,this.canvas.height=this.height);this.sprite=a};l.prototype.addIcons=function(a,b){for(var c={},d=0;d<a.length;d+=1){var e=a[d];c[e]=this.getIcon(e)}b(null,c)};l.prototype.bind=function(a,b){var c=!1;this.texture?a.bindTexture(a.TEXTURE_2D,this.texture):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),c=!0);var d=b?a.LINEAR:a.NEAREST;d!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d),this.filter=d);this.dirty&&(this.allocate(),c?a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.width,this.height,0,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)):a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.RGBA,a.UNSIGNED_BYTE,new Uint8Array(this.data.buffer)),
this.dirty=!1)};return l}(a("../util/evented"));p.exports=a},{"../util/browser":220,"../util/evented":228,"../util/util":241,"../util/window":222,"@mapbox/shelf-pack":2}],197:[function(a,p,k){var e=a("../style-spec/util/interpolate"),d=a("../util/util"),n=a("../style-spec/function").interpolationFactor,q=a("assert");p.exports={evaluateSizeForFeature:function(a,d,m){return a.isFeatureConstant?d.uSize:a.isZoomConstant?m.lowerSize/10:e.number(m.lowerSize/10,m.upperSize/10,d.uSizeT)},evaluateSizeForZoom:function(a,
e,m,h){var b={};a.isZoomConstant||a.isFeatureConstant?a.isFeatureConstant&&!a.isZoomConstant?("interval"===a.functionType?a=m.getLayoutValue(h?"text-size":"icon-size",{zoom:e.zoom}):(q("exponential"===a.functionType),e="interval"===a.functionType?0:n(e.zoom,a.functionBase,a.coveringZoomRange[0],a.coveringZoomRange[1]),m=a.coveringStopValues[0],a=m+(a.coveringStopValues[1]-m)*d.clamp(e,0,1)),b.uSize=a):a.isFeatureConstant&&a.isZoomConstant&&(b.uSize=a.layoutSize):(a=n(e.zoom,a.functionBase,a.coveringZoomRange[0],
a.coveringZoomRange[1]),b.uSizeT=d.clamp(a,0,1));return b}}},{"../style-spec/function":140,"../style-spec/util/interpolate":146,"../util/util":241,assert:9}],198:[function(a,p,k){var e=a("../source/rtl_text_plugin");p.exports=function(a,n,q,c){n=n.getLayoutValue("text-transform",q,c);"uppercase"===n?a=a.toLocaleUpperCase():"lowercase"===n&&(a=a.toLocaleLowerCase());e.applyArabicShaping&&(a=e.applyArabicShaping(a));return a}},{"../source/rtl_text_plugin":122}],199:[function(a,p,k){var e=a("../util/dom"),
d=a("point-geometry"),n={scrollZoom:a("./handler/scroll_zoom"),boxZoom:a("./handler/box_zoom"),dragRotate:a("./handler/drag_rotate"),dragPan:a("./handler/drag_pan"),keyboard:a("./handler/keyboard"),doubleClickZoom:a("./handler/dblclick_zoom"),touchZoomRotate:a("./handler/touch_zoom_rotate")};p.exports=function(a,c){function l(){k=null}function m(c,d){var f=e.mousePos(b,d);return a.fire(c,{lngLat:a.unproject(f),point:f,originalEvent:d})}function h(c,f){var g=e.touchPos(b,f),h=g.reduce(function(a,b,
c,d){return a.add(b.div(d.length))},new d(0,0));return a.fire(c,{lngLat:a.unproject(h),point:h,lngLats:g.map(function(b){return a.unproject(b)},this),points:g,originalEvent:f})}var b=a.getCanvasContainer(),f=null,g=!1,q=null,k=null,p;for(p in n)a[p]=new n[p](a,c),c.interactive&&c[p]&&a[p].enable(c[p]);b.addEventListener("mouseout",function(a){m("mouseout",a)},!1);b.addEventListener("mousedown",function(c){a.stop();q=e.mousePos(b,c);m("mousedown",c);g=!0},!1);b.addEventListener("mouseup",function(b){var c=
a.dragRotate&&a.dragRotate.isActive();f&&!c&&m("contextmenu",f);f=null;g=!1;m("mouseup",b)},!1);b.addEventListener("mousemove",function(c){if(!a.dragPan||!a.dragPan.isActive())if(!a.dragRotate||!a.dragRotate.isActive()){for(var d=c.toElement||c.target;d&&d!==b;)d=d.parentNode;d===b&&m("mousemove",c)}},!1);b.addEventListener("touchstart",function(b){a.stop();h("touchstart",b);!b.touches||1<b.touches.length||(k?(clearTimeout(k),k=null,m("dblclick",b)):k=setTimeout(l,300))},!1);b.addEventListener("touchend",
function(a){h("touchend",a)},!1);b.addEventListener("touchmove",function(a){h("touchmove",a)},!1);b.addEventListener("touchcancel",function(a){h("touchcancel",a)},!1);b.addEventListener("click",function(a){e.mousePos(b,a).equals(q)&&m("click",a)},!1);b.addEventListener("dblclick",function(a){m("dblclick",a);a.preventDefault()},!1);b.addEventListener("contextmenu",function(b){var c=a.dragRotate&&a.dragRotate.isActive();g||c?g&&(f=b):m("contextmenu",b);b.preventDefault()},!1)}},{"../util/dom":227,"./handler/box_zoom":207,
"./handler/dblclick_zoom":208,"./handler/drag_pan":209,"./handler/drag_rotate":210,"./handler/keyboard":211,"./handler/scroll_zoom":212,"./handler/touch_zoom_rotate":213,"point-geometry":56}],200:[function(a,p,k){var e=a("../util/util"),d=a("../style-spec/util/interpolate"),n=a("../util/browser"),q=a("../geo/lng_lat"),c=a("../geo/lng_lat_bounds"),l=a("point-geometry");a=function(a){function h(b,c){a.call(this);this.moving=!1;this.transform=b;this._bearingSnap=c.bearingSnap}a&&(h.__proto__=a);h.prototype=
Object.create(a&&a.prototype);h.prototype.constructor=h;h.prototype.getCenter=function(){return this.transform.center};h.prototype.setCenter=function(a,c){return this.jumpTo({center:a},c)};h.prototype.panBy=function(a,c,d){a=l.convert(a).mult(-1);return this.panTo(this.transform.center,e.extend({offset:a},c),d)};h.prototype.panTo=function(a,c,d){return this.easeTo(e.extend({center:a},c),d)};h.prototype.getZoom=function(){return this.transform.zoom};h.prototype.setZoom=function(a,c){this.jumpTo({zoom:a},
c);return this};h.prototype.zoomTo=function(a,c,d){return this.easeTo(e.extend({zoom:a},c),d)};h.prototype.zoomIn=function(a,c){this.zoomTo(this.getZoom()+1,a,c);return this};h.prototype.zoomOut=function(a,c){this.zoomTo(this.getZoom()-1,a,c);return this};h.prototype.getBearing=function(){return this.transform.bearing};h.prototype.setBearing=function(a,c){this.jumpTo({bearing:a},c);return this};h.prototype.rotateTo=function(a,c,d){return this.easeTo(e.extend({bearing:a},c),d)};h.prototype.resetNorth=
function(a,c){this.rotateTo(0,e.extend({duration:1E3},a),c);return this};h.prototype.snapToNorth=function(a,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,c):this};h.prototype.getPitch=function(){return this.transform.pitch};h.prototype.setPitch=function(a,c){this.jumpTo({pitch:a},c);return this};h.prototype.fitBounds=function(a,d,g){d=e.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},d);if("number"===typeof d.padding){var b=
d.padding;d.padding={top:b,bottom:b,right:b,left:b}}if(e.deepEqual(Object.keys(d.padding).sort(function(a,b){return a<b?-1:a>b?1:0}),["bottom","left","right","top"])){a=c.convert(a);var f=[d.padding.left-d.padding.right,d.padding.top-d.padding.bottom],h=Math.min(d.padding.right,d.padding.left),b=Math.min(d.padding.top,d.padding.bottom);d.offset=[d.offset[0]+f[0],d.offset[1]+f[1]];var m=l.convert(d.offset),f=this.transform,n=f.project(a.getNorthWest());a=f.project(a.getSouthEast());var k=a.sub(n),
h=(f.width-2*h-2*Math.abs(m.x))/k.x,b=(f.height-2*b-2*Math.abs(m.y))/k.y;if(0>b||0>h)e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");else return d.center=f.unproject(n.add(a).div(2)),d.zoom=Math.min(f.scaleZoom(f.scale*Math.min(h,b)),d.maxZoom),d.bearing=0,d.linear?this.easeTo(d,g):this.flyTo(d,g)}else e.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'")};h.prototype.jumpTo=function(a,c){this.stop();
var b=this.transform,d=!1,e=!1,f=!1;"zoom"in a&&b.zoom!==+a.zoom&&(d=!0,b.zoom=+a.zoom);"center"in a&&(b.center=q.convert(a.center));"bearing"in a&&b.bearing!==+a.bearing&&(e=!0,b.bearing=+a.bearing);"pitch"in a&&b.pitch!==+a.pitch&&(f=!0,b.pitch=+a.pitch);this.fire("movestart",c).fire("move",c);d&&this.fire("zoomstart",c).fire("zoom",c).fire("zoomend",c);e&&this.fire("rotate",c);f&&this.fire("pitchstart",c).fire("pitch",c).fire("pitchend",c);return this.fire("moveend",c)};h.prototype.easeTo=function(a,
c){var b=this;this.stop();a=e.extend({offset:[0,0],duration:500,easing:e.ease},a);!1===a.animate&&(a.duration=0);a.smoothEasing&&0!==a.duration&&(a.easing=this._smoothOutEasing(a.duration));var f=this.transform,h=this.getZoom(),m=this.getBearing(),n=this.getPitch(),k="zoom"in a?+a.zoom:h,p="bearing"in a?this._normalizeBearing(a.bearing,m):m,C="pitch"in a?+a.pitch:n,w=f.centerPoint.add(l.convert(a.offset)),A=f.pointLocation(w),y=q.convert(a.center||A);this._normalizeCenter(y);var x=f.project(A),F=
f.project(y).sub(x),G=f.zoomScale(k-h),J,B;a.around&&(J=q.convert(a.around),B=f.locationPoint(J));this.zooming=k!==h;this.rotating=m!==p;this.pitching=C!==n;this._prepareEase(c,a.noMoveStart);clearTimeout(this._onEaseEnd);this._ease(function(a){this.zooming&&(f.zoom=d(h,k,a));this.rotating&&(f.bearing=d(m,p,a));this.pitching&&(f.pitch=d(n,C,a));if(J)f.setLocationAtPoint(J,B);else{var b=f.zoomScale(f.zoom-h);a=f.unproject(x.add(F.mult(a*Math.pow(k>h?Math.min(2,G):Math.max(.5,G),1-a))).mult(b));f.setLocationAtPoint(f.renderWorldCopies?
a.wrap():a,w)}this._fireMoveEvents(c)},function(){a.delayEndEvents?b._onEaseEnd=setTimeout(function(){return b._easeToEnd(c)},a.delayEndEvents):b._easeToEnd(c)},a);return this};h.prototype._prepareEase=function(a,c){this.moving=!0;c||this.fire("movestart",a);this.zooming&&this.fire("zoomstart",a);this.pitching&&this.fire("pitchstart",a)};h.prototype._fireMoveEvents=function(a){this.fire("move",a);this.zooming&&this.fire("zoom",a);this.rotating&&this.fire("rotate",a);this.pitching&&this.fire("pitch",
a)};h.prototype._easeToEnd=function(a){var b=this.zooming,c=this.pitching;this.pitching=this.rotating=this.zooming=this.moving=!1;b&&this.fire("zoomend",a);c&&this.fire("pitchend",a);this.fire("moveend",a)};h.prototype.flyTo=function(a,c){function b(a){a=(E*E-I*I+(a?-1:1)*L*L*H*H)/(2*(a?E:I)*L*H);return Math.log(Math.sqrt(a*a+1)-a)}function f(a){return(Math.exp(a)+Math.exp(-a))/2}var h=this;this.stop();a=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},a);var m=this.transform,n=this.getZoom(),
k=this.getBearing(),p=this.getPitch(),C="zoom"in a?e.clamp(+a.zoom,m.minZoom,m.maxZoom):n,w="bearing"in a?this._normalizeBearing(a.bearing,k):k,A="pitch"in a?+a.pitch:p,y=m.zoomScale(C-n),x=m.centerPoint.add(l.convert(a.offset)),F=m.pointLocation(x),G=q.convert(a.center||F);this._normalizeCenter(G);var J=m.project(F),B=m.project(G).sub(J),K=a.curve,I=Math.max(m.width,m.height),E=I/y,H=B.mag();"minZoom"in a&&(C=e.clamp(Math.min(a.minZoom,n,C),m.minZoom,m.maxZoom),C=I/m.zoomScale(C-n),K=Math.sqrt(C/
H*2));var L=K*K,N=b(0),Q=function(a){return f(N)/f(N+K*a)},R=function(a){var b=f(N);a=N+K*a;a=(Math.exp(a)-Math.exp(-a))/2/f(a);return(b*a-(Math.exp(N)-Math.exp(-N))/2)/L*I/H},O=(b(1)-N)/K;if(1E-6>Math.abs(H)||isNaN(O)){if(1E-6>Math.abs(I-E))return this.easeTo(a,c);var P=E<I?-1:1,O=Math.abs(Math.log(E/I))/K,R=function(){return 0},Q=function(a){return Math.exp(P*K*a)}}a.duration="duration"in a?+a.duration:1E3*O/("screenSpeed"in a?+a.screenSpeed/K:+a.speed);this.zooming=!0;this.rotating=k!==w;this.pitching=
A!==p;this._prepareEase(c,!1);this._ease(function(a){var b=a*O,e=1/Q(b);m.zoom=n+m.scaleZoom(e);this.rotating&&(m.bearing=d(k,w,a));this.pitching&&(m.pitch=d(p,A,a));a=m.unproject(J.add(B.mult(R(b))).mult(e));m.setLocationAtPoint(m.renderWorldCopies?a.wrap():a,x);this._fireMoveEvents(c)},function(){return h._easeToEnd(c)},a);return this};h.prototype.isEasing=function(){return!!this._abortFn};h.prototype.isMoving=function(){return this.moving};h.prototype.stop=function(){this._abortFn&&(this._abortFn(),
this._finishEase());return this};h.prototype._ease=function(a,c,d){this._finishFn=c;this._abortFn=n.timed(function(b){a.call(this,d.easing(b));1===b&&this._finishEase()},!1===d.animate?0:d.duration,this)};h.prototype._finishEase=function(){delete this._abortFn;var a=this._finishFn;delete this._finishFn;a.call(this)};h.prototype._normalizeBearing=function(a,c){a=e.wrap(a,-180,180);var b=Math.abs(a-c);Math.abs(a-360-c)<b&&(a-=360);Math.abs(a+360-c)<b&&(a+=360);return a};h.prototype._normalizeCenter=
function(a){var b=this.transform;b.renderWorldCopies&&!b.lngRange&&(b=a.lng-b.center.lng,a.lng+=180<b?-360:-180>b?360:0)};h.prototype._smoothOutEasing=function(a){var b=e.ease;if(this._prevEase)var b=this._prevEase,c=(Date.now()-b.start)/b.duration,b=b.easing(c+.01)-b.easing(c),b=.27/Math.sqrt(b*b+1E-4)*.01,b=e.bezier(b,Math.sqrt(.0729-b*b),.25,1);this._prevEase={start:(new Date).getTime(),duration:a,easing:b};return b};return h}(a("../util/evented"));p.exports=a},{"../geo/lng_lat":92,"../geo/lng_lat_bounds":93,
"../style-spec/util/interpolate":146,"../util/browser":220,"../util/evented":228,"../util/util":241,"point-geometry":56}],201:[function(a,p,k){var e=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/config");a=function(a){this.options=a;d.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};a.prototype.getDefaultPosition=function(){return"bottom-right"};a.prototype.onAdd=function(a){var c=this.options&&this.options.compact;this._map=a;this._container=e.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib");
c&&this._container.classList.add("mapboxgl-compact");this._updateAttributions();this._updateEditLink();this._map.on("sourcedata",this._updateData);this._map.on("moveend",this._updateEditLink);void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact());return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map.off("sourcedata",this._updateData);this._map.off("moveend",this._updateEditLink);this._map.off("resize",this._updateCompact);
this._map=void 0};a.prototype._updateEditLink=function(){this._editLink||(this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:n.ACCESS_TOKEN}];if(this._editLink){var c=a.reduce(function(c,d,e){void 0!==d.value&&(c+=d.key+"="+d.value+(e<a.length-1?"&":""));return c},"?");this._editLink.href="https://www.mapbox.com/feedback/"+c+(this._map._hash?this._map._hash.getHashString(!0):"")}};
a.prototype._updateData=function(a){a&&"metadata"===a.sourceDataType&&(this._updateAttributions(),this._updateEditLink())};a.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this._map.style.stylesheet){var c=this._map.style.stylesheet;this.styleOwner=c.owner;this.styleId=c.id}var c=this._map.style.sourceCaches,d;for(d in c){var e=c[d].getSource();e.attribution&&0>a.indexOf(e.attribution)&&a.push(e.attribution)}a.sort(function(a,b){return a.length-b.length});a=a.filter(function(c,
b){for(var d=b+1;d<a.length;d++)if(0<=a[d].indexOf(c))return!1;return!0});this._container.innerHTML=a.join(" | ");this._editLink=null}};a.prototype._updateCompact=function(){var a=640>=this._map.getCanvasContainer().offsetWidth;this._container.classList[a?"add":"remove"]("mapboxgl-compact")};p.exports=a},{"../../util/config":224,"../../util/dom":227,"../../util/util":241}],202:[function(a,p,k){var e=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window");a=function(){this._fullscreen=
!1;d.bindAll(["_onClickFullscreen","_changeIcon"],this);"onfullscreenchange"in n.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in n.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in n.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in n.document&&(this._fullscreenchange="MSFullscreenChange");this._className="mapboxgl-ctrl"};a.prototype.onAdd=function(a){this._map=a;this._mapContainer=this._map.getContainer();
this._container=e.create("div",this._className+" mapboxgl-ctrl-group");this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",d.warnOnce("This device does not support fullscreen mode."));return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map=null;n.document.removeEventListener(this._fullscreenchange,this._changeIcon)};a.prototype._checkFullscreenSupport=function(){return!!(n.document.fullscreenEnabled||
n.document.mozFullscreenEnabled||n.document.msFullscreenEnabled||n.document.webkitFullscreenEnabled)};a.prototype._setupUI=function(){var a=this._fullscreenButton=e.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);a.setAttribute("aria-label","Toggle fullscreen");a.type="button";this._fullscreenButton.addEventListener("click",this._onClickFullscreen);n.document.addEventListener(this._fullscreenchange,this._changeIcon)};a.prototype._isFullscreen=function(){return this._fullscreen};
a.prototype._changeIcon=function(){(n.document.fullscreenElement||n.document.mozFullScreenElement||n.document.webkitFullscreenElement||n.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))};a.prototype._onClickFullscreen=function(){this._isFullscreen()?n.document.exitFullscreen?n.document.exitFullscreen():
n.document.mozCancelFullScreen?n.document.mozCancelFullScreen():n.document.msExitFullscreen?n.document.msExitFullscreen():n.document.webkitCancelFullScreen&&n.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};
p.exports=a},{"../../util/dom":227,"../../util/util":241,"../../util/window":222}],203:[function(a,p,k){function e(a){void 0!==b?a(b):void 0!==n.navigator.permissions?n.navigator.permissions.query({name:"geolocation"}).then(function(c){b="denied"!==c.state;a(b)}):(b=!!n.navigator.geolocation,a(b))}k=a("../../util/evented");var d=a("../../util/dom"),n=a("../../util/window"),q=a("../../util/util"),c=a("assert"),l=a("../../geo/lng_lat"),m=a("../marker"),h={positionOptions:{enableHighAccuracy:!1,timeout:6E3},
fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0},b;a=function(a){function b(b){a.call(this);this.options=q.extend({},h,b);q.bindAll("_onSuccess _onError _finish _setupUI _updateCamera _updateMarker _onClickGeolocate".split(" "),this)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.onAdd=function(a){this._map=a;this._container=d.create("div","mapboxgl-ctrl mapboxgl-ctrl-group");e(this._setupUI);return this._container};b.prototype.onRemove=
function(){void 0!==this._geolocationWatchID&&(n.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0);this.options.showUserLocation&&this._userLocationDotMarker.remove();this._container.parentNode.removeChild(this._container);this._map=void 0};b.prototype._onSuccess=function(a){if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case "WAITING_ACTIVE":case "ACTIVE_LOCK":case "ACTIVE_ERROR":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");
this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case "BACKGROUND":case "BACKGROUND_ERROR":this._watchState="BACKGROUND";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;default:c(!1,"Unexpected watchState "+
this._watchState)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(a);this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(a);this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale");this.fire("geolocate",a);this._finish()};b.prototype._updateCamera=function(a){var b=new l(a.coords.longitude,a.coords.latitude);this._map.fitBounds(b.toBounds(a.coords.accuracy),this.options.fitBoundsOptions,{geolocateSource:!0})};
b.prototype._updateMarker=function(a){a?this._userLocationDotMarker.setLngLat([a.coords.longitude,a.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()};b.prototype._onError=function(a){if(this.options.trackUserLocation)if(1===a.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),
this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case "WAITING_ACTIVE":this._watchState="ACTIVE_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case "ACTIVE_LOCK":this._watchState="ACTIVE_ERROR";
this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case "BACKGROUND":this._watchState="BACKGROUND_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");
break;case "ACTIVE_ERROR":break;default:c(!1,"Unexpected watchState "+this._watchState)}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale");this.fire("error",a);this._finish()};b.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId);this._timeoutId=void 0};b.prototype._setupUI=function(a){var b=this;if(!1!==a&&(this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this._geolocateButton=
d.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed",!1),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=d.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new m(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",
this._onClickGeolocate.bind(this)),this.options.trackUserLocation))this._map.on("movestart",function(a){a.geolocateSource||"ACTIVE_LOCK"!==b._watchState||(b._watchState="BACKGROUND",b._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),b._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),b.fire("trackuserlocationend"))})};b.prototype._onClickGeolocate=function(){if(this.options.trackUserLocation){switch(this._watchState){case "OFF":this._watchState="WAITING_ACTIVE";
this.fire("trackuserlocationstart");break;case "WAITING_ACTIVE":case "ACTIVE_LOCK":case "ACTIVE_ERROR":case "BACKGROUND_ERROR":this._watchState="OFF";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");
this.fire("trackuserlocationend");break;case "BACKGROUND":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition);this.fire("trackuserlocationstart");break;default:c(!1,"Unexpected watchState "+this._watchState)}switch(this._watchState){case "WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");
break;case "ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case "ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case "BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case "BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");
break;case "OFF":break;default:c(!1,"Unexpected watchState "+this._watchState)}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed",!0),this._geolocationWatchID=n.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else n.navigator.geolocation.getCurrentPosition(this._onSuccess,
this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1E4)};b.prototype._clearWatch=function(){n.navigator.geolocation.clearWatch(this._geolocationWatchID);this._geolocationWatchID=void 0;this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.setAttribute("aria-pressed",!1);this.options.showUserLocation&&this._updateMarker(null)};return b}(k);p.exports=a},{"../../geo/lng_lat":92,"../../util/dom":227,"../../util/evented":228,"../../util/util":241,
"../../util/window":222,"../marker":216,assert:9}],204:[function(a,p,k){var e=a("../../util/dom"),d=a("../../util/util");a=function(){d.bindAll(["_updateLogo"],this)};a.prototype.onAdd=function(a){this._map=a;this._container=e.create("div","mapboxgl-ctrl");a=e.create("a","mapboxgl-ctrl-logo");a.target="_blank";a.href="https://www.mapbox.com/";a.setAttribute("aria-label","Mapbox logo");this._container.appendChild(a);this._container.style.display="none";this._map.on("sourcedata",this._updateLogo);this._updateLogo();
return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map.off("sourcedata",this._updateLogo)};a.prototype.getDefaultPosition=function(){return"bottom-left"};a.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")};a.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches,d;for(d in a)if(a[d].getSource().mapbox_logo)return!0;
return!1}};p.exports=a},{"../../util/dom":227,"../../util/util":241}],205:[function(a,p,k){function e(a){return new n.MouseEvent(a.type,{button:2,buttons:2,bubbles:!0,cancelable:!0,detail:a.detail,view:a.view,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY,movementX:a.movementX,movementY:a.movementY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey})}var d=a("../../util/dom"),n=a("../../util/window"),q=a("../../util/util");a=function(){q.bindAll(["_rotateCompassArrow"],
this)};a.prototype._rotateCompassArrow=function(){this._compassArrow.style.transform="rotate("+180/Math.PI*this._map.transform.angle+"deg)"};a.prototype.onAdd=function(a){this._map=a;this._container=d.create("div","mapboxgl-ctrl mapboxgl-ctrl-group",a.getContainer());this._container.addEventListener("contextmenu",this._onContextMenu.bind(this));this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",a.zoomIn.bind(a));this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out",
"Zoom Out",a.zoomOut.bind(a));this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",a.resetNorth.bind(a));this._compassArrow=d.create("span","mapboxgl-ctrl-compass-arrow",this._compass);this._compass.addEventListener("mousedown",this._onCompassDown.bind(this));this._onCompassMove=this._onCompassMove.bind(this);this._onCompassUp=this._onCompassUp.bind(this);this._map.on("rotate",this._rotateCompassArrow);this._rotateCompassArrow();return this._container};a.prototype.onRemove=
function(){this._container.parentNode.removeChild(this._container);this._map.off("rotate",this._rotateCompassArrow);this._map=void 0};a.prototype._onContextMenu=function(a){a.preventDefault()};a.prototype._onCompassDown=function(a){0===a.button&&(d.disableDrag(),n.document.addEventListener("mousemove",this._onCompassMove),n.document.addEventListener("mouseup",this._onCompassUp),this._map.getCanvasContainer().dispatchEvent(e(a)),a.stopPropagation())};a.prototype._onCompassMove=function(a){0===a.button&&
(this._map.getCanvasContainer().dispatchEvent(e(a)),a.stopPropagation())};a.prototype._onCompassUp=function(a){0===a.button&&(n.document.removeEventListener("mousemove",this._onCompassMove),n.document.removeEventListener("mouseup",this._onCompassUp),d.enableDrag(),this._map.getCanvasContainer().dispatchEvent(e(a)),a.stopPropagation())};a.prototype._createButton=function(a,e,m){a=d.create("button",a,this._container);a.type="button";a.setAttribute("aria-label",e);a.addEventListener("click",function(){m()});
return a};p.exports=a},{"../../util/dom":227,"../../util/util":241,"../../util/window":222}],206:[function(a,p,k){function e(a,c,d,e){var h;h=Math.pow(10,(""+Math.floor(d)).length-1);var b=d/h;h*=10<=b?10:5<=b?5:3<=b?3:2<=b?2:1;d=h/d;"m"===e&&1E3<=h&&(h/=1E3,e="km");a.style.width=c*d+"px";a.innerHTML=h+e}var d=a("../../util/dom"),n=a("../../util/util");a=function(a){this.options=a;n.bindAll(["_onMove"],this)};a.prototype.getDefaultPosition=function(){return"bottom-left"};a.prototype._onMove=function(){var a=
this._map,c=this._container,d=this.options,m=d&&d.maxWidth||100,h=a._container.clientHeight/2,b;b=a.unproject([0,h]);var a=a.unproject([m,h]),h=Math.PI/180,f=b.lat*h,g=a.lat*h;b=6371E3*Math.acos(Math.min(Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((a.lng-b.lng)*h),1));d&&"imperial"===d.unit?(d=3.2808*b,5280<d?e(c,m,d/5280,"mi"):e(c,m,d,"ft")):e(c,m,b,"m")};a.prototype.onAdd=function(a){this._map=a;this._container=d.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer());this._map.on("move",
this._onMove);this._onMove();return this._container};a.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map.off("move",this._onMove);this._map=void 0};p.exports=a},{"../../util/dom":227,"../../util/util":241}],207:[function(a,p,k){var e=a("../../util/dom"),d=a("../../geo/lng_lat_bounds"),n=a("../../util/util"),q=a("../../util/window");a=function(a){this._map=a;this._el=a.getCanvasContainer();this._container=a.getContainer();n.bindAll(["_onMouseDown","_onMouseMove",
"_onMouseUp","_onKeyDown"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.isActive=function(){return!!this._active};a.prototype.enable=function(){this.isEnabled()||(this._map.dragPan&&this._map.dragPan.disable(),this._el.addEventListener("mousedown",this._onMouseDown,!1),this._map.dragPan&&this._map.dragPan.enable(),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onMouseDown),this._enabled=!1)};a.prototype._onMouseDown=
function(a){a.shiftKey&&0===a.button&&(q.document.addEventListener("mousemove",this._onMouseMove,!1),q.document.addEventListener("keydown",this._onKeyDown,!1),q.document.addEventListener("mouseup",this._onMouseUp,!1),e.disableDrag(),this._startPos=e.mousePos(this._el,a),this._active=!0)};a.prototype._onMouseMove=function(a){var c=this._startPos,d=e.mousePos(this._el,a);this._box||(this._box=e.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",
a));a=Math.min(c.x,d.x);var h=Math.max(c.x,d.x),b=Math.min(c.y,d.y),c=Math.max(c.y,d.y);e.setTransform(this._box,"translate("+a+"px,"+b+"px)");this._box.style.width=h-a+"px";this._box.style.height=c-b+"px"};a.prototype._onMouseUp=function(a){if(0===a.button){var c=this._startPos,m=e.mousePos(this._el,a),h=(new d).extend(this._map.unproject(c)).extend(this._map.unproject(m));this._finish();c.x===m.x&&c.y===m.y?this._fireEvent("boxzoomcancel",a):this._map.fitBounds(h,{linear:!0}).fire("boxzoomend",
{originalEvent:a,boxZoomBounds:h})}};a.prototype._onKeyDown=function(a){27===a.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",a))};a.prototype._finish=function(){this._active=!1;q.document.removeEventListener("mousemove",this._onMouseMove,!1);q.document.removeEventListener("keydown",this._onKeyDown,!1);q.document.removeEventListener("mouseup",this._onMouseUp,!1);this._container.classList.remove("mapboxgl-crosshair");this._box&&(this._box.parentNode.removeChild(this._box),this._box=null);
e.enableDrag()};a.prototype._fireEvent=function(a,d){return this._map.fire(a,{originalEvent:d})};p.exports=a},{"../../geo/lng_lat_bounds":93,"../../util/dom":227,"../../util/util":241,"../../util/window":222}],208:[function(a,p,k){a=function(a){this._map=a;this._onDblClick=this._onDblClick.bind(this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=function(){this.isEnabled()||(this._map.on("dblclick",this._onDblClick),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&
(this._map.off("dblclick",this._onDblClick),this._enabled=!1)};a.prototype._onDblClick=function(a){this._map.zoomTo(this._map.getZoom()+(a.originalEvent.shiftKey?-1:1),{around:a.lngLat},a)};p.exports=a},{}],209:[function(a,p,k){var e=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window"),q=d.bezier(0,0,.3,1);a=function(a){this._map=a;this._el=a.getCanvasContainer();d.bindAll(["_onDown","_onMove","_onUp","_onTouchEnd","_onMouseUp"],this)};a.prototype.isEnabled=function(){return!!this._enabled};
a.prototype.isActive=function(){return!!this._active};a.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._el.addEventListener("mousedown",this._onDown),this._el.addEventListener("touchstart",this._onDown),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._el.removeEventListener("mousedown",this._onDown),this._el.removeEventListener("touchstart",this._onDown),this._enabled=
!1)};a.prototype._onDown=function(a){this._ignoreEvent(a)||this.isActive()||(a.touches?(n.document.addEventListener("touchmove",this._onMove),n.document.addEventListener("touchend",this._onTouchEnd)):(n.document.addEventListener("mousemove",this._onMove),n.document.addEventListener("mouseup",this._onMouseUp)),n.addEventListener("blur",this._onMouseUp),this._active=!1,this._startPos=this._pos=e.mousePos(this._el,a),this._inertia=[[Date.now(),this._pos]])};a.prototype._onMove=function(a){if(!this._ignoreEvent(a)){this.isActive()||
(this._active=!0,this._map.moving=!0,this._fireEvent("dragstart",a),this._fireEvent("movestart",a));var c=e.mousePos(this._el,a),d=this._map;d.stop();this._drainInertiaBuffer();this._inertia.push([Date.now(),c]);d.transform.setLocationAtPoint(d.transform.pointLocation(this._pos),c);this._fireEvent("drag",a);this._fireEvent("move",a);this._pos=c;a.preventDefault()}};a.prototype._onUp=function(a){var c=this;if(this.isActive()){this._active=!1;this._fireEvent("dragend",a);this._drainInertiaBuffer();
var d=function(){c._map.moving=!1;c._fireEvent("moveend",a)},e=this._inertia;if(2>e.length)d();else{var b=e[e.length-1],e=e[0],f=b[1].sub(e[1]),g=(b[0]-e[0])/1E3;0===g||b[1].equals(e[1])?d():(d=f.mult(.3/g),b=d.mag(),1400<b&&(b=1400,d._unit()._mult(b)),b/=750,d=d.mult(-b/2),this._map.panBy(d,{duration:1E3*b,easing:q,noMoveStart:!0},{originalEvent:a}))}}};a.prototype._onMouseUp=function(a){this._ignoreEvent(a)||(this._onUp(a),n.document.removeEventListener("mousemove",this._onMove),n.document.removeEventListener("mouseup",
this._onMouseUp),n.removeEventListener("blur",this._onMouseUp))};a.prototype._onTouchEnd=function(a){this._ignoreEvent(a)||(this._onUp(a),n.document.removeEventListener("touchmove",this._onMove),n.document.removeEventListener("touchend",this._onTouchEnd))};a.prototype._fireEvent=function(a,d){return this._map.fire(a,{originalEvent:d})};a.prototype._ignoreEvent=function(a){var c=this._map;return c.boxZoom&&c.boxZoom.isActive()||c.dragRotate&&c.dragRotate.isActive()?!0:a.touches?1<a.touches.length:
a.ctrlKey?!0:"mousemove"===a.type?a.buttons&0:a.button&&0!==a.button};a.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,d=Date.now();0<a.length&&160<d-a[0][0];)a.shift()};p.exports=a},{"../../util/dom":227,"../../util/util":241,"../../util/window":222}],210:[function(a,p,k){var e=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window"),q=d.bezier(0,0,.25,1);a=function(a,e){this._map=a;this._el=a.getCanvasContainer();this._bearingSnap=e.bearingSnap;this._pitchWithRotate=
!1!==e.pitchWithRotate;d.bindAll(["_onDown","_onMove","_onUp"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.isActive=function(){return!!this._active};a.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("mousedown",this._onDown),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("mousedown",this._onDown),this._enabled=!1)};a.prototype._onDown=function(a){this._ignoreEvent(a)||this.isActive()||(n.document.addEventListener("mousemove",
this._onMove),n.document.addEventListener("mouseup",this._onUp),n.addEventListener("blur",this._onUp),this._active=!1,this._inertia=[[Date.now(),this._map.getBearing()]],this._startPos=this._pos=e.mousePos(this._el,a),this._center=this._map.transform.centerPoint,a.preventDefault())};a.prototype._onMove=function(a){if(!this._ignoreEvent(a)){this.isActive()||(this._active=!0,this._map.moving=!0,this._fireEvent("rotatestart",a),this._fireEvent("movestart",a),this._pitchWithRotate&&this._fireEvent("pitchstart",
a));var c=this._map;c.stop();var d=this._pos,h=e.mousePos(this._el,a),b=.8*(d.x-h.x),d=-.5*(d.y-h.y),b=c.getBearing()-b,d=c.getPitch()-d,f=this._inertia,g=f[f.length-1];this._drainInertiaBuffer();f.push([Date.now(),c._normalizeBearing(b,g[1])]);c.transform.bearing=b;this._pitchWithRotate&&(this._fireEvent("pitch",a),c.transform.pitch=d);this._fireEvent("rotate",a);this._fireEvent("move",a);this._pos=h}};a.prototype._onUp=function(a){var c=this;if(!this._ignoreEvent(a)&&(n.document.removeEventListener("mousemove",
this._onMove),n.document.removeEventListener("mouseup",this._onUp),n.removeEventListener("blur",this._onUp),this.isActive())){this._active=!1;this._fireEvent("rotateend",a);this._drainInertiaBuffer();var d=this._map,e=d.getBearing(),b=this._inertia,f=function(){Math.abs(e)<c._bearingSnap?d.resetNorth({noMoveStart:!0},{originalEvent:a}):(c._map.moving=!1,c._fireEvent("moveend",a));c._pitchWithRotate&&c._fireEvent("pitchend",a)};if(2>b.length)f();else{var g=b[0],k=b[b.length-1],b=d._normalizeBearing(e,
b[b.length-2][1]),p=k[1]-g[1],z=0>p?-1:1,g=(k[0]-g[0])/1E3;0===p||0===g?f():(f=Math.abs(.25/g*p),180<f&&(f=180),g=f/180,b+=g/2*f*z,Math.abs(d._normalizeBearing(b,0))<this._bearingSnap&&(b=d._normalizeBearing(0,b)),d.rotateTo(b,{duration:1E3*g,easing:q,noMoveStart:!0},{originalEvent:a}))}}};a.prototype._fireEvent=function(a,d){return this._map.fire(a,{originalEvent:d})};a.prototype._ignoreEvent=function(a){var c=this._map;if(c.boxZoom&&c.boxZoom.isActive()||c.dragPan&&c.dragPan.isActive())return!0;
if(a.touches)return 1<a.touches.length;var c=a.ctrlKey?1:2,d=a.ctrlKey?0:2,e=a.button;"undefined"!==typeof InstallTrigger&&2===a.button&&a.ctrlKey&&0<=n.navigator.platform.toUpperCase().indexOf("MAC")&&(e=0);return"mousemove"===a.type?a.buttons&0===c:!this.isActive()&&e!==d};a.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,d=Date.now();0<a.length&&160<d-a[0][0];)a.shift()};p.exports=a},{"../../util/dom":227,"../../util/util":241,"../../util/window":222}],211:[function(a,p,k){function e(a){return a*
(2-a)}a=function(a){this._map=a;this._el=a.getCanvasContainer();this._onKeyDown=this._onKeyDown.bind(this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)};a.prototype._onKeyDown=function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d=0,k=0,c=0,
l=0,m=0;switch(a.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:a.shiftKey?k=-1:(a.preventDefault(),l=-1);break;case 39:a.shiftKey?k=1:(a.preventDefault(),l=1);break;case 38:a.shiftKey?c=1:(a.preventDefault(),m=-1);break;case 40:a.shiftKey?c=-1:(m=1,a.preventDefault());break;default:return}var h=this._map,b=h.getZoom(),d={duration:300,delayEndEvents:500,easing:e,zoom:d?Math.round(b)+d*(a.shiftKey?2:1):b,bearing:h.getBearing()+15*k,pitch:h.getPitch()+
10*c,offset:[100*-l,100*-m],center:h.getCenter()};h.easeTo(d,{originalEvent:a})}};p.exports=a},{}],212:[function(a,p,k){var e=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/browser"),q=a("../../util/window");a=q.navigator.userAgent.toLowerCase();var c=-1!==a.indexOf("firefox"),l=-1!==a.indexOf("safari")&&-1===a.indexOf("chrom");a=function(a){this._map=a;this._el=a.getCanvasContainer();d.bindAll(["_onWheel","_onTimeout"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=
function(a){this.isEnabled()||(this._el.addEventListener("wheel",this._onWheel,!1),this._el.addEventListener("mousewheel",this._onWheel,!1),this._enabled=!0,this._aroundCenter=a&&"center"===a.around)};a.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("wheel",this._onWheel),this._el.removeEventListener("mousewheel",this._onWheel),this._enabled=!1)};a.prototype._onWheel=function(a){var d;"wheel"===a.type?(d=a.deltaY,c&&a.deltaMode===q.WheelEvent.DOM_DELTA_PIXEL&&(d/=n.devicePixelRatio),
a.deltaMode===q.WheelEvent.DOM_DELTA_LINE&&(d*=40)):"mousewheel"===a.type&&(d=-a.wheelDeltaY,l&&(d/=3));var b=n.now(),f=b-(this._time||0);this._pos=e.mousePos(this._el,a);this._time=b;0!==d&&0===d%4.000244140625?this._type="wheel":0!==d&&4>Math.abs(d)?this._type="trackpad":400<f?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40)):this._type||(this._type=200>Math.abs(f*d)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue));
a.shiftKey&&d&&(d/=4);this._type&&this._zoom(-d,a);a.preventDefault()};a.prototype._onTimeout=function(){this._type="wheel";this._zoom(-this._lastValue)};a.prototype._zoom=function(a,c){if(0!==a){var b=this._map,d=2/(1+Math.exp(-Math.abs(a/100)));0>a&&0!==d&&(d=1/d);d=b.transform.scaleZoom((b.ease?b.ease.to:b.transform.scale)*d);b.zoomTo(d,{duration:"wheel"===this._type?200:0,around:this._aroundCenter?b.getCenter():b.unproject(this._pos),delayEndEvents:200,smoothEasing:!0},{originalEvent:c})}};p.exports=
a},{"../../util/browser":220,"../../util/dom":227,"../../util/util":241,"../../util/window":222}],213:[function(a,p,k){var e=a("../../util/dom"),d=a("../../util/util"),n=a("../../util/window"),q=d.bezier(0,0,.15,1);a=function(a){this._map=a;this._el=a.getCanvasContainer();d.bindAll(["_onStart","_onMove","_onEnd"],this)};a.prototype.isEnabled=function(){return!!this._enabled};a.prototype.enable=function(a){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._el.addEventListener("touchstart",
this._onStart,!1),this._enabled=!0,this._aroundCenter=a&&"center"===a.around)};a.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._el.removeEventListener("touchstart",this._onStart),this._enabled=!1)};a.prototype.disableRotation=function(){this._rotationDisabled=!0};a.prototype.enableRotation=function(){this._rotationDisabled=!1};a.prototype._onStart=function(a){if(2===a.touches.length){var c=e.mousePos(this._el,a.touches[0]);a=e.mousePos(this._el,
a.touches[1]);this._startVec=c.sub(a);this._startScale=this._map.transform.scale;this._startBearing=this._map.transform.bearing;this._gestureIntent=void 0;this._inertia=[];n.document.addEventListener("touchmove",this._onMove,!1);n.document.addEventListener("touchend",this._onEnd,!1)}};a.prototype._onMove=function(a){if(2===a.touches.length){var c=e.mousePos(this._el,a.touches[0]),d=e.mousePos(this._el,a.touches[1]),h=c.add(d).div(2),b=c.sub(d),f=b.mag()/this._startVec.mag(),c=this._rotationDisabled?
0:180*b.angleWith(this._startVec)/Math.PI,d=this._map;if(this._gestureIntent){b={duration:0,around:d.unproject(h)};"rotate"===this._gestureIntent&&(b.bearing=this._startBearing+c);if("zoom"===this._gestureIntent||"rotate"===this._gestureIntent)b.zoom=d.transform.scaleZoom(this._startScale*f);d.stop();this._drainInertiaBuffer();this._inertia.push([Date.now(),f,h]);d.easeTo(b,{originalEvent:a})}else h=.15<Math.abs(1-f),10<Math.abs(c)?this._gestureIntent="rotate":h&&(this._gestureIntent="zoom"),this._gestureIntent&&
(this._startVec=b,this._startScale=d.transform.scale,this._startBearing=d.transform.bearing);a.preventDefault()}};a.prototype._onEnd=function(a){n.document.removeEventListener("touchmove",this._onMove);n.document.removeEventListener("touchend",this._onEnd);this._drainInertiaBuffer();var c=this._inertia,d=this._map;if(2>c.length)d.snapToNorth({},{originalEvent:a});else{var e=c[c.length-1],b=c[0],c=d.transform.scaleZoom(this._startScale*e[1]),f=d.transform.scaleZoom(this._startScale*b[1]),g=c-f,b=(e[0]-
b[0])/1E3,e=e[2];0===b||c===f?d.snapToNorth({},{originalEvent:a}):(g=.15*g/b,2.5<Math.abs(g)&&(g=0<g?2.5:-2.5),f=1E3*Math.abs(g/(12*.15)),c+=g*f/2E3,0>c&&(c=0),d.easeTo({zoom:c,duration:f,easing:q,around:this._aroundCenter?d.getCenter():d.unproject(e)},{originalEvent:a}))}};a.prototype._drainInertiaBuffer=function(){for(var a=this._inertia,d=Date.now();2<a.length&&160<d-a[0][0];)a.shift()};p.exports=a},{"../../util/dom":227,"../../util/util":241,"../../util/window":222}],214:[function(a,p,k){var e=
a("../util/util"),d=a("../util/window");a=function(){e.bindAll(["_onHashChange","_updateHash"],this)};a.prototype.addTo=function(a){this._map=a;d.addEventListener("hashchange",this._onHashChange,!1);this._map.on("moveend",this._updateHash);return this};a.prototype.remove=function(){d.removeEventListener("hashchange",this._onHashChange,!1);this._map.off("moveend",this._updateHash);delete this._map;return this};a.prototype.getHashString=function(a){var d=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/
100,e=Math.max(0,Math.ceil(Math.log(c)/Math.LN2)),m=Math.round(d.lng*Math.pow(10,e))/Math.pow(10,e),d=Math.round(d.lat*Math.pow(10,e))/Math.pow(10,e),e=this._map.getBearing(),h=this._map.getPitch(),b="",b=a?b+("#/"+m+"/"+d+"/"+c):b+("#"+c+"/"+d+"/"+m);if(e||h)b+="/"+Math.round(10*e)/10;h&&(b+="/"+Math.round(h));return b};a.prototype._onHashChange=function(){var a=d.location.hash.replace("#","").split("/");return 3<=a.length?(this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:+(a[3]||0),pitch:+(a[4]||
0)}),!0):!1};a.prototype._updateHash=function(){var a=this.getHashString();d.history.replaceState("","",a)};p.exports=a},{"../util/util":241,"../util/window":222}],215:[function(a,p,k){var e=a("../util/util"),d=a("../util/browser"),n=a("../util/window"),q=a("../util/dom"),c=a("../util/ajax"),l=a("../style/style"),m=a("../style/animation_loop"),h=a("../render/painter"),b=a("../geo/transform"),f=a("./hash"),g=a("./bind_handlers");k=a("./camera");var u=a("../geo/lng_lat"),D=a("../geo/lng_lat_bounds"),
z=a("point-geometry"),t=a("./control/attribution_control"),r=a("./control/logo_control"),v=a("mapbox-gl-supported"),C={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null};a=function(a){function k(c){var d=
this;c=e.extend({},C,c);if(null!=c.minZoom&&null!=c.maxZoom&&c.minZoom>c.maxZoom)throw Error("maxZoom must be greater than minZoom");var h=new b(c.minZoom,c.maxZoom,c.renderWorldCopies);a.call(this,h,c);this._interactive=c.interactive;this._maxTileCacheSize=c.maxTileCacheSize;this._failIfMajorPerformanceCaveat=c.failIfMajorPerformanceCaveat;this._preserveDrawingBuffer=c.preserveDrawingBuffer;this._trackResize=c.trackResize;this._bearingSnap=c.bearingSnap;this._refreshExpiredTiles=c.refreshExpiredTiles;
if("string"===typeof c.container){if(this._container=n.document.getElementById(c.container),!this._container)throw Error("Container '"+c.container+"' not found.");}else this._container=c.container;this.animationLoop=new m;c.maxBounds&&this.setMaxBounds(c.maxBounds);e.bindAll("_onWindowOnline _onWindowResize _contextLost _contextRestored _update _render _onData _onDataLoading".split(" "),this);this._setupContainer();this._setupPainter();this.on("move",this._update.bind(this,!1));this.on("zoom",this._update.bind(this,
!0));this.on("moveend",function(){d.animationLoop.set(300);d._rerender()});"undefined"!==typeof n&&(n.addEventListener("online",this._onWindowOnline,!1),n.addEventListener("resize",this._onWindowResize,!1));g(this,c);(this._hash=c.hash&&(new f).addTo(this))&&this._hash._onHashChange()||this.jumpTo({center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch});this._classes=[];this.resize();c.classes&&this.setClasses(c.classes);c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily});
c.attributionControl&&this.addControl(new t);this.addControl(new r,c.logoPosition);this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet);this.style.update(this._classes,{transition:!1})});this.on("data",this._onData);this.on("dataloading",this._onDataLoading)}a&&(k.__proto__=a);k.prototype=Object.create(a&&a.prototype);k.prototype.constructor=k;var p={showTileBoundaries:{},showCollisionBoxes:{},showOverdrawInspector:{},repaint:{},vertices:{}};k.prototype.addControl=
function(a,b){void 0===b&&a.getDefaultPosition&&(b=a.getDefaultPosition());void 0===b&&(b="top-right");var c=a.onAdd(this),d=this._controlPositions[b];-1!==b.indexOf("bottom")?d.insertBefore(c,d.firstChild):d.appendChild(c);return this};k.prototype.removeControl=function(a){a.onRemove(this);return this};k.prototype.addClass=function(a,b){e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");if(0<=this._classes.indexOf(a)||""===a)return this;this._classes.push(a);
this._classOptions=b;this.style&&this.style.updateClasses();return this._update(!0)};k.prototype.removeClass=function(a,b){e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");var c=this._classes.indexOf(a);if(0>c||""===a)return this;this._classes.splice(c,1);this._classOptions=b;this.style&&this.style.updateClasses();return this._update(!0)};k.prototype.setClasses=function(a,b){e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");
for(var c={},d=0;d<a.length;d++)""!==a[d]&&(c[a[d]]=!0);this._classes=Object.keys(c);this._classOptions=b;this.style&&this.style.updateClasses();return this._update(!0)};k.prototype.hasClass=function(a){e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");return 0<=this._classes.indexOf(a)};k.prototype.getClasses=function(){e.warnOnce("Style classes are deprecated and will be removed in an upcoming release of Mapbox GL JS.");return this._classes};
k.prototype.resize=function(){var a=this._containerDimensions(),b=a[0],a=a[1];this._resizeCanvas(b,a);this.transform.resize(b,a);this.painter.resize(b,a);return this.fire("movestart").fire("move").fire("resize").fire("moveend")};k.prototype.getBounds=function(){var a=new D(this.transform.pointLocation(new z(0,this.transform.height)),this.transform.pointLocation(new z(this.transform.width,0)));if(this.transform.angle||this.transform.pitch)a.extend(this.transform.pointLocation(new z(this.transform.size.x,
0))),a.extend(this.transform.pointLocation(new z(0,this.transform.size.y)));return a};k.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new D([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null};k.prototype.setMaxBounds=function(a){if(a)a=D.convert(a),this.transform.lngRange=[a.getWest(),a.getEast()],this.transform.latRange=
[a.getSouth(),a.getNorth()],this.transform._constrain(),this._update();else if(null===a||void 0===a)this.transform.lngRange=[],this.transform.latRange=[],this._update();return this};k.prototype.setMinZoom=function(a){a=null===a||void 0===a?0:a;if(0<=a&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a&&this.setZoom(a),this;throw Error("minZoom must be between 0 and the current maxZoom, inclusive");};k.prototype.getMinZoom=function(){return this.transform.minZoom};
k.prototype.setMaxZoom=function(a){a=null===a||void 0===a?22:a;if(a>=this.transform.minZoom)return this.transform.maxZoom=a,this._update(),this.getZoom()>a&&this.setZoom(a),this;throw Error("maxZoom must be greater than the current minZoom");};k.prototype.getMaxZoom=function(){return this.transform.maxZoom};k.prototype.project=function(a){return this.transform.locationPoint(u.convert(a))};k.prototype.unproject=function(a){return this.transform.pointLocation(z.convert(a))};k.prototype.on=function(b,
c,d){var f=this;if(void 0===d)return a.prototype.on.call(this,b,c);var g=function(){if("mouseenter"===b||"mouseover"===b){var a=!1;return{layer:c,listener:d,delegates:{mousemove:function(g){var h=f.queryRenderedFeatures(g.point,{layers:[c]});h.length?a||(a=!0,d.call(f,e.extend({features:h},g,{type:b}))):a=!1},mouseout:function(){a=!1}}}}if("mouseleave"===b||"mouseout"===b){var g=!1;return{layer:c,listener:d,delegates:{mousemove:function(a){f.queryRenderedFeatures(a.point,{layers:[c]}).length?g=!0:
g&&(g=!1,d.call(f,e.extend({},a,{type:b})))},mouseout:function(a){g&&(g=!1,d.call(f,e.extend({},a,{type:b})))}}}}return{layer:c,listener:d,delegates:(h={},h[b]=function(a){var b=f.queryRenderedFeatures(a.point,{layers:[c]});b.length&&d.call(f,e.extend({features:b},a))},h)};var h}();this._delegatedListeners=this._delegatedListeners||{};this._delegatedListeners[b]=this._delegatedListeners[b]||[];this._delegatedListeners[b].push(g);for(var h in g.delegates)f.on(h,g.delegates[h]);return this};k.prototype.off=
function(b,c,d){if(void 0===d)return a.prototype.off.call(this,b,c);if(this._delegatedListeners&&this._delegatedListeners[b]){b=this._delegatedListeners[b];for(var e=0;e<b.length;e++){var f=b[e];if(f.layer===c&&f.listener===d){for(var g in f.delegates)this.off(g,f.delegates[g]);b.splice(e,1);return this}}}};k.prototype.queryRenderedFeatures=function(){for(var a=[],b=arguments.length;b--;)a[b]=arguments[b];var b={},c;if(2===a.length)c=arguments[0],b=arguments[1];else{var d;if(d=1===a.length)d=a[0],
d=d instanceof z||Array.isArray(d);d?c=a[0]:1===a.length&&(b=a[0])}return this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(c),b,this.transform.zoom,this.transform.angle):[]};k.prototype._makeQueryGeometry=function(a){var b=this;void 0===a&&(a=[z.convert([0,0]),z.convert([this.transform.width,this.transform.height])]);a instanceof z||"number"===typeof a[0]?a=[z.convert(a)]:(a=[z.convert(a[0]),z.convert(a[1])],a=[a[0],new z(a[1].x,a[0].y),a[1],new z(a[0].x,a[1].y),a[0]]);return a=
a.map(function(a){return b.transform.pointCoordinate(a)})};k.prototype.querySourceFeatures=function(a,b){return this.style.querySourceFeatures(a,b)};k.prototype.setStyle=function(a,b){if((!b||!1!==b.diff&&!b.localIdeographFontFamily)&&this.style&&a&&!(a instanceof l)&&"string"!==typeof a)try{return this.style.setState(a)&&this._update(!0),this}catch(G){e.warnOnce("Unable to perform style diff: "+(G.message||G.error||G)+".  Rebuilding the style from scratch.")}this.style&&(this.style.setEventedParent(null),
this.style._remove(),this.off("rotate",this.style._redoPlacement),this.off("pitch",this.style._redoPlacement),this.off("move",this.style._redoPlacement));if(a)this.style=a instanceof l?a:new l(a,this,b);else return this.style=null,this;this.style.setEventedParent(this,{style:this.style});this.on("rotate",this.style._redoPlacement);this.on("pitch",this.style._redoPlacement);this.on("move",this.style._redoPlacement);return this};k.prototype.getStyle=function(){if(this.style)return this.style.serialize()};
k.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")};k.prototype.addSource=function(a,b){this.style.addSource(a,b);this._update(!0);return this};k.prototype.isSourceLoaded=function(a){var b=this.style&&this.style.sourceCaches[a];if(void 0===b)this.fire("error",{error:Error("There is no source with ID '"+a+"'")});else return b.loaded()};k.prototype.areTilesLoaded=function(){var a=this.style&&this.style.sourceCaches,b;for(b in a){var c=
a[b]._tiles,d;for(d in c){var e=c[d];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0};k.prototype.addSourceType=function(a,b,c){return this.style.addSourceType(a,b,c)};k.prototype.removeSource=function(a){this.style.removeSource(a);this._update(!0);return this};k.prototype.getSource=function(a){return this.style.getSource(a)};k.prototype.addImage=function(a,b,c){this.style.spriteAtlas.addImage(a,b,c)};k.prototype.removeImage=function(a){this.style.spriteAtlas.removeImage(a)};k.prototype.loadImage=
function(a,b){c.getImage(a,b)};k.prototype.addLayer=function(a,b){this.style.addLayer(a,b);this._update(!0);return this};k.prototype.moveLayer=function(a,b){this.style.moveLayer(a,b);this._update(!0);return this};k.prototype.removeLayer=function(a){this.style.removeLayer(a);this._update(!0);return this};k.prototype.getLayer=function(a){return this.style.getLayer(a)};k.prototype.setFilter=function(a,b){this.style.setFilter(a,b);this._update(!0);return this};k.prototype.setLayerZoomRange=function(a,
b,c){this.style.setLayerZoomRange(a,b,c);this._update(!0);return this};k.prototype.getFilter=function(a){return this.style.getFilter(a)};k.prototype.setPaintProperty=function(a,b,c,d){this.style.setPaintProperty(a,b,c,d);this._update(!0);return this};k.prototype.getPaintProperty=function(a,b,c){return this.style.getPaintProperty(a,b,c)};k.prototype.setLayoutProperty=function(a,b,c){this.style.setLayoutProperty(a,b,c);this._update(!0);return this};k.prototype.getLayoutProperty=function(a,b){return this.style.getLayoutProperty(a,
b)};k.prototype.setLight=function(a){this.style.setLight(a);this._update(!0);return this};k.prototype.getLight=function(){return this.style.getLight()};k.prototype.getContainer=function(){return this._container};k.prototype.getCanvasContainer=function(){return this._canvasContainer};k.prototype.getCanvas=function(){return this._canvas};k.prototype._containerDimensions=function(){var a=0,b=0;this._container&&(a=this._container.offsetWidth||400,b=this._container.offsetHeight||300);return[a,b]};k.prototype._setupContainer=
function(){var a=this._container;a.classList.add("mapboxgl-map");var b=this._canvasContainer=q.create("div","mapboxgl-canvas-container",a);this._interactive&&b.classList.add("mapboxgl-interactive");this._canvas=q.create("canvas","mapboxgl-canvas",b);this._canvas.style.position="absolute";this._canvas.addEventListener("webglcontextlost",this._contextLost,!1);this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1);this._canvas.setAttribute("tabindex","0");this._canvas.setAttribute("aria-label",
"Map");b=this._containerDimensions();this._resizeCanvas(b[0],b[1]);var c=this._controlContainer=q.create("div","mapboxgl-control-container",a),d=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(a){d[a]=q.create("div","mapboxgl-ctrl-"+a,c)})};k.prototype._resizeCanvas=function(a,b){var c=n.devicePixelRatio||1;this._canvas.width=c*a;this._canvas.height=c*b;this._canvas.style.width=a+"px";this._canvas.style.height=b+"px"};k.prototype._setupPainter=function(){var a=
e.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},v.webGLContextAttributes);(a=this._canvas.getContext("webgl",a)||this._canvas.getContext("experimental-webgl",a))?this.painter=new h(a,this.transform):this.fire("error",{error:Error("Failed to initialize WebGL")})};k.prototype._contextLost=function(a){a.preventDefault();this._frameId&&(d.cancelFrame(this._frameId),this._frameId=null);this.fire("webglcontextlost",{originalEvent:a})};
k.prototype._contextRestored=function(a){this._setupPainter();this.resize();this._update();this.fire("webglcontextrestored",{originalEvent:a})};k.prototype.loaded=function(){return this._styleDirty||this._sourcesDirty||!this.style||!this.style.loaded()?!1:!0};k.prototype._update=function(a){if(!this.style)return this;this._styleDirty=this._styleDirty||a;this._sourcesDirty=!0;this._rerender();return this};k.prototype._render=function(){this.style&&this._styleDirty&&(this._styleDirty=!1,this.style.update(this._classes,
this._classOptions),this._classOptions=null,this.style._recalculate(this.transform.zoom));this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform));this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.rotating,zooming:this.zooming});this.fire("render");this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire("load"));this._frameId=null;this.animationLoop.stopped()||(this._styleDirty=
!0);(this._sourcesDirty||this._repaint||this._styleDirty)&&this._rerender();return this};k.prototype.remove=function(){this._hash&&this._hash.remove();d.cancelFrame(this._frameId);this._frameId=null;this.setStyle(null);"undefined"!==typeof n&&(n.removeEventListener("resize",this._onWindowResize,!1),n.removeEventListener("online",this._onWindowOnline,!1));var a=this.painter.gl.getExtension("WEBGL_lose_context");a&&a.loseContext();a=this._canvasContainer;a.parentNode&&a.parentNode.removeChild(a);a=
this._controlContainer;a.parentNode&&a.parentNode.removeChild(a);this._container.classList.remove("mapboxgl-map");this.fire("remove")};k.prototype._rerender=function(){this.style&&!this._frameId&&(this._frameId=d.frame(this._render))};k.prototype._onWindowOnline=function(){this._update()};k.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()};p.showTileBoundaries.get=function(){return!!this._showTileBoundaries};p.showTileBoundaries.set=function(a){this._showTileBoundaries!==
a&&(this._showTileBoundaries=a,this._update())};p.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes};p.showCollisionBoxes.set=function(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,this.style._redoPlacement())};p.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector};p.showOverdrawInspector.set=function(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())};p.repaint.get=function(){return!!this._repaint};p.repaint.set=
function(a){this._repaint=a;this._update()};p.vertices.get=function(){return!!this._vertices};p.vertices.set=function(a){this._vertices=a;this._update()};k.prototype._onData=function(a){this._update("style"===a.dataType);this.fire(a.dataType+"data",a)};k.prototype._onDataLoading=function(a){this.fire(a.dataType+"dataloading",a)};Object.defineProperties(k.prototype,p);return k}(k);p.exports=a},{"../geo/lng_lat":92,"../geo/lng_lat_bounds":93,"../geo/transform":94,"../render/painter":108,"../style/animation_loop":169,
"../style/style":172,"../util/ajax":219,"../util/browser":220,"../util/dom":227,"../util/util":241,"../util/window":222,"./bind_handlers":199,"./camera":200,"./control/attribution_control":201,"./control/logo_control":204,"./hash":214,"mapbox-gl-supported":37,"point-geometry":56}],216:[function(a,p,k){var e=a("../util/dom"),d=a("../geo/lng_lat"),n=a("point-geometry"),q=a("../util/smart_wrap");a=function(a,d){this._offset=n.convert(d&&d.offset||[0,0]);this._update=this._update.bind(this);this._onMapClick=
this._onMapClick.bind(this);a||(a=e.create("div"));a.classList.add("mapboxgl-marker");this._element=a;this._popup=null};a.prototype.addTo=function(a){this.remove();this._map=a;a.getCanvasContainer().appendChild(this._element);a.on("move",this._update);a.on("moveend",this._update);this._update();this._map.on("click",this._onMapClick);return this};a.prototype.remove=function(){this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),
this._map=null);e.remove(this._element);this._popup&&this._popup.remove();return this};a.prototype.getLngLat=function(){return this._lngLat};a.prototype.setLngLat=function(a){this._lngLat=d.convert(a);this._pos=null;this._popup&&this._popup.setLngLat(this._lngLat);this._update();return this};a.prototype.getElement=function(){return this._element};a.prototype.setPopup=function(a){this._popup&&(this._popup.remove(),this._popup=null);a&&("offset"in a.options||(a.options.offset=this._offset),this._popup=
a,this._popup.setLngLat(this._lngLat));return this};a.prototype._onMapClick=function(a){a=a.originalEvent.target;var c=this._element;this._popup&&(a===c||c.contains(a))&&this.togglePopup()};a.prototype.getPopup=function(){return this._popup};a.prototype.togglePopup=function(){var a=this._popup;a&&(a.isOpen()?a.remove():a.addTo(this._map))};a.prototype._update=function(a){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=q(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset)._add({x:-this._element.offsetWidth/
2,y:-this._element.offsetHeight/2}),a&&"moveend"!==a.type||(this._pos=this._pos.round()),e.setTransform(this._element,"translate("+this._pos.x+"px, "+this._pos.y+"px)"))};p.exports=a},{"../geo/lng_lat":92,"../util/dom":227,"../util/smart_wrap":237,"point-geometry":56}],217:[function(a,p,k){function e(a){if(a){if("number"===typeof a){var b=Math.round(Math.sqrt(.5*Math.pow(a,2)));return{top:new c(0,a),"top-left":new c(b,b),"top-right":new c(-b,b),bottom:new c(0,-a),"bottom-left":new c(b,-b),"bottom-right":new c(-b,
-b),left:new c(a,0),right:new c(-a,0)}}return a instanceof c||Array.isArray(a)?(a=c.convert(a),{top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}):{top:c.convert(a.top||[0,0]),"top-left":c.convert(a["top-left"]||[0,0]),"top-right":c.convert(a["top-right"]||[0,0]),bottom:c.convert(a.bottom||[0,0]),"bottom-left":c.convert(a["bottom-left"]||[0,0]),"bottom-right":c.convert(a["bottom-right"]||[0,0]),left:c.convert(a.left||[0,0]),right:c.convert(a.right||[0,0])}}return e(new c(0,
0))}var d=a("../util/util");k=a("../util/evented");var n=a("../util/dom"),q=a("../geo/lng_lat"),c=a("point-geometry"),l=a("../util/window"),m=a("../util/smart_wrap"),h={closeButton:!0,closeOnClick:!0};a=function(a){function b(b){a.call(this);this.options=d.extend(Object.create(h),b);d.bindAll(["_update","_onClickClose"],this)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.addTo=function(a){this._map=a;this._map.on("move",this._update);if(this.options.closeOnClick)this._map.on("click",
this._onClickClose);this._update();return this};b.prototype.isOpen=function(){return!!this._map};b.prototype.remove=function(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content);this._container&&(this._container.parentNode.removeChild(this._container),delete this._container);this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map);this.fire("close");return this};b.prototype.getLngLat=function(){return this._lngLat};
b.prototype.setLngLat=function(a){this._lngLat=q.convert(a);this._pos=null;this._update();return this};b.prototype.setText=function(a){return this.setDOMContent(l.document.createTextNode(a))};b.prototype.setHTML=function(a){var b=l.document.createDocumentFragment(),c=l.document.createElement("body");for(c.innerHTML=a;;){a=c.firstChild;if(!a)break;b.appendChild(a)}return this.setDOMContent(b)};b.prototype.setDOMContent=function(a){this._createContent();this._content.appendChild(a);this._update();return this};
b.prototype._createContent=function(){this._content&&this._content.parentNode&&this._content.parentNode.removeChild(this._content);this._content=n.create("div","mapboxgl-popup-content",this._container);this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))};
b.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content));this._map.transform.renderWorldCopies&&(this._lngLat=m(this._lngLat,this._pos,this._map.transform));this._pos=this._map.project(this._lngLat);var a=this.options.anchor,b=e(this.options.offset);if(!a){var c=this._container.offsetWidth,
a=this._container.offsetHeight,a=this._pos.y+b.bottom.y<a?["top"]:this._pos.y>this._map.transform.height-a?["bottom"]:[];this._pos.x<c/2?a.push("left"):this._pos.x>this._map.transform.width-c/2&&a.push("right");a=0===a.length?"bottom":a.join("-")}var b=this._pos.add(b[a]).round(),c={top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},
d=this._container.classList,f;for(f in c)d.remove("mapboxgl-popup-anchor-"+f);d.add("mapboxgl-popup-anchor-"+a);n.setTransform(this._container,c[a]+" translate("+b.x+"px,"+b.y+"px)")}};b.prototype._onClickClose=function(){this.remove()};return b}(k);p.exports=a},{"../geo/lng_lat":92,"../util/dom":227,"../util/evented":228,"../util/smart_wrap":237,"../util/util":241,"../util/window":222,"point-geometry":56}],218:[function(a,p,k){a=function(a,d,k){this.target=a;this.parent=d;this.mapId=k;this.callbacks=
{};this.callbackID=0;this.receive=this.receive.bind(this);this.target.addEventListener("message",this.receive,!1)};a.prototype.send=function(a,d,k,q,c){var e=k?this.mapId+":"+this.callbackID++:null;k&&(this.callbacks[e]=k);this.target.postMessage({targetMapId:c,sourceMapId:this.mapId,type:a,id:String(e),data:d},q)};a.prototype.receive=function(a){var d=this;a=a.data;var e=a.id,k;if(!a.targetMapId||this.mapId===a.targetMapId)if(k=function(a,c,h){d.target.postMessage({sourceMapId:d.mapId,type:"<response>",
id:String(e),error:a?String(a):null,data:c},h)},"<response>"===a.type)k=this.callbacks[a.id],delete this.callbacks[a.id],k&&a.error?k(Error(a.error)):k&&k(null,a.data);else if("undefined"!==typeof a.id&&this.parent[a.type])this.parent[a.type](a.sourceMapId,a.data,k);else if("undefined"!==typeof a.id&&this.parent.getWorkerSource){var c=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,c[0])[c[1]](a.data,k)}else this.parent[a.type](a.data)};a.prototype.remove=function(){this.target.removeEventListener("message",
this.receive,!1)};p.exports=a},{}],219:[function(a,p,k){function e(a){var c=d.document.createElement("a");c.href=a;return c.protocol===d.document.location.protocol&&c.host===d.document.location.host}var d=a("./window"),n=function(a){function c(c,d){a.call(this,c);this.status=d}a&&(c.__proto__=a);c.prototype=Object.create(a&&a.prototype);return c.prototype.constructor=c}(Error);k.getJSON=function(a,c){var e=new d.XMLHttpRequest;e.open("GET",a,!0);e.setRequestHeader("Accept","application/json");e.onerror=
function(){c(Error(e.statusText))};e.onload=function(){if(200<=e.status&&300>e.status&&e.response){var a;try{a=JSON.parse(e.response)}catch(h){return c(h)}c(null,a)}else c(new n(e.statusText,e.status))};e.send();return e};k.getArrayBuffer=function(a,c){var e=new d.XMLHttpRequest;e.open("GET",a,!0);e.responseType="arraybuffer";e.onerror=function(){c(Error(e.statusText))};e.onload=function(){var a=e.response;if(0===a.byteLength&&200===e.status)return c(Error("http status 200 returned without content."));
200<=e.status&&300>e.status&&e.response?c(null,{data:a,cacheControl:e.getResponseHeader("Cache-Control"),expires:e.getResponseHeader("Expires")}):c(new n(e.statusText,e.status))};e.send();return e};k.getImage=function(a,c){return k.getArrayBuffer(a,function(a,e){if(a)c(a);else if(e){var h=new d.Image,b=d.URL||d.webkitURL;h.onload=function(){c(null,h);b.revokeObjectURL(h.src)};var f=new d.Blob([new Uint8Array(e.data)],{type:"image/png"});h.cacheControl=e.cacheControl;h.expires=e.expires;h.src=e.data.byteLength?
b.createObjectURL(f):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})};k.getVideo=function(a,c){var l=d.document.createElement("video");l.onloadstart=function(){c(null,l)};for(var m=0;m<a.length;m++){var h=d.document.createElement("source");e(a[m])||(l.crossOrigin="Anonymous");h.src=a[m];l.appendChild(h)}return l}},{"./window":222}],220:[function(a,p,k){var e=a("./window"),d=e.performance&&e.performance.now?e.performance.now.bind(e.performance):
Date.now.bind(Date),n=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame,q=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.msCancelAnimationFrame;p.exports={now:d,frame:function(a){return n(a)},cancelFrame:function(a){return q(a)},timed:function(a,e,m){function c(){if(!b){var g=d();g>=f+e?a.call(m,1):(a.call(m,(g-f)/e),n(c))}}if(!e)return a.call(m,1),null;var b=!1,f=d();n(c);return function(){b=!0}},getImageData:function(a){var c=
e.document.createElement("canvas"),d=c.getContext("2d");c.width=a.width;c.height=a.height;d.drawImage(a,0,0,a.width,a.height);return d.getImageData(0,0,a.width,a.height).data},hardwareConcurrency:e.navigator.hardwareConcurrency||4,get devicePixelRatio(){return e.devicePixelRatio},supportsWebp:!1};a=e.document.createElement("img");a.onload=function(){p.exports.supportsWebp=!0};a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="},{"./window":222}],221:[function(a,p,k){k=
a("webworkify");var e=a("../window"),d=e.URL.createObjectURL(new k(a("../../source/worker"),{bare:!0}));p.exports=function(){return new e.Worker(d)}},{"../../source/worker":133,"../window":222,webworkify:71}],222:[function(a,p,k){p.exports=self},{}],223:[function(a,p,k){function e(a,c){return c.area-a.area}var d=a("quickselect"),n=a("./util").calculateSignedArea;p.exports=function(a,c){var l=a.length;if(1>=l)return[a];for(var m=[],h,b,f=0;f<l;f++){var g=n(a[f]);0!==g&&(a[f].area=Math.abs(g),void 0===
b&&(b=0>g),b===0>g?(h&&m.push(h),h=[a[f]]):h.push(a[f]))}h&&m.push(h);if(1<c)for(l=0;l<m.length;l++)m[l].length<=c||(d(m[l],c,1,m[l].length-1,e),m[l]=m[l].slice(0,c));return m}},{"./util":241,quickselect:58}],224:[function(a,p,k){p.exports={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null}},{}],225:[function(a,p,k){var e=a("assert");a=function(a){this._stringToNumber={};this._numberToString=[];for(var d=0;d<a.length;d++){var e=a[d];this._stringToNumber[e]=d;this._numberToString[d]=
e}};a.prototype.encode=function(a){e(a in this._stringToNumber);return this._stringToNumber[a]};a.prototype.decode=function(a){e(a<this._numberToString.length);return this._numberToString[a]};p.exports=a},{assert:9}],226:[function(a,p,k){var e=a("./util"),d=a("./actor");a=function(a,k){this.workerPool=a;this.actors=[];this.currentActor=0;this.id=e.uniqueId();for(var c=this.workerPool.acquire(this.id),l=0;l<c.length;l++){var m=new d(c[l],k,this.id);m.name="Worker "+l;this.actors.push(m)}};a.prototype.broadcast=
function(a,d,c){e.asyncAll(this.actors,function(c,e){c.send(a,d,e)},c||function(){})};a.prototype.send=function(a,d,c,e,m){if("number"!==typeof e||isNaN(e))e=this.currentActor=(this.currentActor+1)%this.actors.length;this.actors[e].send(a,d,c,m);return e};a.prototype.remove=function(){this.actors.forEach(function(a){a.remove()});this.actors=[];this.workerPool.release(this.id)};p.exports=a},{"./actor":218,"./util":241}],227:[function(a,p,k){function e(a){for(var b=0;b<a.length;b++)if(a[b]in c)return a[b];
return a[0]}function d(a){a.preventDefault();a.stopPropagation();q.removeEventListener("click",d,!0)}var n=a("point-geometry"),q=a("./window");k.create=function(a,c,d){a=q.document.createElement(a);c&&(a.className=c);d&&d.appendChild(a);return a};var c=q.document.documentElement.style,l=e(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),m;k.disableDrag=function(){l&&(m=c[l],c[l]="none")};k.enableDrag=function(){l&&(c[l]=m)};var h=e(["transform","WebkitTransform"]);k.setTransform=
function(a,c){a.style[h]=c};k.suppressClick=function(){q.addEventListener("click",d,!0);q.setTimeout(function(){q.removeEventListener("click",d,!0)},0)};k.mousePos=function(a,c){var b=a.getBoundingClientRect();c=c.touches?c.touches[0]:c;return new n(c.clientX-b.left-a.clientLeft,c.clientY-b.top-a.clientTop)};k.touchPos=function(a,c){for(var b=a.getBoundingClientRect(),d=[],e="touchend"===c.type?c.changedTouches:c.touches,f=0;f<e.length;f++)d.push(new n(e[f].clientX-b.left-a.clientLeft,e[f].clientY-
b.top-a.clientTop));return d};k.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)}},{"./window":222,"point-geometry":56}],228:[function(a,p,k){function e(a,d,c){c&&c[a]&&(d=c[a].indexOf(d),-1!==d&&c[a].splice(d,1))}var d=a("./util");a=function(){};a.prototype.on=function(a,d){var c=this._listeners=this._listeners||{};c[a]=c[a]||[];c[a].push(d);return this};a.prototype.off=function(a,d){e(a,d,this._listeners);e(a,d,this._oneTimeListeners);return this};a.prototype.once=function(a,d){var c=
this._oneTimeListeners=this._oneTimeListeners||{};c[a]=c[a]||[];c[a].push(d);return this};a.prototype.fire=function(a,k){if(this.listens(a)){k=d.extend({},k,{type:a,target:this});for(var c=this._listeners&&this._listeners[a]?this._listeners[a].slice():[],l=0;l<c.length;l++)c[l].call(this,k);c=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(l=0;l<c.length;l++)c[l].call(this,k),e(a,c[l],this._oneTimeListeners);this._eventedParent&&this._eventedParent.fire(a,
d.extend({},k,"function"===typeof this._eventedParentData?this._eventedParentData():this._eventedParentData))}else d.endsWith(a,"error")&&console.error(k&&k.error||k||"Empty error event");return this};a.prototype.listens=function(a){return this._listeners&&this._listeners[a]&&0<this._listeners[a].length||this._oneTimeListeners&&this._oneTimeListeners[a]&&0<this._oneTimeListeners[a].length||this._eventedParent&&this._eventedParent.listens(a)};a.prototype.setEventedParent=function(a,d){this._eventedParent=
a;this._eventedParentData=d;return this};p.exports=a},{"./util":241}],229:[function(a,p,k){function e(a,c){return c.max-a.max}function d(a,d,e,b){this.p=new q(a,d);this.h=e;a=this.p;d=!1;e=Infinity;for(var f=0;f<b.length;f++)for(var g=b[f],h=0,l=g.length,m=l-1;h<l;m=h++){var k=g[h],m=g[m];k.y>a.y!==m.y>a.y&&a.x<(m.x-k.x)*(a.y-k.y)/(m.y-k.y)+k.x&&(d=!d);e=Math.min(e,c(a,k,m))}this.d=(d?1:-1)*Math.sqrt(e);this.max=this.d+this.h*Math.SQRT2}var n=a("tinyqueue"),q=a("point-geometry"),c=a("./intersection_tests").distToSegmentSquared;
p.exports=function(a,c,h){c=c||1;for(var b,f,g,l,m=a[0],k=0;k<m.length;k++){var q=m[k];if(!k||q.x<b)b=q.x;if(!k||q.y<f)f=q.y;if(!k||q.x>g)g=q.x;if(!k||q.y>l)l=q.y}q=Math.min(g-b,l-f);k=q/2;m=new n(null,e);if(0===q)return[b,f];for(;b<g;b+=q)for(var p=f;p<l;p+=q)m.push(new d(b+k,p+k,k,a));l=g=f=0;k=a[0];b=0;for(var q=k.length,v=q-1;b<q;v=b++){var p=k[b],v=k[v],C=p.x*v.y-v.x*p.y;g+=(p.x+v.x)*C;l+=(p.y+v.y)*C;f+=3*C}f=new d(g/f,l/f,0,a);for(g=m.length;m.length;){l=m.pop();if(l.d>f.d||!f.d)f=l,h&&console.log("found best %d after %d probes",
Math.round(1E4*l.d)/1E4,g);l.max-f.d<=c||(k=l.h/2,m.push(new d(l.p.x-k,l.p.y-k,k,a)),m.push(new d(l.p.x+k,l.p.y-k,k,a)),m.push(new d(l.p.x-k,l.p.y+k,k,a)),m.push(new d(l.p.x+k,l.p.y+k,k,a)),g+=4)}h&&(console.log("num probes: "+g),console.log("best distance: "+f.d));return f.p}},{"./intersection_tests":232,"point-geometry":56,tinyqueue:60}],230:[function(a,p,k){var e=a("./worker_pool"),d;p.exports=function(){d||(d=new e);return d}},{"./worker_pool":244}],231:[function(a,p,k){function e(a,c,e){1===
a&&(a=e.readMessage(d,{glyphs:{}}),c.push(a))}function d(a,c,d){1===a?c.name=d.readString():2===a?c.range=d.readString():3===a&&(a=d.readMessage(n,{}),c.glyphs[a.id]=a)}function n(a,c,d){1===a?c.id=d.readVarint():2===a?c.bitmap=d.readBytes():3===a?c.width=d.readVarint():4===a?c.height=d.readVarint():5===a?c.left=d.readSVarint():6===a?c.top=d.readSVarint():7===a&&(c.advance=d.readVarint())}p.exports=function(a,c){this.stacks=a.readFields(e,[],c)}},{}],232:[function(a,p,k){function e(a,c){if(0===a.length||
0===c.length)return!1;for(var b=0;b<a.length-1;b++)for(var d=a[b],e=a[b+1],h=0;h<c.length-1;h++){var m=d,k=e,n=c[h],p=c[h+1];if(l(m,n,p)!==l(k,n,p)&&l(m,k,n)!==l(m,k,p))return!0}return!1}function d(a,c,b){b*=b;if(1===c.length)return a.distSqr(c[0])<b;for(var d=1;d<c.length;d++)if(n(a,c[d-1],c[d])<b)return!0;return!1}function n(a,c,b){var d=c.distSqr(b);if(0===d)return a.distSqr(c);d=((a.x-c.x)*(b.x-c.x)+(a.y-c.y)*(b.y-c.y))/d;return 0>d?a.distSqr(c):1<d?a.distSqr(b):a.distSqr(b.sub(c)._mult(d)._add(c))}
function q(a,c){for(var b=!1,d,e,h,l=0;l<a.length;l++){d=a[l];var m=0;for(h=d.length-1;m<d.length;h=m++)e=d[m],h=d[h],e.y>c.y!==h.y>c.y&&c.x<(h.x-e.x)*(c.y-e.y)/(h.y-e.y)+e.x&&(b=!b)}return b}function c(a,c){for(var b=!1,d=0,e=a.length-1;d<a.length;e=d++){var h=a[d],e=a[e];h.y>c.y!==e.y>c.y&&c.x<(e.x-h.x)*(c.y-h.y)/(e.y-h.y)+h.x&&(b=!b)}return b}var l=a("./util").isCounterClockwise;p.exports={multiPolygonIntersectsBufferedMultiPoint:function(a,e,b){for(var f=0;f<a.length;f++)for(var g=a[f],h=0;h<
e.length;h++)for(var l=e[h],m=0;m<l.length;m++){var k=l[m];if(c(g,k)||d(k,g,b))return!0}return!1},multiPolygonIntersectsMultiPolygon:function(a,c){if(1===a.length&&1===a[0].length)return q(c,a[0][0]);for(var b=0;b<c.length;b++)for(var d=c[b],g=0;g<d.length;g++)if(q(a,d[g]))return!0;for(b=0;b<a.length;b++){d=a[b];for(g=0;g<d.length;g++)if(q(c,d[g]))return!0;for(g=0;g<c.length;g++)if(e(d,c[g]))return!0}return!1},multiPolygonIntersectsBufferedMultiLine:function(a,h,b){for(var f=0;f<h.length;f++)for(var g=
h[f],l=0;l<a.length;l++){var m=a[l];if(3<=m.length)for(var k=0;k<g.length;k++)if(c(m,g[k]))return!0;a:{var k=g,n=b;if(1<m.length){if(e(m,k)){m=!0;break a}for(var p=0;p<k.length;p++)if(d(k[p],m,n)){m=!0;break a}}for(p=0;p<m.length;p++)if(d(m[p],k,n)){m=!0;break a}m=!1}if(m)return!0}return!1},polygonIntersectsPolygon:function(a,d){for(var b=0;b<a.length;b++)if(c(d,a[b]))return!0;for(b=0;b<d.length;b++)if(c(a,d[b]))return!0;return e(a,d)?!0:!1},distToSegmentSquared:n}},{"./util":241}],233:[function(a,
p,k){p.exports={"Latin-1 Supplement":function(a){return 128<=a&&255>=a},Arabic:function(a){return 1536<=a&&1791>=a},"Arabic Supplement":function(a){return 1872<=a&&1919>=a},"Arabic Extended-A":function(a){return 2208<=a&&2303>=a},"Hangul Jamo":function(a){return 4352<=a&&4607>=a},"Unified Canadian Aboriginal Syllabics":function(a){return 5120<=a&&5759>=a},"Unified Canadian Aboriginal Syllabics Extended":function(a){return 6320<=a&&6399>=a},"General Punctuation":function(a){return 8192<=a&&8303>=a},
"Letterlike Symbols":function(a){return 8448<=a&&8527>=a},"Number Forms":function(a){return 8528<=a&&8591>=a},"Miscellaneous Technical":function(a){return 8960<=a&&9215>=a},"Control Pictures":function(a){return 9216<=a&&9279>=a},"Optical Character Recognition":function(a){return 9280<=a&&9311>=a},"Enclosed Alphanumerics":function(a){return 9312<=a&&9471>=a},"Geometric Shapes":function(a){return 9632<=a&&9727>=a},"Miscellaneous Symbols":function(a){return 9728<=a&&9983>=a},"Miscellaneous Symbols and Arrows":function(a){return 11008<=
a&&11263>=a},"CJK Radicals Supplement":function(a){return 11904<=a&&12031>=a},"Kangxi Radicals":function(a){return 12032<=a&&12255>=a},"Ideographic Description Characters":function(a){return 12272<=a&&12287>=a},"CJK Symbols and Punctuation":function(a){return 12288<=a&&12351>=a},Hiragana:function(a){return 12352<=a&&12447>=a},Katakana:function(a){return 12448<=a&&12543>=a},Bopomofo:function(a){return 12544<=a&&12591>=a},"Hangul Compatibility Jamo":function(a){return 12592<=a&&12687>=a},Kanbun:function(a){return 12688<=
a&&12703>=a},"Bopomofo Extended":function(a){return 12704<=a&&12735>=a},"CJK Strokes":function(a){return 12736<=a&&12783>=a},"Katakana Phonetic Extensions":function(a){return 12784<=a&&12799>=a},"Enclosed CJK Letters and Months":function(a){return 12800<=a&&13055>=a},"CJK Compatibility":function(a){return 13056<=a&&13311>=a},"CJK Unified Ideographs Extension A":function(a){return 13312<=a&&19903>=a},"Yijing Hexagram Symbols":function(a){return 19904<=a&&19967>=a},"CJK Unified Ideographs":function(a){return 19968<=
a&&40959>=a},"Yi Syllables":function(a){return 40960<=a&&42127>=a},"Yi Radicals":function(a){return 42128<=a&&42191>=a},"Hangul Jamo Extended-A":function(a){return 43360<=a&&43391>=a},"Hangul Syllables":function(a){return 44032<=a&&55215>=a},"Hangul Jamo Extended-B":function(a){return 55216<=a&&55295>=a},"Private Use Area":function(a){return 57344<=a&&63743>=a},"CJK Compatibility Ideographs":function(a){return 63744<=a&&64255>=a},"Arabic Presentation Forms-A":function(a){return 64336<=a&&65023>=a},
"Vertical Forms":function(a){return 65040<=a&&65055>=a},"CJK Compatibility Forms":function(a){return 65072<=a&&65103>=a},"Small Form Variants":function(a){return 65104<=a&&65135>=a},"Arabic Presentation Forms-B":function(a){return 65136<=a&&65279>=a},"Halfwidth and Fullwidth Forms":function(a){return 65280<=a&&65519>=a}}},{}],234:[function(a,p,k){a=function(a,d){this.max=a;this.onRemove=d;this.reset()};a.prototype.reset=function(){for(var a in this.data)this.onRemove(this.data[a]);this.data={};this.order=
[];return this};a.prototype.add=function(a,d){if(this.has(a))this.order.splice(this.order.indexOf(a),1),this.data[a]=d,this.order.push(a);else if(this.data[a]=d,this.order.push(a),this.order.length>this.max){var e=this.get(this.order[0]);if(e)this.onRemove(e)}return this};a.prototype.has=function(a){return a in this.data};a.prototype.keys=function(){return this.order};a.prototype.get=function(a){if(!this.has(a))return null;var d=this.data[a];delete this.data[a];this.order.splice(this.order.indexOf(a),
1);return d};a.prototype.getWithoutRemoving=function(a){return this.has(a)?this.data[a]:null};a.prototype.remove=function(a){if(!this.has(a))return this;var d=this.data[a];delete this.data[a];this.onRemove(d);this.order.splice(this.order.indexOf(a),1);return this};a.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;)if(a=this.get(this.order[0]))this.onRemove(a);return this};p.exports=a},{}],235:[function(a,p,k){function e(a,d){var b=n(c.API_URL);a.protocol=b.protocol;a.authority=
b.authority;if(!c.REQUIRE_ACCESS_TOKEN)return q(a);d=d||c.ACCESS_TOKEN;if(!d)throw Error("An API access token is required to use Mapbox GL. See https://www.mapbox.com/api-documentation/#access-tokens");if("s"===d[0])throw Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). See https://www.mapbox.com/api-documentation/#access-tokens");a.params.push("access_token="+d);return q(a)}function d(a){return 0===a.indexOf("mapbox:")}function n(a){a=a.match(h);if(!a)throw Error("Unable to parse URL object");
return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function q(a){var b=a.params.length?"?"+a.params.join("&"):"";return a.protocol+"://"+a.authority+a.path+b}var c=a("./config"),l=a("./browser");k.isMapboxURL=d;k.normalizeStyleURL=function(a,c){if(!d(a))return a;var b=n(a);b.path="/styles/v1"+b.path;return e(b,c)};k.normalizeGlyphsURL=function(a,c){if(!d(a))return a;var b=n(a);b.path="/fonts/v1"+b.path;return e(b,c)};k.normalizeSourceURL=function(a,c){if(!d(a))return a;
var b=n(a);b.path="/v4/"+b.authority+".json";b.params.push("secure");return e(b,c)};k.normalizeSpriteURL=function(a,c,g,h){var b=n(a);if(!d(a))return b.path+=""+c+g,q(b);b.path="/styles/v1"+b.path+"/sprite"+c+g;return e(b,h)};var m=/(\.(png|jpg)\d*)(?=$)/;k.normalizeTileURL=function(a,e,g){if(!e||!d(e))return a;a=n(a);a.path=a.path.replace(m,""+(2<=l.devicePixelRatio||512===g?"@2x":"")+(l.supportsWebp?".webp":"$1"));g=a.params;for(e=0;e<g.length;e++)0===g[e].indexOf("access_token=tk.")&&(g[e]="access_token="+
(c.ACCESS_TOKEN||""));return q(a)};var h=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/},{"./browser":220,"./config":224}],236:[function(a,p,k){var e=a("./is_char_in_unicode_block");p.exports.allowsIdeographicBreaking=function(a){for(var d=0;d<a.length;d+=1)if(!k.charAllowsIdeographicBreaking(a[d].charCodeAt(0)))return!1;return!0};p.exports.allowsVerticalWritingMode=function(a){for(var d=0;d<a.length;d+=1)if(k.charHasUprightVerticalOrientation(a[d].charCodeAt(0)))return!0;return!1};p.exports.allowsLetterSpacing=
function(a){for(var d=0;d<a.length;d+=1)if(!k.charAllowsLetterSpacing(a[d].charCodeAt(0)))return!1;return!0};p.exports.charAllowsLetterSpacing=function(a){return e.Arabic(a)||e["Arabic Supplement"](a)||e["Arabic Extended-A"](a)||e["Arabic Presentation Forms-A"](a)||e["Arabic Presentation Forms-B"](a)?!1:!0};p.exports.charAllowsIdeographicBreaking=function(a){return 11904>a?!1:e["Bopomofo Extended"](a)||e.Bopomofo(a)||e["CJK Compatibility Forms"](a)||e["CJK Compatibility Ideographs"](a)||e["CJK Compatibility"](a)||
e["CJK Radicals Supplement"](a)||e["CJK Strokes"](a)||e["CJK Symbols and Punctuation"](a)||e["CJK Unified Ideographs Extension A"](a)||e["CJK Unified Ideographs"](a)||e["Enclosed CJK Letters and Months"](a)||e["Halfwidth and Fullwidth Forms"](a)||e.Hiragana(a)||e["Ideographic Description Characters"](a)||e["Kangxi Radicals"](a)||e["Katakana Phonetic Extensions"](a)||e.Katakana(a)||e["Vertical Forms"](a)||e["Yi Radicals"](a)||e["Yi Syllables"](a)?!0:!1};k.charHasUprightVerticalOrientation=function(a){return 746===
a||747===a?!0:4352>a?!1:e["Bopomofo Extended"](a)||e.Bopomofo(a)||e["CJK Compatibility Forms"](a)&&!(65097<=a&&65103>=a)||e["CJK Compatibility Ideographs"](a)||e["CJK Compatibility"](a)||e["CJK Radicals Supplement"](a)||e["CJK Strokes"](a)||e["CJK Symbols and Punctuation"](a)&&!(12296<=a&&12305>=a||12308<=a&&12319>=a)&&12336!==a||e["CJK Unified Ideographs Extension A"](a)||e["CJK Unified Ideographs"](a)||e["Enclosed CJK Letters and Months"](a)||e["Hangul Compatibility Jamo"](a)||e["Hangul Jamo Extended-A"](a)||
e["Hangul Jamo Extended-B"](a)||e["Hangul Jamo"](a)||e["Hangul Syllables"](a)||e.Hiragana(a)||e["Ideographic Description Characters"](a)||e.Kanbun(a)||e["Kangxi Radicals"](a)||e["Katakana Phonetic Extensions"](a)||e.Katakana(a)&&12540!==a||e["Halfwidth and Fullwidth Forms"](a)&&!(65288===a||65289===a||65293===a||65306<=a&&65310>=a||65339===a||65341===a||65343===a||65371<=a&&65503>=a||65507===a||65512<=a&&65519>=a)||e["Small Form Variants"](a)&&!(65112<=a&&65118>=a||65123<=a&&65126>=a)||e["Unified Canadian Aboriginal Syllabics"](a)||
e["Unified Canadian Aboriginal Syllabics Extended"](a)||e["Vertical Forms"](a)||e["Yijing Hexagram Symbols"](a)||e["Yi Syllables"](a)||e["Yi Radicals"](a)?!0:!1};k.charHasNeutralVerticalOrientation=function(a){return e["Latin-1 Supplement"](a)&&(167===a||169===a||174===a||177===a||188===a||189===a||190===a||215===a||247===a)||e["General Punctuation"](a)&&(8214===a||8224===a||8225===a||8240===a||8241===a||8251===a||8252===a||8258===a||8263===a||8264===a||8265===a||8273===a)||e["Letterlike Symbols"](a)||
e["Number Forms"](a)||e["Miscellaneous Technical"](a)&&(8960<=a&&8967>=a||8972<=a&&8991>=a||8996<=a&&9E3>=a||9003===a||9085<=a&&9114>=a||9150<=a&&9165>=a||9167===a||9169<=a&&9179>=a||9186<=a&&9215>=a)||e["Control Pictures"](a)&&9251!==a||e["Optical Character Recognition"](a)||e["Enclosed Alphanumerics"](a)||e["Geometric Shapes"](a)||e["Miscellaneous Symbols"](a)&&!(9754<=a&&9759>=a)||e["Miscellaneous Symbols and Arrows"](a)&&(11026<=a&&11055>=a||11088<=a&&11097>=a||11192<=a&&11243>=a)||e["CJK Symbols and Punctuation"](a)||
e.Katakana(a)||e["Private Use Area"](a)||e["CJK Compatibility Forms"](a)||e["Small Form Variants"](a)||e["Halfwidth and Fullwidth Forms"](a)||8734===a||8756===a||8757===a||9984<=a&&10087>=a||10102<=a&&10131>=a||65532===a||65533===a?!0:!1};k.charHasRotatedVerticalOrientation=function(a){return!(k.charHasUprightVerticalOrientation(a)||k.charHasNeutralVerticalOrientation(a))}},{"./is_char_in_unicode_block":233}],237:[function(a,p,k){var e=a("../geo/lng_lat");p.exports=function(a,k,p){a=new e(a.lng,a.lat);
if(k){var c=new e(a.lng-360,a.lat),d=new e(a.lng+360,a.lat),m=p.locationPoint(a).distSqr(k);p.locationPoint(c).distSqr(k)<m?a=c:p.locationPoint(d).distSqr(k)<m&&(a=d)}for(;180<Math.abs(a.lng-p.center.lng);){k=p.locationPoint(a);if(0<=k.x&&0<=k.y&&k.x<=p.width&&k.y<=p.height)break;a.lng=a.lng>p.center.lng?a.lng-360:a.lng+360}return a}},{"../geo/lng_lat":92}],238:[function(a,p,k){function e(a,c){return Math.ceil(a/c)*c}function d(a,d){for(var b=[],e=[],f="var i = this.length;\nthis.resize(this.length + 1);\n",
h=0;h<a.length;h+=1){var l=a[h],k=c[l.type].BYTES_PER_ELEMENT;0>b.indexOf(k)&&(b.push(k),f+="var o"+k.toFixed(0)+" = i * "+(d/k).toFixed(0)+";\n");for(var m=0;m<l.components;m++){var n="v"+e.length,p="o"+k.toFixed(0)+" + "+(l.offset/k+m).toFixed(0),f=f+("this."+l.type.toLowerCase()+"["+p+"] = "+n+";\n");e.push(n)}}return new Function(e.toString(),f+"return i;")}function n(a,d){var b="this._pos"+c[a.type].BYTES_PER_ELEMENT.toFixed(0),e=(a.offset/c[a.type].BYTES_PER_ELEMENT+d).toFixed(0),b=b+" + "+
e;return"this._structArray."+a.type.toLowerCase()+"["+b+"]"}var q=a("assert");p.exports=function(a){var b=JSON.stringify(a);if(h[b])return h[b];var g=void 0===a.alignment?1:a.alignment,k=0,p=0,z=["Uint8"];a=a.members.map(function(a){q(a.name.length);q(a.type in c);0>z.indexOf(a.type)&&z.push(a.type);var b=c[a.type].BYTES_PER_ELEMENT,d=k=e(k,Math.max(g,b)),f=a.components||1;p=Math.max(p,b);k+=b*f;return{name:a.name,type:a.type,components:f,offset:d}});var t=e(k,Math.max(p,g)),r=function(a){function b(){a.apply(this,
arguments)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);return b.prototype.constructor=b}(l);r.prototype.alignment=g;r.prototype.size=t;for(var v=0;v<a.length;v+=1)for(var C=a[v],w=0;w<C.components;w++){var A=C.name+(1===C.components?"":w);if(A in r.prototype)throw Error(A+" is a reserved name and cannot be used as a member name.");Object.defineProperty(r.prototype,A,{get:new Function("return "+n(C,w)+";"),set:new Function("x",n(C,w)+" = x;")})}v=function(a){function b(){a.apply(this,
arguments)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);return b.prototype.constructor=b}(m);v.prototype.members=a;v.prototype.StructType=r;v.prototype.bytesPerElement=t;v.prototype.emplaceBack=d(a,t);v.prototype._usedTypes=z;return h[b]=v};var c={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},l=function(a,c){this._structArray=a;this._pos1=c*this.size;this._pos2=this._pos1/2;this._pos4=this._pos1/4;this._pos8=
this._pos1/8},m=function(a){this.isTransferred=!1;void 0!==a?(this.arrayBuffer=a.arrayBuffer,this.length=a.length,this.capacity=this.arrayBuffer.byteLength/this.bytesPerElement,this._refreshViews()):(this.capacity=-1,this.resize(0))};m.serialize=function(){return{members:this.prototype.members,alignment:this.prototype.StructType.prototype.alignment,bytesPerElement:this.prototype.bytesPerElement}};m.prototype.serialize=function(a){q(!this.isTransferred);this._trim();a&&(this.isTransferred=!0,a.push(this.arrayBuffer));
return{length:this.length,arrayBuffer:this.arrayBuffer}};m.prototype.get=function(a){q(!this.isTransferred);return new this.StructType(this,a)};m.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())};m.prototype.clear=function(){this.length=0};m.prototype.resize=function(a){q(!this.isTransferred);this.length=a;a>this.capacity&&(this.capacity=Math.max(a,Math.floor(5*this.capacity),
128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement),a=this.uint8,this._refreshViews(),a&&this.uint8.set(a))};m.prototype._refreshViews=function(){for(var a=0,d=this._usedTypes;a<d.length;a+=1){var e=d[a];this[e.toLowerCase()]=new c[e](this.arrayBuffer)}};m.prototype.toArray=function(a,c){q(!this.isTransferred);for(var b=[],d=a;d<c;d++){var e=this.get(d);b.push(e)}return b};var h={}},{assert:9}],239:[function(a,p,k){var e=a("./browser");a=function(a,e){this.frequency=a;this.throttledFunction=
e;this.lastInvocation=0};a.prototype.invoke=function(){var a=this;if(!this.pendingInvocation){var k=0===this.lastInvocation?0:this.lastInvocation+this.frequency-e.now();0>=k?(this.lastInvocation=e.now(),this.throttledFunction()):this.pendingInvocation=setTimeout(function(){a.pendingInvocation=void 0;a.lastInvocation=e.now();a.throttledFunction()},k)}};a.prototype.stop=function(){this.pendingInvocation&&(clearTimeout(this.pendingInvocation),this.pendingInvocation=void 0)};p.exports=a},{"./browser":220}],
240:[function(a,p,k){p.exports=function(a,d){return d.replace(/{([^{}]+)}/g,function(d,e){return e in a?a[e]:""})}},{}],241:[function(a,p,k){var e=a("@mapbox/unitbezier"),d=a("../geo/coordinate");a("point-geometry");k.easeCubicInOut=function(a){if(0>=a)return 0;if(1<=a)return 1;var c=a*a,d=c*a;return 4*(.5>a?d:3*(a-c)+d-.75)};k.bezier=function(a,d,k,h){var b=new e(a,d,k,h);return function(a){return b.solve(a)}};k.ease=k.bezier(.25,.1,.25,1);k.clamp=function(a,d,e){return Math.min(e,Math.max(d,a))};
k.wrap=function(a,d,e){var c=e-d;a=((a-d)%c+c)%c+d;return a===d?e:a};k.asyncAll=function(a,d,e){if(!a.length)return e(null,[]);var c=a.length,b=Array(a.length),f=null;a.forEach(function(a,h){d(a,function(a,d){a&&(f=a);b[h]=d;0===--c&&e(f,b)})})};k.values=function(a){var c=[],d;for(d in a)c.push(a[d]);return c};k.keysDifference=function(a,d){var c=[],e;for(e in a)e in d||c.push(e);return c};k.extend=function(a){for(var c=[],d=arguments.length-1;0<d--;)c[d]=arguments[d+1];for(d=0;d<c.length;d+=1){var e=
c[d],b;for(b in e)a[b]=e[b]}return a};k.pick=function(a,d){for(var c={},e=0;e<d.length;e++){var b=d[e];b in a&&(c[b]=a[b])}return c};var n=1;k.uniqueId=function(){return n++};k.bindAll=function(a,d){a.forEach(function(a){d[a]&&(d[a]=d[a].bind(d))})};k.getCoordinatesCenter=function(a){for(var c=Infinity,e=Infinity,h=-Infinity,b=-Infinity,f=0;f<a.length;f++)c=Math.min(c,a[f].column),e=Math.min(e,a[f].row),h=Math.max(h,a[f].column),b=Math.max(b,a[f].row);a=Math.max(0,Math.floor(-Math.log(Math.max(h-
c,b-e))/Math.LN2));return(new d((c+h)/2,(e+b)/2,0)).zoomTo(a)};k.endsWith=function(a,d){return-1!==a.indexOf(d,a.length-d.length)};k.mapObject=function(a,d,e){var c={},b;for(b in a)c[b]=d.call(e||this,a[b],b,a);return c};k.filterObject=function(a,d,e){var c={},b;for(b in a)d.call(e||this,a[b],b,a)&&(c[b]=a[b]);return c};k.deepEqual=function(a,d){if(Array.isArray(a)){if(!Array.isArray(d)||a.length!==d.length)return!1;for(var c=0;c<a.length;c++)if(!k.deepEqual(a[c],d[c]))return!1;return!0}if("object"===
typeof a&&null!==a&&null!==d){if("object"!==typeof d||Object.keys(a).length!==Object.keys(d).length)return!1;for(c in a)if(!k.deepEqual(a[c],d[c]))return!1;return!0}return a===d};k.clone=function(a){return Array.isArray(a)?a.map(k.clone):"object"===typeof a&&a?k.mapObject(a,k.clone):a};k.arraysIntersect=function(a,d){for(var c=0;c<a.length;c++)if(0<=d.indexOf(a[c]))return!0;return!1};var q={};k.warnOnce=function(a){q[a]||("undefined"!==typeof console&&console.warn(a),q[a]=!0)};k.isCounterClockwise=
function(a,d,e){return(e.y-a.y)*(d.x-a.x)>(d.y-a.y)*(e.x-a.x)};k.calculateSignedArea=function(a){for(var c=0,d=0,e=a.length,b=e-1,f;d<e;b=d++)f=a[d],b=a[b],c+=(b.x-f.x)*(f.y+b.y);return c};k.isClosedPolygon=function(a){if(4>a.length)return!1;var c=a[0],d=a[a.length-1];return 0<Math.abs(c.x-d.x)||0<Math.abs(c.y-d.y)?!1:.01<Math.abs(k.calculateSignedArea(a))};k.sphericalToCartesian=function(a){var c=a[0],d=a[1];a=a[2];d=Math.PI/180*(d+90);a*=Math.PI/180;return[c*Math.cos(d)*Math.sin(a),c*Math.sin(d)*
Math.sin(a),c*Math.cos(a)]};k.parseCacheControl=function(a){var c={};a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(a,d,b,e){a=b||e;c[d]=a?a.toLowerCase():!0;return""});c["max-age"]&&(a=parseInt(c["max-age"],10),isNaN(a)?delete c["max-age"]:c["max-age"]=a);return c}},{"../geo/coordinate":91,"@mapbox/unitbezier":4,"point-geometry":56}],242:[function(a,p,k){a=function(a,d,k,
p){this.type="Feature";this._vectorTileFeature=a;a._z=d;a._x=k;a._y=p;this.properties=a.properties;null!=a.id&&(this.id=a.id)};k={geometry:{}};k.geometry.get=function(){void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry);return this._geometry};k.geometry.set=function(a){this._geometry=a};a.prototype.toJSON=function(){var a={geometry:this.geometry},d;for(d in this)"_geometry"!==d&&"_vectorTileFeature"!==
d&&(a[d]=this[d]);return a};Object.defineProperties(a.prototype,k);p.exports=a},{}],243:[function(a,p,k){var e=a("./script_detection");p.exports=function(a){for(var d="",k=0;k<a.length;k++)var c=a.charCodeAt(k+1)||null,l=a.charCodeAt(k-1)||null,d=c&&e.charHasRotatedVerticalOrientation(c)&&!p.exports.lookup[a[k+1]]||l&&e.charHasRotatedVerticalOrientation(l)&&!p.exports.lookup[a[k-1]]||!p.exports.lookup[a[k]]?d+a[k]:d+p.exports.lookup[a[k]];return d};p.exports.lookup={"!":"\ufe15","#":"\uff03",$:"\uff04",
"%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\u00a2":"\uffe0","\u00a3":"\uffe1","\u00a5":"\uffe5","\u00a6":"\uffe4","\u00ac":"\uffe2","\u00af":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43",
"\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb",
"\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"}},{"./script_detection":236}],244:[function(a,p,k){var e=a("assert"),d=a("./web_worker");k=function(){this.active={}};k.prototype.acquire=function(k){if(!this.workers){var n=a("../").workerCount;e("number"===typeof n&&
Infinity>n);for(this.workers=[];this.workers.length<n;)this.workers.push(new d)}this.active[k]=!0;return this.workers.slice()};k.prototype.release=function(a){delete this.active[a];0===Object.keys(this.active).length&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)};p.exports=k},{"../":95,"./web_worker":221,assert:9}]},{},[95])(95)});
